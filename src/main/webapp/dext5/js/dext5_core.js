/* ------------- 0 ------------------ */
var G_ICON_FULL_SET="new save print undo redo copy cut paste text_paste find replace emoticon setting horizontal_line image_create image_property flash_create flash_property media_create media_property iframe_create iframe_property hyperlink_create hyperlink_property hyperlink_delete bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_image detail_table_insert table_insert table_delete merge_cell split_cell table_row_clone insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight full_screen bold underline italic strike_through superscript subscript remove_format font_color font_bg_color align_left align_center align_right align_full line_height indent outdent list_number list_bullets design source preview text formatting font_family font_size about select_all insert_row_column cell_property row_property column_property table_property table_select_all table_select_cell table_select_row table_select_column valign_up valign_center valign_baseline valign_bottom template grid tool_replace convert_table_to_text insert_link_media paste_word cell_border cell_bg_color".split(" "),
G_dext5plugIn=null,G_SUB_DIALOG=null,G_CURRENT_IFRAME=null,G_USE_EDITOR_ID=null,G_LAST_CMD=null,G_MAIN_ZINDEX=1E4,G_BACKGROUND_ZINDEX=11E3,G_SUB_DIALOG_ZINDEX=15E3,G_IFRAME_ZINDEX=2E4,G_ABOUT_ZINDEX=3E4,G_TIMEOUT_CNT=0,xmlHttpReqeust_Config,SIL=[],Z=[],___=top.DEXTWIN.location,_0_,_1_,_7_,G_BASE_COLOR_PICKER="#ff0000 #ff5e00 #ffbb00 #ffe400 #abf200 #1fda11 #00d8ff #0055ff #0900ff #6600ff #ff00dd #ff007f #000000 #ffffff #ffd8d8 #fae0d4 #faecc5 #faf4c0 #e4f7ba #cefbc9 #d4f4fa #d9e5ff #dad9ff #e8d9ff #ffd9fa #ffd9ec #f6f6f6 #eaeaea #ffa7a7 #ffc19e #ffe08c #faed7d #cef279 #b7f0b1 #b2ebf4 #b2ccff #b5b2ff #d1b2ff #ffb2f5 #ffb2d9 #d5d5d5 #bdbdbd #f15f5f #f29661 #f2cb61 #e5d85c #bce55c #86e57f #5cd1e5 #6699ff #6b66ff #a366ff #f261df #f261aa #a6a6a6 #8c8c8c #cc3d3d #cc723d #cca63d #c4b73b #9fc93c #47c83e #3db7cc #4174d9 #4641d9 #7e41d9 #d941c5 #d9418d #747474 #5d5d5d #980000 #993800 #997000 #998a00 #6b9900 #2f9d27 #008299 #003399 #050099 #3d0099 #990085 #99004c #4c4c4c #353535 #670000 #662500 #664b00 #665c00 #476600 #22741c #005766 #002266 #030066 #290066 #660058 #660033 #212121 #000000".split(" "),
_R_O_="c";
function DEXT5_EDITOR(a,c,b){this.ID=a;this.Frame=b;this.FrameStatus="";this.FrameID=b.FrameID;top.DEXT5.DEXTMULTIPLE[b.FrameID]=this;top.G_CURREDITOR=this;this._config=c;this._currentMode="design";this._BODY=this._DOC=null;this._EDITOR={};this._defaultHeight="";this._setting={};this._top_menu_click_flag=!1;this._top_menu_click_id="";this._docType={};this.UndoManager=new UndoManager;this.baseMenuToolbarHeight=0;this._PageProp={};this.remove_item=[];this.____={};this._LastRange=null;this._RangeBlurBug=!1;
this._defTableWidth=0;this._dextCustomData=[];this._dextCustomDataMode=!1;_R_O_+="/";_R_O_+="="}
DEXT5_EDITOR.prototype={_Design2Source:function(){var a="p table tr td hr img div tbody ul li caption".split(" "),a=[];_value=this._BODY.innerHTML;_value=CleanZeroChar(_value);_value=_value.replace(/\t/g,"");for(var c="",b=0,d=a.length;b<d;b++)c=a[b],_value=_value.replace(RegExp("<"+c,"ig"),"\r\n<"+c);_value=_value.replace(/\r?\n?\r?\n/g,"\r\n");_value=top.DEXT5.util.trim(_value);this._EDITOR.source.value=_value;this._EDITOR.source.focus()},_Design2Preview:function(){setHtmlToPreview();setFocusTopWindow()},
_Design2Text:function(){_value="textContent"in this._BODY?this._BODY.textContent:this._BODY.innerText;_value=CleanZeroChar(_value);_value=_value.replace(/\t/g,"");this._EDITOR.text.value=_value;this._EDITOR.text.focus()},getEditorMode:function(){return this._currentMode},setChangeMode:function(a){var c=this.getEditorMode();if(c!=a){var b=!0;"text"==a&&(b=confirm(dext5_lang.msg.changeTextMode));if(b){this._iconSelected();for(var d=null,e=null,b=["design","source","preview","text"],g=0,f=b.length;g<
f;g++)d=document.getElementById("ue_"+this.ID+b[g]),e=document.getElementById("dext5_"+b[g]+"_"+this.ID),null!=d&&(a==b[g]?(d.className=this._config.style.skinName,d.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/ue_btn_bg.gif)","source"==a||"text"==a?(e.focus(),e.style.height=this._defaultHeight+"px",e.height=this._defaultHeight+"px"):e.style.height="100%",e.style.width="100%","design"==a&&(this._LastRange=null,setFocusToBody())):(d.className="",d.style.backgroundImage=
"",e.style.width="0px",e.style.height="0px",e.blur()),d=document.getElementById("ue_diabled_div_"+this.ID),"BackCompat"==document.compatMode&&(d.style.height=document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollHeight+"px"),document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="relative",d.style.width="design"==a?"0px":document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).scrollWidth+"px");switch(c){case "design":switch(a){case "source":ReplaceImageToRealObject();this._Design2Source();
break;case "preview":ReplaceImageToRealObject();this._Design2Preview();break;case "text":this._Design2Text()}break;case "source":_value=this._EDITOR.source.value;_value=_value.replace(/\t/g,"");top.DEXT5.setBodyValue(_value,"",!0);switch(a){case "design":ReplaceRealObjectToImage();break;case "preview":ReplaceImageToRealObject();this._Design2Preview();break;case "text":this._Design2Text()}break;case "preview":switch(a){case "design":FixFlashError();ReplaceRealObjectToImage();break;case "source":this._Design2Source();
break;case "text":this._Design2Text()}break;case "text":switch(_value=this._EDITOR.text.value,_value=_value.replace(/&/g,"&amp;"),_value=_value.replace(/</g,"&lt;"),_value=_value.replace(/>/g,"&gt;"),_value=_value.replace(/\r\n/g,"<br />"),_value=_value.replace(/\r?\n/g,"<br />"),_value=_value.replace(/\n/g,"<br />"),_value="<p>"+_value+"</p>",top.DEXT5.setBodyValue(_value,"",!0),a){case "source":this._Design2Source();break;case "preview":this._Design2Preview()}}this._currentMode=a}}},start:function(){var a=
this;xmlHttpReqeust_Config=top.DEXT5.util.ajax.xml_http_request();xmlHttpReqeust_Config.onreadystatechange=function(){4==xmlHttpReqeust_Config.readyState&&(200==xmlHttpReqeust_Config.status?a._setEditorIcon(xmlHttpReqeust_Config.responseXML):404==xmlHttpReqeust_Config.status&&alert("ErrCode : 1003"))};xmlHttpReqeust_Config.open("GET",a._config.config_url,!1);xmlHttpReqeust_Config.send(null)},_setEditorIcon:function(a){var c=this._config.style.skinName,b=this._config.webPath.image+"skin/"+c,d=top.DEXT5.util.xml.getNode(a,
"top_menu"),e=top.DEXT5.util.xml.getNode(a,"tool_bar_1"),g=top.DEXT5.util.xml.getNode(a,"tool_bar_2"),f=top.DEXT5.util.xml.getNode(a,"font_size"),l=top.DEXT5.util.xml.getNode(a,"formatting"),h=top.DEXT5.util.xml.getNode(a,"status_bar"),k=top.DEXT5.util.xml.getNode(a,"setting"),m=top.DEXT5.util.xml.getNode(a,"license"),n=top.DEXT5.util.xml.getNode(a,"font_family");this.____.p=top.DEXT5.util.xml.getNodeValue(m,R[28]+R[21]+R[18]+R[11]+"u"+R[17]+R[14]+"_k"+R[12]+"y");_7_=top.DEXT5.util.xml.getNodeValue(m,
"l"+T[10]+R[17]+R[12]+T[11]+T[4]+"_"+T[5]+"e"+T[7]);this.____.l=_L__.DE(_7_);try{this.____.l=this.____.l.split("|"),_0_=this.____.l,_1_=this.____.p}catch(s){}this._dextSetting(k);a=top.DEXT5.util.xml.getNode(a,"remove_item");k=top.DEXT5.util.xml.count(a,"item");for(m=0;m<k;m++)this.remove_item[m]=top.DEXT5.util.xml.getNodeValueIdx(a,"item",m);if(top.DEXTWIN!=top||top.DEXT5.browser.mobile||top.DEXT5.browser.iOS)this.remove_item[k]="full_screen";k="";a=""+('<div id="ue_editor_main_'+this.ID+'" class="DEXT_fiVe_EdiTor" style="z-index:'+
G_MAIN_ZINDEX+'; width:100%; ">');a+='<div onselectstart="return false;" id="ue_toolbar_'+this.ID+'" style="width:100%" class="ue_as">';k=this._makeEditorTopMenu(d);a=a+k+('\t\t<table id="dext_toolbar_'+this.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table">');a+="\t\t\t<tr>";a+='\t\t\t\t<td class="ue_tg_'+c+'" style="background-image:url('+b+'/ue_tbg.gif);">';a+='\t\t\t\t\t<table border="0" cellpadding="0" cellspacing="0" class="ue_table01" >';k=this._makeEditorIcon(e,"1");a+=k;k=
this._makeEditorIcon(g,"2");a+=k;a+="\t\t\t\t\t</table>";a+="\t\t\t\t</td>";a+="\t\t\t</tr>";a+="\t\t</table>";a+='\t<div id="ue_diabled_div_'+this.ID+'" style="background-color:#ffffff; filter:alpha(opacity=50); opacity:0.50; position:absolute; z-index:'+G_BACKGROUND_ZINDEX+'; left:0px; top:0px; width:0px; height:100%;"></div>';a+="</div>";this._defaultHeight=this._config.style.height.replace("px","")+"";a+='\t<div id="ue_editor_holder_'+this.ID+'" class="ue_editor_'+c+'_lr" ';if(top.DEXT5.browser.mobile||
top.DEXT5.browser.iOS)a+=' style="overflow:scroll; overflow-x:hidden; -webkit-overflow-scrolling:touch;"';a+="\t></div>";e=top.DEXT5.util.xml.count(h,"status");1==this._config.status_bar&&(e=0);if(0<e){a+='\t<div  style="width:100%" class="ue_as">';a+='\t\t<table id="dext_statusbar_'+this.ID+'" border="0" cellpadding="0" cellspacing="0" class="ue_table_'+c+'" style=" height:23px; background-image:url('+b+'/ue_gbg.gif);">';a+="\t\t\t<tr>";a+="\t\t\t\t<td>";a+='\t\t\t\t\t<ul class="ue_btn_'+c+'" >';
for(g=0;g<e;g++)k=top.DEXT5.util.xml.getNodeValueIdx(h,"status",g),k=top.DEXT5.util.trim(k).toLowerCase(),a+=' <li class="" id="ue_'+this.ID+k+'">DEXT_Status</li>';a+="\t\t\t\t\t</ul>";a+="\t\t\t\t</td>";a+="\t\t\t</tr>";a+="\t\t</table>";a+="\t</div>"}a+="</div>";document.getElementsByTagName("div")[0].innerHTML=a;h=document.getElementById("ue_editor_holder_"+this.ID);createEditorIframe(h,"dext5_design_"+this.ID,dext5_lang.iframe_title.design,this._docType[this._setting.doctype],this._setting.encoding,
this._setting.lang,this._setting.xmlnsname,this._setting.font_family,this._setting.font_size,this._setting.line_height);g=document.createElement("textarea");g.id="dext5_source_"+this.ID;g.title=dext5_lang.iframe_title.source;g.style.color="#111111";g.style.width="0px";g.style.height="0px";g.style.borderWidth="0px";g.style.margin="0px 0px";g.style.padding="0px";g.style.fontFamily=this._setting.font_family;g.style.fontSize=this._setting.font_size;h.appendChild(g);g=createEditorIframe(h,"dext5_preview_"+
this.ID,dext5_lang.iframe_title.preview,this._docType[this._setting.doctype],this._setting.encoding,this._setting.lang,this._setting.xmlnsname,this._setting.font_family,this._setting.font_size,this._setting.line_height);g.style.width="0px";g.style.height="0px";g=document.createElement("textarea");g.id="dext5_text_"+this.ID;g.title=dext5_lang.iframe_title.text;g.style.color="#111111";g.style.width="0px";g.style.height="0px";g.style.borderWidth="0px";g.style.margin="0px 0px";g.style.padding="0px";g.style.fontFamily=
this._setting.font_family;g.style.fontSize=this._setting.font_size;h.appendChild(g);if(h=document.getElementById("ue_"+this.ID+"design"))h.className=this._config.style.skinName,h.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/ue_btn_bg.gif)";setEditorHeight(this,!0);document.getElementById("ue_editor_holder_"+this.ID).style.height=this._defaultHeight+"px";document.getElementById("dext_background")||(h=document.createElement("div"),h.setAttribute("id",
"dext_background"),h.style.zIndex=G_BACKGROUND_ZINDEX,document.getElementsByTagName("body")[0].appendChild(h));document.getElementById("dext_click_background")||(h=document.createElement("div"),h.setAttribute("id","dext_click_background"),h.style.zIndex=G_BACKGROUND_ZINDEX,document.body.appendChild(h),top.DEXT5.util.addEvent(h,"click",function(){DEXT5_EDITOR.prototype.dialog._click_background()}),h.onmousedown=function(){return!1},h.unselectable="on");var p;try{p=top.DEXTDOC.createElement("<iframe frameborder='0' scrolling='no'>")}catch(u){p=
top.DEXTDOC.createElement("iframe"),p.setAttribute("frameborder","0"),p.setAttribute("scrolling","no")}p.title=dext5_lang.iframe_title.dialog;p.style.display="none";p.style.margin="0px";p.style.padding="0px";var q=top.DEXTDOC.createElement("div");q.id="dext_dialog";q.style.display="none";q.style.position="absolute";h=top.DEXTDOC.createElement("div");top.DEXT5.util.setClass(h,"EdiTor_Popup_header");g=top.DEXTDOC.createElement("span");g.className="subject";a=top.DEXTDOC.createElement("span");a.className=
"text";a.innerHTML="DEXT5 Editor";k=top.DEXTDOC.createElement("div");k.className="close";k.id="dext_dialog_close";m=top.DEXTDOC.createElement("a");m.title="close";k.appendChild(m);h.appendChild(g);h.appendChild(a);h.appendChild(k);q.appendChild(h);q.appendChild(p);k.onclick=function(){hideDialog(q)};p.setAttribute("id","dext_dialog_"+this.ID);this._dextTable.make(this.ID);this._dextFormatting.make(this.ID,l,this._config);this._dextFontFamily.make(this.ID,n);this._dextFontSize.make(this.ID,f,this._config.style.isFontSizeUse);
this._dextLineHeight.make(this.ID);0<e?document.getElementById("ue_"+this.ID+"design").style.backgroundImage="url("+b+"/ue_btn_bg.gif)":(b=document.getElementById("ue_editor_holder_"+this.ID),top.DEXT5.util.setClass(b,"ue_editor_"+c+"_lrb"));this._setTopMenuEvents(d);this._setIconEvents();this._iconEnable("default");setTimeout(_fn_0,2E3);top.DEXTDOC.body.appendChild(q)},_dextSetting:function(a){this._setting.grid_color=top.DEXT5.util.xml.getNodeValue(a,"grid_color");this._setting.grid_color_nm=top.DEXT5.util.xml.getNodeValue(a,
"grid_color_nm");this._setting.grid_spans=top.DEXT5.util.xml.getNodeValue(a,"grid_spans");this._setting.grid_form=top.DEXT5.util.xml.getNodeValue(a,"grid_form");this._setting.encoding=top.DEXT5.util.xml.getNodeValue(a,"encoding");this._PageProp.encoding=this._setting.encoding;this._setting.doctype=this._setting_DocType(top.DEXT5.util.xml.getNodeValue(a,"doctype"));this._PageProp.doctype=this._setting.doctype;this._setting.xmlnsname=top.DEXT5.util.xml.getNodeValue(a,"xmlnsname");this._PageProp.xmlnsname=
this._setting.xmlnsname;this._setting.lang=top.DEXT5.util.xml.getNodeValue(a,"lang");this._PageProp.lang=this._setting.lang;this._setting.font_family=top.DEXT5.util.xml.getNodeValue(a,"font_family");this._setting.font_size=top.DEXT5.util.xml.getNodeValue(a,"font_size");this._setting.line_height=top.DEXT5.util.xml.getNodeValue(a,"line_height");this._setting.enter_tag=top.DEXT5.util.xml.getNodeValue(a,"enter_tag");this._setting.shift_enter_tag=top.DEXT5.util.xml.getNodeValue(a,"shift_enter_tag");this._docType.None=
"";this._docType["XHTML 1.1"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">';this._docType["XHTML 1.0 Transitional"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">';this._docType["XHTML 1.0 Strict"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">';this._docType["XHTML 1.0 Frameset"]='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">';
this._docType["HTML 5"]="<!DOCTYPE html>";this._docType["HTML 4.01 Transitional"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">';this._docType["HTML 4.01 Strict"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">';this._docType["HTML 4.01 Frameset"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">';this._docType["HTML 3.2"]='<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">';this._docType["HTML 2.0"]=
'<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">'},_setting_DocType:function(a){for(var c="HTML 5",b="None;XHTML 1.1;XHTML 1.0 Transitional;XHTML 1.0 Strict;XHTML 1.0 Frameset;HTML 5;HTML 4.01 Transitional;HTML 4.01 Strict;HTML 4.01 Frameset;HTML 3.2;HTML 2.0".split(";"),d=0;d<b.length;d++)if(a==b[d]){c=a;break}return c},_makeEditorTopMenu:function(a){var c=this._config.style.skinName,b="",d=top.DEXT5.util.xml.count(a,"menu");if(0<d){b=1==this._config.top_memu?b+('<table style="display:none; height:0px;" border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+
c+'" id="dext_menu_'+this.ID+'">'):b+('<table border="0" cellpadding="0" cellspacing="0" class="ue_tm tm_'+c+'" id="dext_menu_'+this.ID+'">');b+="<tr><td><ul>";for(c=0;c<d;c++)var e=top.DEXT5.util.xml.getNodeValueIdx(a,"menu",c),e=top.DEXT5.util.trim(e).toLowerCase(),b=b+('<li id="ue_'+this.ID+e+'"><a>'+dext5_lang.top_menu[e]+"</a></li>");b+="</ul></td></tr></table>"}return b},_makeEditorIcon:function(a,c){var b=this._config.style.skinName,d=this._config.webPath.image,e=d+"skin/"+b,g='<span  class="ue_SM"><img style="margin:1px; padding: 0px; width: 11px; height: 26px;"  name="ue_spacebar" src="'+
e+'/separator.gif" /></span>',f="",l=0,l="0"==c?top.DEXT5.util.xml.count(a,"menu"):top.DEXT5.util.xml.count(a,"tool");0<l&&("0"==c?(f=f+"<tr>"+('\t<td class="ue_tdb_'+b+'" style="padding: 1px 5px 0px 5px;" >'),this._config.style.toolHeight+=26):"1"==c?(f=3==this._config.tool_bar||1==this._config.tool_bar?f+'<tr style="display:none;">':f+"<tr>",f+='\t<td class="ue_tdb_'+b+'" style="padding: 1px 5px 0px 5px;" >',this._config.style.toolHeight+=26):(f=3==this._config.tool_bar||2==this._config.tool_bar?
f+'<tr style="display:none;">':f+"<tr>",f+='\t<td class="ue_tdb_'+b+'01" style="padding: 2px 5px 0px 5px; background-image:url('+e+'/ue_tbg01.gif);">',this._config.style.toolHeight+=27));for(e=0;e<l;e++){var h;h="0"==c?top.DEXT5.util.xml.getNodeValueIdx(a,"menu",e):top.DEXT5.util.xml.getNodeValueIdx(a,"tool",e);h=top.DEXT5.util.trim(h).toLowerCase();for(var k=0;k<this.remove_item.length;k++)if(this.remove_item[k]==h){h="remove";break}if("0"==c)f+='<span class="uebutton_combo_on" id="dext_span_'+this.ID+
h+'" >',f+="</span>",f+=g;else switch(h){case "remove":break;case "separator":f+=g;break;case "formatting":case "font_family":case "font_size":case "line_height":k="";"font_family"==h?k="Font_Btn_"+b:"font_size"==h?k="Font_Btn_"+b:"line_height"==h?k="Fsize_Btn_"+b:"formatting"==h&&(k="Font_Btn_"+b);f+='<span class="uebutton_combo_on" id="dext_span_'+this.ID+h+'" >';f+='\t<button unselectable="on" onmousedown="return false;" id="ue_'+this.ID+h+'" class="'+k+'" type="button" title="" style="margin:0;"><span></span></button>';
f+='\t<div style="position:absolute; z-index:'+G_SUB_DIALOG_ZINDEX+'">';f+='\t\t<div id="dext_pan_'+h+"_"+this.ID+'" style="display:none; cursor:pointer;  background-color:#ffffff; position:absolute;  left:0px; top:0px;  padding:0px; border:0px solid #cccccc; "></div>';f+="\t</div>";f+="</span>";break;case "table_insert":f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+h+'" name="span_'+this.ID+'">';f+='\t<div><a href="javascript:;"><img style=" margin: 2px 0px 0px 3px; padding: 0px; width: 16px; height: 16px;" id="ue_'+
this.ID+h+'" class="ue_H ue_M" title="" alt="" src="'+d+"icon/"+h+'.gif" /></a></div>';f+='\t<div style="position:absolute; z-index:'+G_SUB_DIALOG_ZINDEX+'">';f+='\t\t<div id="dext_pan_'+h+"_"+this.ID+'" style="background-color:#ffffff; position:absolute; left:0px; top:0px; display:none; width:180px; height:200px; padding:5px; border:1px solid #cccccc; ">';f+='\t\t\t<span id="dext_table_rc_'+this.ID+'" style="font-size:12px;" padding-left:10px; >0 * 0</span>';f+="\t\t</div>";f+="\t</div>";f+="</span>";
f+='<span style="" class="uebutton_dialog_on" id="dext_span_'+this.ID+'detail_table_insert" name="span_'+this.ID+'">';f+='\t<div><a href="javascript:;"><img style=" margin: 2px 0px 0px 3px; padding: 0px; width: 7px; height: 16px;" id="ue_'+this.ID+'detail_table_insert" class="ue_H ue_M" title="" alt="" src="'+d+'icon/dialog.gif" /></a></div>';f+="</span>";break;case "detail_table_insert":break;case "font_color":case "font_bg_color":case "cell_bg_color":f+='<span style="" class="uebutton_span_on" id="dext_span_'+
this.ID+h+'" name="span_'+this.ID+'">';f+='\t<div><a href="javascript:;"><img style=" margin: 2px 0px 0px 3px; padding: 0px; width: 16px; height: 16px;" id="ue_'+this.ID+h+'" src="'+d+"icon/"+h+'.gif" /></a></div>';f+="</span>";break;default:f+='<span style="" class="uebutton_span_on" id="dext_span_'+this.ID+h+'" name="span_'+this.ID+'">',f+='\t<a href="javascript:;"><img style=" margin: 2px 0px 0px 3px; padding: 0px; width: 16px; height: 16px;" id="ue_'+this.ID+h+'" class="ue_H ue_M" title="" alt="" src="'+
d+"icon/"+h+'.gif" /></a>',f+="</span>"}}"1"==c&&(f+='<span style="" class="uebutton_span_on" name="span_'+this.ID+'">',f+='\t<a href="javascript:;"><img style="color:transparent; margin: 2px 0px 0px 3px; padding: 0px; width: 16px; height: 16px;" id="ue_'+this.ID+'about" class="ue_H ue_M" title="" alt="" src="'+d+'icon/about.gif" /></a>',f+="</span>");0<l&&(f+="\t</td>",f+="</tr>");return f},_div_pan_reset:function(a){},_iconEnable:function(a){for(var c=null,b=null,d="",c="",e=0,g=G_ICON_FULL_SET.length;e<
g;e++)if(d=top.DEXT5.util.trim(G_ICON_FULL_SET[e]).toLowerCase(),c=document.getElementById("ue_"+this.ID+d),b=document.getElementById("dext_span_"+this.ID+d),c&&(c.style.cursor="pointer"),b){switch(d){case "formatting":case "font_family":case "font_size":case "line_height":c="uebutton_combo_";break;case "detail_table_insert":c="uebutton_dialog_";break;default:c="uebutton_span_"}top.DEXT5.util.setClass(b,c+"on")}var f=[];switch(a){case "":case "default":f="copy cut table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight insert_row_column insert_row insert_column table_row_clone table_select cell_size align_vertical row_property column_property table_property cell_property table_tool cell_border cell_bg_color".split(" ");
break;case "selectedSingleCell":f="new save print copy cut paste text_paste find replace template emoticon horizontal_line image_create flash_create media_create iframe_create hyperlink_create bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert table_insert table_delete split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column merge_cell table_same_width table_same_height table_same_widthheight full_screen entity insert_row_column insert_row insert_column table_row_clone table_select align_vertical row_property column_property".split(" ");
break;case "selectedMultiCell":f="new save print copy cut paste text_paste find replace emoticon horizontal_line template image_create flash_create media_create iframe_create hyperlink_create bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert table_insert table_delete split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column full_screen entity insert_row_column insert_row insert_column table_row_clone table_select row_property column_property".split(" ");
break;case "focusInCell":f="copy cut merge_cell table_same_width table_same_height table_same_widthheight doc_bg_image merge_cell cell_size".split(" ");break;case "selectArea":f="new save print text_paste find replace emoticon horizontal_line image_create flash_create media_create template iframe_create hyperlink_create bookmark symbol form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight template undo redo entity table_delete insert_row_column insert_row insert_column table_row_clone table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color".split(" ");
break;case "focusImage":f="new save print paste text_paste find replace bookmark symbol media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format font_color font_bg_color image_create formatting font_family font_size entity template hyperlink_create horizontal_line emoticon line_height list_number list_bullets indent outdent insert_row_column insert_row insert_column table_row_clone table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color".split(" ");
break;case "focusEmbed":f="new save print paste text_paste find replace bookmark symbol media_create flash_create form checkbox radiobutton button selectbox textbox textarea hidden doc_bg_color doc_bg_image detail_table_insert table_insert table_delete merge_cell split_cell insert_row_up insert_row_down delete_row insert_column_left insert_column_right delete_column table_bg_color table_same_width table_same_height table_same_widthheight bold underline italic strike_through superscript subscript remove_format font_color font_bg_color image_create formatting font_family font_size entity template hyperlink_create horizontal_line emoticon line_height list_number list_bullets indent outdent insert_row_column insert_row insert_column table_row_clone table_select cell_size align_vertical row_property column_property table_property cell_property cell_border cell_bg_color".split(" ")}!1==
this.UndoManager.canUndo&&(f[f.length]="undo");!1==this.UndoManager.canRedo&&(f[f.length]="redo");e=0;for(g=f.length;e<g;e++)if(d=top.DEXT5.util.trim(f[e]).toLowerCase(),c=document.getElementById("ue_"+this.ID+d),b=document.getElementById("dext_span_"+this.ID+d),c&&(c.style.cursor="default"),b){switch(d){case "formatting":case "font_family":case "font_size":case "line_height":c="uebutton_combo_";break;case "detail_table_insert":c="uebutton_dialog_";break;default:c="uebutton_span_"}top.DEXT5.util.setClass(b,
c+"off")}DEXT_TOPMENU._disabeld_menu=f},_iconSelected:function(a){for(var c="bold italic underline align_left align_center align_right align_full strike_through subscript superscript full_screen grid".split(" "),b="",d=0,e=c.length;d<e;d++)if(_icon_id=top.DEXT5.util.trim(c[d]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+this.ID+_icon_id))b=top.DEXT5.util.getClass(_icon_span),b=b.replace(" uebutton_span_enter",""),top.DEXT5.util.setClass(_icon_span,b),_icon_span.style.backgroundImage=
"";if(a)for(d=0,e=a.length;d<e;d++)if(_icon_id=top.DEXT5.util.trim(a[d]).toLowerCase(),_icon_span=document.getElementById("dext_span_"+this.ID+_icon_id))b=top.DEXT5.util.getClass(_icon_span),b+=" uebutton_span_enter",top.DEXT5.util.setClass(_icon_span,b),_icon_span.style.backgroundImage="url("+this._config.webPath.image+"skin/"+this._config.style.skinName+"/skinback_release.gif)"},_setTopMenuEvents:function(a){for(var c=this,b=null,d="",e=0,g=top.DEXT5.util.xml.count(a,"menu");e<g;e++)if(d=top.DEXT5.util.trim(top.DEXT5.util.xml.getNodeValueIdx(a,
"menu",e)).toLowerCase(),b=document.getElementById("ue_"+c.ID+d)){switch(b){case "design":case "source":case "preview":case "text":"textContent"in b?b.textContent=dext5_lang.top_menu[d]:b.innerText=dext5_lang.top_menu[d]}var f=function(b){return function(d){var e=top.DEXTDOC.getElementById("dext_topmenu_background"+c._config.editor_id);null!=e&&(e.style.display="none");b==c._top_menu_click_id?(c._top_menu_click_flag?(c._top_menu_click_flag=!1,c._top_menu_click_id="",hideTopMenuAndFocus()):(c._top_menu_click_id=
b,c._top_menu_click_flag=!0,setTopMenu(d,c.ID,b,c._config,a)),top.DEXT5.util.stopEvent(d)):b!=c._top_menu_click_id&&(c._top_menu_click_id=b,c._top_menu_click_flag=!0,setTopMenu(d,c.ID,b,c._config,a),top.DEXT5.util.stopEvent(d));d=0;for(e=top.DEXT5.util.xml.count(a,"menu");d<e;d++)_m_id=top.DEXT5.util.trim(top.DEXT5.util.xml.getNodeValueIdx(a,"menu",d)).toLowerCase(),_m=document.getElementById("ue_"+c.ID+_m_id),_m.childNodes[0].className=_m_id==c._top_menu_click_id?"on":""}}(d),l=function(b){return function(d){var e=
top.DEXTDOC.getElementById("dext_topmenu_background"+c._config.editor_id);null!=e&&(e.style.display="none");c._top_menu_click_flag?(c._top_menu_click_id=b,setTopMenu(d,c.ID,b,c._config,a)):(c._top_menu_click_id="",hideTopMenu());top.DEXT5.util.stopEvent(d);d=0;for(e=top.DEXT5.util.xml.count(a,"menu");d<e;d++)_m_id=top.DEXT5.util.trim(top.DEXT5.util.xml.getNodeValueIdx(a,"menu",d)).toLowerCase(),_m=document.getElementById("ue_"+c.ID+_m_id),_m.childNodes[0].className=_m_id==c._top_menu_click_id?"on":
""}}(d),d=function(a){return function(a){c._top_menu_click_flag&&(a=top.DEXTDOC.getElementById("dext_topmenu_background"+c._config.editor_id),null!=a&&(a.style.display=""))}}(d);top.DEXT5.util.addEvent(b,"click",f);top.DEXT5.util.addEvent(b,"mouseover",l);top.DEXT5.util.addEvent(b,"mouseout",d)}},_setIconEvents:function(){for(var a=this,c=null,b="",d=0,e=G_ICON_FULL_SET.length;d<e;d++)if(b=top.DEXT5.util.trim(G_ICON_FULL_SET[d]).toLowerCase(),c=document.getElementById("ue_"+a.ID+b)){c.setAttribute("title",
dext5_lang.icon[b]);c.setAttribute("alt",dext5_lang.icon[b]);switch(b){case "design":case "source":case "preview":case "text":"textContent"in c?c.textContent=dext5_lang.icon[b]:c.innerText=dext5_lang.icon[b]}var g=function(b){return function(c){a._dextCommands(a.ID,b);top.DEXT5.util.stopEvent(c)}}(b);(function(a){return function(a){return!1}})(b);var f="";switch(b){case "font_family":case "font_size":f="click";break;default:f="click"}top.DEXT5.util.addEvent(c,f,g);c.onmousedown=function(){return!1};
c.unselectable="on"}c=document.getElementsByTagName("span");b=0;for(d=c.length;b<d;b++)e=c[b],e.getAttribute("name")=="span_"+a.ID&&(g=function(b){return function(c){!1==-1<b.className.indexOf("uebutton_span_enter")&&(-1<b.className.indexOf("uebutton_span_on")?b.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+"/skinback_over.gif)":-1<b.className.indexOf("uebutton_dialog_on")&&(b.style.backgroundImage="url("+a._config.webPath.image+"skin/"+a._config.style.skinName+
"/skinback_dialog_over.gif)"));top.DEXT5.util.stopEvent(c)}}(e),f=function(a){return function(b){!1==-1<a.className.indexOf("uebutton_span_enter")&&(a.style.backgroundImage="",top.DEXT5.util.stopEvent(b))}}(e),top.DEXT5.util.addEvent(e,"mouseover",g),top.DEXT5.util.addEvent(e,"mouseout",f));this._load_editor_frame(!0)},_load_editor_frame:function(a){this._EDITOR.design=document.getElementById("dext5_design_"+this.ID);this._EDITOR.source=document.getElementById("dext5_source_"+this.ID);this._EDITOR.preview=
document.getElementById("dext5_preview_"+this.ID);this._EDITOR.text=document.getElementById("dext5_text_"+this.ID);var c=this._EDITOR.design;this._DOC=c.contentDocument?c.contentDocument:c.contentWindow.document;this._BODY=this._DOC.body;"spellcheck"in this._BODY&&(this._BODY.spellcheck=!1);"contentEditable"in this._BODY&&(this._BODY.contentEditable=!0);this._BODY.style.margin="10px 10px 10px 10px";G_USE_EDITOR_ID=this.ID;top.G_CURREDITOR=this;LayerFrame=top.DEXTDOC.getElementById("dext_frame_"+top.G_CURREDITOR.ID);
LayerFrame.title=dext5_lang.iframe_title.layer;dext_src_init_once(c);dext_src_init(c);this.UndoManager.reset();0<_iframeDoc.body.clientWidth&&(this._defTableWidth=_iframeDoc.body.clientWidth-30);100>this._defTableWidth&&(this._defTableWidth=400);document.getElementById("ue_"+this.ID+"font_size")&&(document.getElementById("ue_"+this.ID+"font_size").innerHTML="<span>"+dext5_lang.icon.font_size+"</span>");document.getElementById("ue_"+this.ID+"font_family")&&(document.getElementById("ue_"+this.ID+"font_family").innerHTML=
"<span>"+dext5_lang.icon.font_family+"</span>");""!=this._config.defaultMessage&&(this._BODY.innerHTML="<p>"+this._config.defaultMessage+"</p>");G_dext5plugIn=document.getElementById("dext5plugin");if(a){try{top.DEXTWIN.dext_editor_loaded_event(this.Frame)}catch(b){}if(!1==this._config.style.InitVisible)try{LayerFrame.parentElement.style.display="none",LayerFrame.parentElement.style.width=this._config.style.width,LayerFrame.parentElement.style.height=this._config.style.height}catch(d){}}},_cmd_new:function(){!1==
top.DEXT5.isEmpty()?!0==confirm(dext5_lang.msg.newDocument)&&(top.DEXT5.setBodyValue("","",!0),this.UndoManager.reset(),this._iconEnable(""),setBodyDefalutValue(),setFocusToBody()):(top.DEXT5.setBodyValue("","",!0),this.UndoManager.reset(),this._iconEnable(""),setBodyDefalutValue(),setFocusToBody())},_dextCommands:function(a,c){G_USE_EDITOR_ID=a;top.G_CURREDITOR=this;G_LAST_CMD=c;checkDefaultMessage();var b;b=document.getElementById("ue_"+a+c);if((!b||!(b.parentNode.parentNode&&null!=b.parentNode.parentNode.className.match(/_off/gi)||
b.parentNode.parentNode.parentNode&&null!=b.parentNode.parentNode.parentNode.className.match(/_off/gi)))&&document.getElementById("ue_"+a+SIL[4]+SIL[3]+"ou"+SIL[0]))switch("new"!=c&&("save"!=c&&"print"!=c&&"undo"!=c&&"redo"!=c&&"copy"!=c&&"design"!=c&&"preview"!=c&&"source"!=c&&"text"!=c&&"full_screen"!=c)&&this.UndoManager.putUndo(),c){case "grid":command_grid(a,this);break;case "new":this._cmd_new();break;case "save":command_saveAs(a,this);break;case "print":command_print(a,this);break;case "undo":command_undo(a,
this);break;case "redo":command_redo(a,this);break;case "copy":command_copy(a,this);break;case "cut":command_cut(a,this);break;case "paste":command_pastehtml(a,this);break;case "find":g_findRepalceRange=null;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.find);break;case "replace":g_findRepalceRange=null;DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.replace);break;case "emoticon":null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?
DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_emoticon):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.emoticon);break;case "setting":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.setting);break;case "horizontal_line":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.horizontal_line);break;case "image_create":null==navigator.userAgent.match(/iPad/)&&null!=navigator.userAgent.match(/iPhone|Mobile|UP.Browser|Android|BlackBerry|Windows CE|Nokia|webOS|Opera Mini|SonyEricsson|opera mobi|Windows Phone|IEMobile|POLARIS/)?
DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.m_image):G_dext5plugIn?showSetImageProperty(null):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.image);break;case "image_property":G_dext5plugIn&&top.G_SELECTED_ELEMENT&&-1!=top.G_SELECTED_ELEMENT.src.search("file:///")?showSetImageProperty(top.G_SELECTED_ELEMENT):DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.image);break;case "flash_create":case "flash_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.flash);break;case "media_create":case "media_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.media);break;case "iframe_create":case "iframe_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.iframe);break;case "hyperlink_create":case "hyperlink_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.hyperlink);break;case "bookmark":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.bookmark);break;case "symbol":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.symbol);break;case "doc_bg_image":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.doc_bg_img);break;case "detail_table_insert":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table);break;case "table_insert":this._dextTable.show(a);break;case "table_delete":command_deleteTable(a,this);break;case "merge_cell":command_mergeCell(a,
this);break;case "split_cell":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.split_cell);break;case "insert_row_up":command_insertRowUp(a,this);break;case "insert_row_down":command_insertRowDown(a,this);break;case "delete_row":command_deleteRow(a,this);break;case "insert_column_left":command_insertCellLeft(a,this);break;case "insert_column_right":command_insertCellRight(a,this);break;case "delete_column":command_deleteCell(a,this);break;case "bold":command_bold(a,
this);break;case "underline":command_underline(a,this);break;case "italic":command_italic(a,this);break;case "strike_through":command_strikeThrough(a,this);break;case "superscript":command_superscript(a,this);break;case "subscript":command_subscript(a,this);break;case "remove_format":command_removeFormat(a,this);break;case "font_color":showColorPopup(document,b,void 0,"font_color");break;case "font_bg_color":showColorPopup(document,b,void 0,"font_bg_color");break;case "align_left":command_justifyLeft(a,
this);break;case "align_center":command_justifyCenter(a,this);break;case "align_right":command_justifyRight(a,this);break;case "align_full":command_justifyFull(a,this);break;case "line_height":this._dextLineHeight.show(a);break;case "indent":command_indent(a,this);break;case "outdent":command_outdent(a,this);break;case "list_number":command_insertOrderedList(a,this);break;case "list_bullets":command_insertUnOrderedList(a,this);break;case "full_screen":command_fullScreen(a,this);break;case "formatting":this._dextFormatting.show(a);
break;case "font_family":this._dextFontFamily.show(a);break;case "font_size":this._dextFontSize.show(a);break;case "design":this.setChangeMode("design");break;case "source":this.setChangeMode("source");break;case "preview":this.setChangeMode("preview");break;case "text":this.setChangeMode("text");break;case "about":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.about);break;case "insert_row_column":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.insert_row_column);
break;case "cell_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_property,top.G_SELECTED_ELEMENT);break;case "row_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.row_property);break;case "column_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.column_property);break;case "table_property":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.table_property,
top.G_SELECTED_ELEMENT);break;case "select_all":command_selectAll(a,this);break;case "table_select_cell":command_TableSelect(a,this,"select_cell");break;case "table_select_row":command_TableSelect(a,this,"select_row");break;case "table_select_column":command_TableSelect(a,this,"select_column");break;case "table_select_all":command_TableSelect(a,this,"select_all");break;case "table_same_width":command_TableSameWidthheight(a,this,"same_width");break;case "table_same_height":command_TableSameWidthheight(a,
this,"same_height");break;case "table_same_widthheight":command_TableSameWidthheight(a,this,"same_widthheight");break;case "table_row_clone":command_TableRowClone(a,this);break;case "convert_table_to_text":command_convertTableToText(a,this);break;case "cell_border":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.cell_border,top.G_SELECTED_ELEMENT);break;case "cell_bg_color":showColorPopup(document,b,void 0,"cell_bg_color");break;case "valign_up":command_VerticalAlignExcute(a,
this,"top");break;case "valign_center":command_VerticalAlignExcute(a,this,"middle");break;case "valign_baseline":command_VerticalAlignExcute(a,this,"baseline");break;case "valign_bottom":command_VerticalAlignExcute(a,this,"bottom");break;case "template":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.template);break;case "tool_replace":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,this._config.pages.tool_replace);break;case "insert_link_media":DEXT5_EDITOR.prototype.dialog.show(this._config.webPath.page,
this._config.pages.insert_link_media)}},_dextTable:{_self:function(a){return document.getElementById("dext_pan_table_insert_"+a)},make:function(a){var c=this;if(null!=this._self(a)){var b=document.createElement("table"),d=document.createElement("tbody");b.setAttribute("id","dext_table_pan");for(var e,g,f,l=1;10>=l;l++){e=document.createElement("tr");for(var h="",k=1;10>=k;k++)h="trd_"+a+"_"+l+"_"+k,g=document.createElement("td"),g.style.border="1px solid #000000",g.style.cursor="pointer",f=document.createElement("div"),
f.style.width="12px",f.style.height="12px",f.style.fontSize="1pt",g.appendChild(f),g.setAttribute("id",h),e.appendChild(g),f=function(b){return function(d){c.mouseover_func(a,b);top.DEXT5.util.stopEvent(d)}}(h),h=function(b){return function(d){c.click_func(a,b);top.DEXT5.util.stopEvent(d)}}(h),top.DEXT5.util.addEvent(g,"mouseover",f),top.DEXT5.util.addEvent(g,"click",h),g.onmousedown=function(){return!1},g.unselectable="on";d.appendChild(e)}b.appendChild(d);this._self(a).appendChild(b)}},show:function(a){setFocusTopWindow();
G_SUB_DIALOG=this._self(a);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background()},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background()},click_func:function(a,c){c=c.replace("trd_"+a+"_","");var b=c.split("_");command_InsertTablebyRowCol(a,document.getElementById("dext5_design_"+a),b[0],b[1]);this.hide(a)},mouseover_func:function(a,c){c=c.replace("trd_"+a+"_","");for(var b=c.split("_"),d="",e=1;10>=e;e++)for(var g=1;10>=g;g++)d="trd_"+
a+"_"+e+"_"+g,document.getElementById(d).style.backgroundColor="#ffffff";for(e=1;e<=b[0];e++)for(g=1;g<=b[1];g++)d="trd_"+a+"_"+e+"_"+g,document.getElementById(d).style.backgroundColor="#0697f7";document.getElementById("dext_table_rc_"+a).innerHTML=b[0]+" * "+b[1]},reset:function(a){for(var c="",b=1;10>=b;b++)for(var d=1;10>=d;d++)c="trd_"+a+"_"+b+"_"+d,document.getElementById(c).style.backgroundColor="#ffffff";document.getElementById("dext_table_rc_"+a).innerHTML="0 * 0"}},_dextFontFamily:{_fontFamily:{},
_iframe:null,_iframe_id:"",_iframe_doc:null,_self:function(a){return document.getElementById("dext_pan_font_family_"+a)},make:function(a,c){null!=this._self(a)&&this._set_font_family(a,c)},_set_font_family:function(a,c){var b=this;if(null!=this._self(a)){var d,e,g=top.DEXT5.util.xml.count(c,"font");this._iframe=top.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.font_family;this._iframe.width="180px";this._iframe_id="dext_fontfamily_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display=
"none";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_SUB_DIALOG_ZINDEX+1+"";top.DEXTDOC.body.appendChild(this._iframe);this._iframe_doc=this._iframe.contentWindow.document;d="<html><head><title>"+dext5_lang.font_family.frame_title+'</title></head><body  style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';this._iframe_doc.open();this._iframe_doc.write(d);this._iframe_doc.close();this._fontFamily[a]=[];for(var f=0;f<g;f++){_font_family=top.DEXT5.util.xml.getNodeValueIdx(c,
"font",f);var l="ff_"+a+"_"+f;d=this._iframe_doc.createElement("div");d.setAttribute("id",l);d.style.fontSize="14px";d.style.whiteSpace="nowrap";d.style.margin="3px";d.style.padding="3px";d.style.cursor="pointer";e=this._iframe_doc.createElement("span");var h=_font_family;"textContent"in e?e.textContent=h:e.innerText=h;e.style.fontFamily=_font_family;this._fontFamily[a].push(_font_family);e.onmousedown=function(){return!1};e.unselectable="on";d.appendChild(e);(function(c){return function(d){b.mouseover_func(a,
c);top.DEXT5.util.stopEvent(d)}})(l);e=function(c){return function(d){b.click_func(a,c);top.DEXT5.util.stopEvent(d)}}(f);top.DEXT5.util.addEvent(d,"click",e);d.onmousedown=function(){return!1};d.unselectable="on";this._iframe_doc.body.appendChild(d)}}},mouseover_func:function(a,c){this.reset(a);this._iframe_doc.getElementById(c).style.backgroundColor="#ffffff"},click_func:function(a,c){var b=this.get_value(a,c);document.getElementById("ue_"+a+"font_family").innerHTML="<span>"+b+"</span>";command_fontfamily(a,
document.getElementById("dext5_design_"+a),b);this.hide(a)},show:function(a){setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=top.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();a={};a=getWindowScrollPos(top.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),b=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);this._iframe.style.left=c.left+a[0]+b.left+"px";this._iframe.style.top=c.top+a[1]+b.top+"px";
this._iframe.style.display=""},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var c=this._iframe_doc.getElementsByTagName("div").length,b,d=0;d<c;d++)b="ff_"+a+"_"+d,this._iframe_doc.getElementById(b).style.backgroundColor=""},get_value:function(a,c){return this._fontFamily[a][c]}},_dextFontSize:{_fontSize:{},_iframe:null,_iframe_id:"",_iframe_doc:null,_self:function(a){return document.getElementById("dext_pan_font_size_"+
a)},make:function(a,c,b){var d=this;if(null!=d._self(a)){var e=top.DEXT5.util.xml.count(c,"size");this._iframe=top.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.font_size;this._iframe.width="150px";this._iframe.height="270px";this._iframe_id="dext_fontsize_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_SUB_DIALOG_ZINDEX+1+"";top.DEXTDOC.body.appendChild(this._iframe);this._iframe_doc=
this._iframe.contentWindow.document;var g="<html><head><title>"+dext5_lang.font_size.frame_title+'</title></head><body  style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>';this._iframe_doc.open();this._iframe_doc.write(g);this._iframe_doc.close();this._fontSize[a]=[];for(g=0;g<e;g++){_font_size=top.DEXT5.util.xml.getNodeValueIdx(c,"size",g);var f="fs_"+a+"_"+g;_item=this._iframe_doc.createElement("div");_item.setAttribute("id",f);_item.style.whiteSpace="nowrap";_item.style.margin=
"3px";_item.style.padding="5px";_item.style.cursor="pointer";var l=_font_size.replace("pt","")+" pt";!0==b?_item.style.fontSize=_font_size:(_item.style.fontSize="10 pt",l="        "+_font_size);"textContent"in _item?_item.textContent=l:_item.innerText=l;this._fontSize[a].push(_font_size);(function(b){return function(c){d.mouseover_func(a,b);top.DEXT5.util.stopEvent(c)}})(f);f=function(b){return function(c){d.click_func(a,b);top.DEXT5.util.stopEvent(c)}}(g);top.DEXT5.util.addEvent(_item,"click",f);
_item.onmousedown=function(){return!1};_item.unselectable="on";this._iframe_doc.body.appendChild(_item)}}},mouseover_func:function(a,c){this.reset(a);this._iframe_doc.getElementById(c).style.backgroundColor="#ffffff"},click_func:function(a,c){var b=this.get_value(a,c);document.getElementById("ue_"+a+"font_size").innerHTML="<span>"+b+"</span>";command_fontsize(a,document.getElementById("dext5_design_"+a),b);this.hide(a)},show:function(a){setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=
top.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();a={};a=getWindowScrollPos(top.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),b=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);this._iframe.style.left=c.left+a[0]+b.left+"px";this._iframe.style.top=c.top+a[1]+b.top+"px";this._iframe.style.display=""},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);DEXT5_EDITOR.prototype.dialog._click_background();
this._iframe.style.display="none"},reset:function(a){for(var c=this._iframe_doc.getElementsByTagName("div").length,b,d=0;d<c;d++)b="fs_"+a+"_"+d,this._iframe_doc.getElementById(b).style.backgroundColor=""},get_value:function(a,c){return this._fontSize[a][c]}},_dextFormatting:{_format:["H1","H2","H3","H4","H5"],_iframe:null,_iframe_id:"",_iframe_doc:null,_self:function(a){return document.getElementById("dext_pan_formatting_"+a)},make:function(a,c,b){var d=this;if(null!=d._self(a)){c=d._format.length;
this._iframe=top.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.formatting;this._iframe_id="dext_formatting_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.width="230px";this._iframe.height="200px";this._iframe.style.display="none";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_SUB_DIALOG_ZINDEX+1+"";top.DEXTDOC.body.appendChild(this._iframe);this._iframe_doc=this._iframe.contentWindow.document;b="<html><head><title>"+dext5_lang.formatting.frame_title+
'</title></head><body  style="margin:0px; padding:0px; " oncontextmenu="return false"></body></html>';this._iframe_doc.open();this._iframe_doc.write(b);this._iframe_doc.close();for(var e=null,g=0;g<c;g++){var f="fs_"+a+"_"+g;b=this._iframe_doc.createElement("div");b.setAttribute("id",f);b.style.whiteSpace="nowrap";b.style.width="70px";b.style.width="100%";b.style.cursor="pointer";var l="("+d._format[g]+") Heading";0<d._format.length?(e=this._iframe_doc.createElement(d._format[g]),e.style.fontFamily=
"Dotum Arial","textContent"in e?e.textContent=l:e.innerText=l):(e=this._iframe_doc.createElement("span"),"textContent"in e?e.textContent="Heading":e.innerText="Heading");b.innerHTML=e.outerHTML;(function(b){return function(c){d.mouseover_func(a,b);top.DEXT5.util.stopEvent(c)}})(f);e=function(b){return function(c){d.click_func(a,b);top.DEXT5.util.stopEvent(c)}}(g);top.DEXT5.util.addEvent(b,"click",e);b.onmousedown=function(){return!1};b.unselectable="on";this._iframe_doc.body.appendChild(b)}document.getElementById("ue_"+
a+"formatting").innerHTML="<span>"+dext5_lang.icon.formatting+"</span>"}},mouseover_func:function(a,c){},click_func:function(a,c){var b=this.get_value(a,c);document.getElementById("ue_"+a+"formatting").innerHTML="<span>"+b+"</span>";command_formatting(a,document.getElementById("dext5_design_"+a),b);this.hide(a)},show:function(a){setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=top.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();
a={};a=getWindowScrollPos(top.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),b=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);this._iframe.style.left=c.left+a[0]+b.left+"px";this._iframe.style.top=c.top+a[1]+b.top+"px";this._iframe.style.display=""},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var c=this._iframe_doc.getElementsByTagName("div").length,
b,d=1;d<c;d++)b="fs_"+a+"_"+d,this._iframe_doc.getElementById(b).style.backgroundColor=""},get_value:function(a,c){return this._format[c]}},_dextLineHeight:{_iframe:null,_iframe_id:"",_iframe_doc:null,_line_height_item:"100% 120% 150% 180% 200% 250% 300%".split(" "),_self:function(a){return document.getElementById("dext_pan_line_height_"+a)},make:function(a){var c=this;if(null!=this._self(a)){var b,d=c._line_height_item.length;this._iframe=top.DEXT5.util.makeIframe();this._iframe.title=dext5_lang.iframe_title.line_height;
this._iframe.width="65px";this._iframe.height="200px";this._iframe.scrolling="no";this._iframe_id="dext_lineheight_iframe_"+a;this._iframe.id=this._iframe_id;this._iframe.style.display="none";this._iframe.style.position="absolute";this._iframe.style.zIndex=G_SUB_DIALOG_ZINDEX+1+"";top.DEXTDOC.body.appendChild(this._iframe);this._iframe_doc=this._iframe.contentWindow.document;b="<html><head><title>"+dext5_lang.line_height.frame_title+'</title></head><body  style="margin:0px; padding:0px;" oncontextmenu="return false"></body></html>';
this._iframe_doc.open();this._iframe_doc.write(b);this._iframe_doc.close();for(var e=0;e<d;e++){var g="",g="lh_"+a+"_"+e;b=this._iframe_doc.createElement("div");b.setAttribute("id",g);b.style.fontSize="14px";b.style.width="48px";b.style.margin="3px";b.style.padding="3px";b.style.cursor="pointer";b.style.width="100%";b.innerHTML=c._line_height_item[e];(function(b){return function(d){c.mouseover_func(a,b);top.DEXT5.util.stopEvent(d)}})(g);g=function(b){return function(d){c.click_func(a,b);top.DEXT5.util.stopEvent(d)}}(e);
top.DEXT5.util.addEvent(b,"click",g);b.onmousedown=function(){return!1};b.unselectable="on";this._iframe_doc.body.appendChild(b)}document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+dext5_lang.icon.line_height+"</span>"}},mouseover_func:function(a,c){this.reset(a);this._iframe_doc.getElementById(c).style.backgroundColor="#ffffff"},click_func:function(a,c){_item_id=this.get_value(c);document.getElementById("ue_"+a+"line_height").innerHTML="<span>"+_item_id+"</span>";command_lineHeight(a,
document.getElementById("dext5_design_"+a),_item_id);this.hide(a)},show:function(a){setFocusTopWindow();G_SUB_DIALOG=this._self(a);G_CURRENT_IFRAME=top.DEXTDOC.getElementById(this._iframe_id);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();a={};a=getWindowScrollPos(top.DEXTWIN);var c=getClientRect(G_SUB_DIALOG),b=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);this._iframe.style.left=c.left+a[0]+b.left+"px";this._iframe.style.top=c.top+a[1]+b.top+
"px";this._iframe.style.display=""},hide:function(a){dialogCancel();G_SUB_DIALOG=this._self(a);this.reset(a);DEXT5_EDITOR.prototype.dialog._click_background();this._iframe.style.display="none"},reset:function(a){for(var c,b=this._line_height_item.length,d=1;d<b;d++)c="lh_"+a+"_"+d,this._iframe_doc.getElementById(c)},get_value:function(a){return this._line_height_item[a]}}};DEXT5_EDITOR.prototype.full_screen={toggle:function(){}};
DEXT5_EDITOR.prototype.dialog={_self:function(a){return document.getElementById("dext_dialog_"+a)},_selfTopWindow:function(a){return top.DEXTDOC.getElementById("dext_dialog_"+a)},_background:function(a){var c=document.getElementById("dext_background");null!=c&&void 0!=c?!0==a?(this.set_full_size(c),c.style.display="block"):c.style.display="none":alert("ErrCode : 2000")},_click_background:function(){var a=document.getElementById("dext_click_background");null!=a&&void 0!=a?"block"==a.style.display?
(dialogCancel(),G_SUB_DIALOG&&(G_SUB_DIALOG.style.display="none"),G_CURRENT_IFRAME&&(G_CURRENT_IFRAME.style.display="none"),a.style.display="none"):(document.getElementById("ue_toolbar_"+G_USE_EDITOR_ID).style.position="",this.set_full_size(a),a.style.display="block",G_SUB_DIALOG.style.display="block"):alert("ErrCode : 2001")},set_full_size:function(a){var c=0,b=0;"BackCompat"==document.compatMode?(c=document.body.scrollWidth,b=document.body.scrollHeight):(c=document.documentElement.scrollWidth,b=
document.documentElement.scrollHeight);a.style.width=c+"px";a.style.height=b+"px"},_set_resize:function(a){var c;getElementsByClass("EdiTor_Popup_header",a.contentWindow.document)[0].style.display="none";a.contentWindow.document.body.getElementsByTagName("div")[0].style.border="0px";c="BackCompat"==document.compatMode?a.contentWindow.document.body:a.contentWindow.document.documentElement;var b;b=c.scrollWidth;c=c.scrollHeight;a.style.width=b+"px";a.style.height=c+"px";b=a.parentNode;c=b.firstChild;
var d=a.contentWindow.document.body.getElementsByTagName("div")[0].className,e=getElementsByClass("subject",a.contentWindow.document,"span")[0].innerHTML;b.className=d;c.className="EdiTor_Popup_header";c.firstChild.innerHTML=e;top.DEXT5.util.addEvent(a.contentWindow.document,"keyup",press_enter_esc_btn);top.DEXT5.util.addEvent(top.DEXTDOC,"keyup",press_enter_esc_btn);locationDialog(b)},show:function(a,c){var b=this._selfTopWindow(G_USE_EDITOR_ID),d=this;b.src=a+c;b.parentNode.style.display="block";
b.parentNode.style.left="-800px";b.parentNode.style.top="-800px";b.style.display="block";b.style.position="relative";b.style.left="0px";b.style.top="0px";var e=function(a){top.DEXT5.util.removeEvent(b,"load",e);d._set_resize(b)};top.DEXT5.util.addEvent(b,"load",e)},hide:function(){this._background(!1);var a=document.getElementById("dext_dialog_"+G_USE_EDITOR_ID);a.style.display="none";a.src="about:blank"}};
function event_dext_image_upload(a,c,b,d,e,g,f,l,h,k,m){command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),e,g,f,l,h,k);hideDialog(m)}function event_dext_flash_upload(a,c,b,d,e,g,f,l){command_InsertMedia(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),g,f);hideDialog(l)}
function event_dext_media_upload(a,c,b,d,e,g,f,l){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),f);hideDialog(l)}function event_dext_detail_table_insert(a,c,b,d,e,g,f,l,h,k,m,n,s,p,u,q,r,v,t,w,x,y,z,A,B,C,D,E,F,G){command_InsertDetailTable(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d,e,g,f,l,h,k,m,n,s,p,u,q,r,v,t,w,x,y,z,A,B,C,D,E,F);hideDialog(G)}
function event_dext_table_property(a,c,b,d,e,g,f,l,h,k,m,n,s,p,u,q,r,v,t,w,x,y){command_InsertTableProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d,e,g,f,l,h,k,m,n,s,p,u,q,r,v,t,w,x);hideDialog(y)}function event_dext_cell_property(a,c,b,d,e,g,f,l,h,k,m,n,s,p,u,q,r,v){command_InsertCellProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d,e,g,f,l,h,k,m,n,s,p,u,q,r);hideDialog(v)}
function event_dext_cell_border(a,c,b,d,e){command_InsertCellBorder(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d);hideDialog(e)}function event_dext_dog_bg_img_insert(a,c,b,d,e,g){command_InsertDogBGImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d,e);hideDialog(g)}
function event_dext_emoticon_insert(a,c){command_InsertImage(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),"","","","","",a);hideDialog(c)}function event_dext_insert_row_column(a,c,b,d){command_InsertRowColumn(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b);hideDialog(d)}function event_dext_setting(a,c){command_editorSetting(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}
function event_dext_horizontal_line(a,c,b,d){command_insertHorizontalLine(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b);hideDialog(d)}function event_dext_row_property(a,c,b,d,e){command_RowProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d);hideDialog(e)}function event_dext_column_property(a,c,b,d,e){command_ColumnProperty(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,d);hideDialog(e)}
function event_dext_bookmark_add(a,c){command_InsertBookmark(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c)}function event_dext_create_iframe(a,c){command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}function event_dext_create_hyperlink(a,c){command_InsertHyperLink(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}
function event_dext_split_cell(a,c,b){command_InsertSplitCell(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c);hideDialog(b)}function event_dext_symbol(a,c){command_InsertSymbol(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a);hideDialog(c)}function event_dext_template(a,c){var b=top.DEXT5.ajax.load(top.DEXT5.rootPath+a);null!=b&&setHtmlValueToEditor(b);hideDialog(c)}function event_dext_upload_cancel(a){hideDialog(a);dialogCancel()}
function event_dext_find(a,c,b,d,e,g){command_find(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,d,e,b)}function event_dext_replace(a,c,b,d,e,g,f){command_replace(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,e,g,d)}function event_dext_all_replace(a,c,b,d,e,g,f){command_replaceAll(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a,c,b,e,g,d)}
function event_dext_capital_small_letter(a,c){command_changeWordUpperLower(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),a)}function event_dext_insert_link_media(a,c){var b=getCustomParam(a);command_InsertReplacedImg(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),b);hideDialog(c)}
function onlyNumber(a){window.netscape?34<a.which&&41>a.which||(47<a.which&&58>a.which||95<a.which&&106>a.which||8==a.which||9==a.which||13==a.which||46==a.which)||top.DEXT5.util.cancelEvent(a):34<a.keyCode&&41>a.keyCode||(47<a.keyCode&&58>a.keyCode||95<a.keyCode&&106>a.keyCode||8==a.keyCode||9==a.keyCode||13==a.keyCode||46==a.keyCode)||top.DEXT5.util.cancelEvent(a)}
function locationDialog(a){setFocusTopWindow();var c=top.DEXTDOC.createElement("div");c.setAttribute("id","dext_disabled");c.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:50000; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var b="CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollHeight:top.DEXTDOC.body.scrollHeight;
c.firstChild.style.width=("CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollWidth:top.DEXTDOC.body.scrollWidth)+"px";c.firstChild.style.height=b+"px";top.DEXTDOC.body.appendChild(c);top.DEXT5.util.addEvent(top.DEXTWIN,"resize",setLayerbgResize);a.style.display="block";a.style.zIndex="60000";a.style.position="absolute";var c=a.clientWidth,d=a.clientHeight,e={},e=getWindowClientSize(top.DEXTWIN),b={},b=getWindowScrollPos(top.DEXTWIN);a.style.left=b[0]+e[0]/2-c/2+"px";a.style.top=
b[1]+e[1]/2-d/2+"px";"1"==top.G_CURREDITOR._config.showDialogPosition&&(d=getClientRect(_iframeWin.parent.frameElement),e=getClientRect(_iframeWin.frameElement),a.style.left=b[0]+d.left+((e.right-e.left)/2-c/2)+"px",a.style.top=b[1]+d.top+e.top+10+"px");makeDragPopup(a)}
function localToGlobal(a){var c=a.offsetWidth,b=a.offsetHeight,d=0,e=0,g={},f=function(l){if(l)d+=l.offsetLeft,e+=l.offsetTop,f(l.offsetParent);else return g={top:a.offsetTop+e,left:a.offsetLeft+d,bottom:a.offsetTop+e+b,right:a.offsetLeft+d+c}};f(a.offsetParent);return g}
function setLayerbgResize(){var a=top.DEXTDOC.getElementById("dext_disabled"),c="CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollHeight:top.DEXTDOC.body.scrollHeight;a.firstChild.style.width=("CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollWidth:top.DEXTDOC.body.scrollWidth)+"px";a.firstChild.style.height=c+"px"}
function hideDialog(a){dialogCancel();var c=top.DEXTDOC.getElementById("dext_disabled");null!=c&&(top.DEXT5.util.removeEvent(top.DEXTWIN,"resize",setLayerbgResize),a.style.display="none",a.childNodes[1].style.width="10px",a.childNodes[1].style.height="10px",top.DEXTDOC.body.removeChild(c),top.G_SELECTED_ELEMENT=null,top.DEXT5.util.removeEvent(top.DEXTDOC,"keyup",press_enter_esc_btn))}
function getWindowClientSize(a){var c=0,b=0;"number"==typeof a.innerWidth?(c=a.innerWidth,b=a.innerHeight):a.document.documentElement&&(a.document.documentElement.clientWidth||a.document.documentElement.clientHeight)?(c=a.document.documentElement.clientWidth,b=a.document.documentElement.clientHeight):a.document.body&&(a.document.body.clientWidth||a.document.body.clientHeight)&&(c=a.document.body.clientWidth,b=a.document.body.clientHeight);return[c,b]}
function getWindowScrollPos(a){return"number"===typeof a.pageYOffset?[a.pageXOffset,a.pageYOffset]:a.document.body&&(a.document.body.scrollLeft||a.document.body.scrollTop)?[a.document.body.scrollLeft,a.document.body.scrollTop]:a.document.documentElement&&(a.document.documentElement.scrollLeft||a.document.documentElement.scrollTop)?[a.document.documentElement.scrollLeft,a.document.documentElement.scrollTop]:[0,0]}var _startXY={};
function _MD(a){if(isLeftClick(a)){var c=null,c=a.target?a.target:a.srcElement,c=c.parentElement;a=getMousePosition(a);_startXY.X=a.X-parseIntOr0(c.style.left);_startXY.Y=a.Y-parseIntOr0(c.style.top)}}function _MM(a){if(isLeftClick(a)){var c=getMousePosition(a),b=null,b=a.target?a.target:a.srcElement,b=b.parentElement;b.style.left=c.X-_startXY.X+"px";b.style.top=c.Y-_startXY.Y+"px"}top.DEXT5.util.cancelEvent(a)}function _MU(a){}
function click_plus_func(a,c,b){b=parseIntOr0(a.value,10)+parseIntOr0(b,10);a.value="number"==typeof c?b>c?c:b:b}function click_minus_func(a,c,b,d){b=parseIntOr0(a.value,10)-parseIntOr0(b,10);a.value="number"==typeof c?b<c?c:b:b;void 0!==d&&(!0==d&&b<c)&&(a.value="")}function elementIndexOf(a,c){for(var b,d=document.getElementsByName(c),e=0;e<d.length;e++)if(d[e]==a){b=e;break}return b}
function getElementsByClass(a,c,b){var d=[];null==c&&(c=document);null==b&&(b="*");c=c.getElementsByTagName(b);b=c.length;a=RegExp("(^|\\s)"+a+"(\\s|$)");for(j=i=0;i<b;i++)a.test(c[i].className)&&(d[j]=c[i],j++);return d}function getIframeWin(){return _iframeWin}function getIframeDoc(){return _iframeDoc}Z[0]="h";SIL[0]="t";function isCustomDomain(a){if(!top.DEXT5.browser.ie)return!1;var c=a.domain;a=getDocWindow(a).location.hostname;return c!=a&&c!="["+a+"]"}
function getDocWindow(a){return a.parentWindow||a.defaultView}Z[1]="t";function getIframeDocument(a){return"undefined"!=typeof a.contentDocument?a.contentDocument:"undefined"!=typeof a.contentWindow?a.contentWindow.document:null}function getIframeWindow(a){return"undefined"!=typeof a.contentWindow?a.contentWindow:"undefined"!=typeof a.contentDocument?a.contentDocument.defaultView:null}
function createPopupIframe(a,c,b,d,e,g,f,l,h,k,m){var n=a.createElement("div");n.id=c;n.className=b;n.style.position="absolute";n.style.zIndex=d;n.style.width=e;n.style.height=g;n.style.display=f;b="";void 0===h||""==h?(b="document.open();"+(isCustomDomain(a)?'document.domain="'+a.domain+'";':"")+" document.close();",b=top.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(b)+"}())":""):b=h;c=a.createElement("iframe");c.src=b;c.frameBorder=0;c.style.top="0px";c.style.position="absolute";
c.style.left="0px";c.width="100%";c.height="100%";c.scrolling="no";!0==l&&(c.allowTransparency=!0);n.appendChild(c);a.body.appendChild(n);b=getIframeDocument(c);if(void 0===h||""==h)b.open("text/html"),isCustomDomain(a)&&(b.domain=a.domain),b.write('<html><head><title>DEXT5 Editor Popup Window</title></head><body style="padding:0; margin:0;"></body></html>'),b.close(),!0==l&&(b.body.style.backgroundColor="transparent");a=b.getElementsByTagName("head")[0];for(l=0;l<k.length;l++)h=b.createElement("link"),
h.type="text/css",h.rel="stylesheet",h.href=k[l],a.appendChild(h);b=getIframeDocument(c);a=b.getElementsByTagName("head")[0];for(l=0;l<m.length;l++)k=b.createElement("script"),k.type="text/javascript",k.src=m[l],a.appendChild(k);m={};m.layer=n;m.iframe=c;m.iframeDoc=getIframeDocument(c);m.iframeWin=getIframeWindow(c);return m}Z[2]="t";
function showColorPopup(a,c,b,d,e,g,f){var l=createPopupIframe(a,"popupCover","",70001,"240px","135px","block",!0,"",[_dext_editor._config.webPath.css+"dext.css"],[_dext_editor._config.webPath.js+"jscolor/jscolor.js"]),h=a.createElement("div");h.setAttribute("id","dext_color_back");h.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:70000; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';
var k="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight;h.firstChild.style.width=("CSS1Compat"==a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth)+"px";h.firstChild.style.height=k+"px";a.body.appendChild(h);h.onclick=function(){a.body.removeChild(a.getElementById("popupCover"));a.body.removeChild(h);dialogCancel()};var k=getClientRect(c),m=c.ownerDocument||c.document||a,n;"undefined"!=typeof m.defaultView?n=m.defaultView:"undefined"!=typeof m.parentWindow&&
(n=m.parentWindow);var m=getDocWindow(a),s=null;n!==m&&(s=getClientRect(n.frameElement));null==e&&(e=0);null==g&&(g=0);null==s?(l.layer.style.left=k.left+e+"px",l.layer.style.top=k.bottom+g+"px"):(l.layer.style.left=s.left+k.left+e+"px",l.layer.style.top=s.top+k.bottom+g+"px");var p=l.iframeDoc,u=l.iframeWin,q=G_BASE_COLOR_PICKER;n=q.length;e=p.createElement("ul");e.setAttribute("id","color_ul");top.DEXT5.util.setClass(e,"dext_color");"cssFloat"in e.style?e.style.cssFloat="left":e.style.styleFloat=
"left";for(k=0;k<n;k++){var r="",r="cp_"+G_USE_EDITOR_ID+"_"+k;g=p.createElement("li");g.setAttribute("id",r);g.style.fontSize="1pt";g.setAttribute("title",q[k]);g.style.backgroundColor=q[k];m=function(e){return function(g){r=3<e.length?e:q[e];"#000000"==r&&(r="black");if(""!==b||void 0!==b)c.style[b]=r,void 0!==d&&("font_color"==d?command_fontColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),r):"font_bg_color"==d?command_fontBgColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+
G_USE_EDITOR_ID),r):"doc_bg_color"==d?command_docBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),r):"cell_bg_color"==d?command_cellBGColor(G_USE_EDITOR_ID,document.getElementById("dext5_design_"+G_USE_EDITOR_ID),r):"line_color"==d&&f()),a.body.removeChild(h),a.body.removeChild(a.getElementById("popupCover"));top.DEXT5.util.stopEvent(g)}}(k);top.DEXT5.util.addEvent(g,"click",m);g.onmousedown=function(){return!1};g.unselectable="on";e.appendChild(g)}e.style.width="226px";
e.style.paddingLeft="2px";e.style.paddingRight="2px";e.style.margin="0px";e.style.backgroundColor="#ffffff";var v=/msie ([0-9]{1,}[.0-9]{0,})/;null!=v.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&(e.style.width="230px");var t=p.createElement("div");t.innerHTML="More";t.setAttribute("class","color");t.setAttribute("id","more_btn");t.style.cursor="pointer";t.style.textAlign="center";t.style.width="220px";e.appendChild(t);top.DEXT5.util.addEvent(t,"click",function(){(new u.jscolor.color(t,
{},c,b,d,f)).showPicker();l.layer.style.height="285px";null!=v.exec(navigator.userAgent.toLowerCase())&&"6"==parseFloat(RegExp.$1)&&(l.iframe.style.height="285px");p.getElementById("color_picker").style.display=""});g=p.createElement("div");g.className="DEXT_fiVe_EdiTor";g.appendChild(e);g.style.position="absolute";g.style.width="230px";g.style.border="solid 1px #cccccc";setFocusTopWindow();p.body.appendChild(g)}Z[3]="p";SIL[1]="u";
function showAccessPopup(a,c,b,d,e,g){var f=a.createElement("div");f.setAttribute("id","dext_access_back");f.innerHTML='<div style="filter:alpha(opacity=0); opacity:0; -moz-opacity:0; -ms-filter:progid:DXImageTransform.Microsoft.Alpha(Opacity=0); -khtml-opacity: 0; background-color:white; z-index:70000; position:absolute; left:0px; top:0px;overflow:hidden;width:100%;height:100%;"></div>';var l="CSS1Compat"==a.compatMode?a.documentElement.scrollHeight:a.body.scrollHeight;f.firstChild.style.width=("CSS1Compat"==
a.compatMode?a.documentElement.scrollWidth:a.body.scrollWidth)+"px";f.firstChild.style.height=l+"px";a.body.appendChild(f);f.onclick=function(){a.body.removeChild(f);b.style.display="none"};b.getElementsByTagName("p")[0].innerHTML=d;c=getClientRect(c);b.style.display="";b.style.left=c.left+e+"px";b.style.top=c.top+g+"px"}Z[4]=":";SIL[2]="o";function getClickCell(a,c){var b=null;a.srcElement?b=a.srcElement:a.target&&(b=a.target);if(null!=b)return GetParentbyTagName(b,c)}___=___.href;
function createSelectProtocols(a,c){var b=["http://","https://","ftp://","news://","other"],d=["http://","https://","ftp://","news://",""],e=[],g;for(g in b)e.push(document.createElement("option")),e[g].innerHTML=b[g],e[g].setAttribute("value",d[g]),a.appendChild(e[g]);top.DEXT5.util.addEvent(c,"keyup",function(){for(var d in b)b[d]==c.value&&"other"!=b[d]&&(c.value="",a.options[d].selected="selected")})}SIL[3]="b";Z[5]="/";function lastFocus(a){}Z[6]="/";
function press_enter_esc_btn(a,c){var b="which"in a?a.which:a.keyCode;27==b?hideDialog(top.DEXTDOC.getElementById("dext_dialog")):13==b&&null!=c&&c.click()}Z[7]="w";
function setEditorHeight(a,c){var b={};c?b.height=parseIntOr0(a._config.style.height):b=getClientSize(window.frameElement);var b=b.height,d=document.getElementById("dext_menu_"+a.ID),e=document.getElementById("dext_toolbar_"+a.ID),g=document.getElementById("dext_statusbar_"+a.ID),f,l,h;d&&(f=getClientRect(d));e&&(l=getClientRect(e));g&&(h=getClientRect(g));d=0;f&&(d+=f.bottom-f.top);l&&(d+=l.bottom-l.top);h?(f=h.bottom-h.top,30<f&&(f=23),d+=f):d+=1;a.baseMenuToolbarHeight=d;a._defaultHeight=b-d}
Z[8]="w";SIL[4]="a";
function _fn_0(){var a=T.toString(),a=a.replace(/,/gi,""),c,b,d,e,g;c=b=d=e=g="";try{c=_0_[4],b=_0_[5],d=_0_[7],g=_0_[8],e=_1_}catch(f){alert(a);return}try{if(0==e.length||e!=d){alert(a);return}}catch(l){alert(a);return}try{if(1==g.length&&"1"==g){_1_=!0;return}}catch(h){}try{if(0==b.length){alert(a);return}if("0"!=b){var k=new Date,m=k.getMonth()+1,n=k.getDate(),s=k.getFullYear();b=b.toString();b=b.split("-");if(s>parseIntOr0(b[0])){alert(a);return}if(m>parseIntOr0(b[1])){alert(a);return}if(n>parseIntOr0(b[2])){alert(a);
return}}}catch(p){alert(a);return}try{if(0==c.length){alert(a);return}c=c.split(",");b=!1;c.push("localhost");c.push("127.0.0.1");for(d=0;d<c.length;d++){var u=c[d].replace("*.","");if(-1!=___.search(u)){b=!0;break}else{var q=u.replace("www.","");if(q!=u&&(q="/"+q,-1!=___.search(q))){b=!0;break}}}if(!1==b){alert(a);return}}catch(r){alert(a);return}_1_=!0}
function checkDefaultMessage(a){try{var c=top.G_CURREDITOR._config.firstLoadType;if(""==top.G_CURREDITOR._config.defaultMessage)return!1;""!=top.G_CURREDITOR._config.defaultMessage&&(top.G_CURREDITOR._config.defaultMessage="",top.G_CURREDITOR._config.firstLoadType="");var b=!1;switch(c.toLowerCase()){case "bodyvalue":_setBodyValue(top.G_CURREDITOR._config.firstLoadMessage,top.G_CURREDITOR._config.editor_id);b=!0;break;case "bodyvalueex":_setBodyValueEx(top.G_CURREDITOR._config.firstLoadMessage);b=
!0;break;case "bodyvalueexlikediv":_setBodyValueExLikeDiv(top.G_CURREDITOR._config.firstLoadMessage);b=!0;break;case "htmlvalue":_setHtmlValue(top.G_CURREDITOR._config.firstLoadMessage);b=!0;break;case "htmlvalueex":_setHtmlValueEx(top.G_CURREDITOR._config.firstLoadMessage);b=!0;break;case "url":_loadHtmlValueExFromURL(top.G_CURREDITOR._config.firstLoadMessage,top.G_CURREDITOR._config.editor_id);b=!0;break;default:_setBodyValue("",top.G_CURREDITOR._config.editor_id),top.G_CURREDITOR.UndoManager.reset(),
top.G_CURREDITOR._iconEnable(""),setBodyDefalutValue(),setFocusToBody(),b=!0}}catch(d){}return b};

/* ------------- 1 ------------------ */
top.DEXT5.getEditor=function(a){return _getDEXT5editor(a)};function _getDEXT5editor(a){var b=null,b=getEditorByName(a);return void 0==b||null==b?(alert("Editor's Name is not correct. Please check editor's name."),null):b}top.DEXT5.setEditor=function(a){return _setDEXT5editor(a)};function _setDEXT5editor(a){a=_getDEXT5editor(a);if(void 0==a||null==a)return!1;setCurrentEditor(a);return a}
function getEditorByName(a){var b=null;return b=void 0==a||""==a?top.G_CURREDITOR:top.DEXT5.DEXTMULTIPLE["dext_frame_"+a]}
function setBodyBackground(a){a._PageProp.bshowgrid&&!0==a._PageProp.bshowgrid||(""!=_iframeDoc.body.style.backgroundImage&&(a._PageProp.bodyimage=_iframeDoc.body.style.backgroundImage),""!=_iframeDoc.body.style.backgroundColor&&(a._PageProp.bodycolor=_iframeDoc.body.style.backgroundColor),""!=_iframeDoc.body.style.backgroundAttachment&&(a._PageProp.bodyattachment=_iframeDoc.body.style.backgroundAttachment),""!=_iframeDoc.body.style.backgroundRepeat&&(a._PageProp.bodyrepeat=_iframeDoc.body.style.backgroundRepeat))}
function postimageToServer(a,b){if(G_dext5plugIn&&"0"==b)for(var c=a.body.getElementsByTagName("img"),d=0;d<c.length;d++){var f=c[d],e=G_dext5plugIn.postImageToServer(f.src);f.src=e}}top.DEXT5.getAccessibility=function(a){return getEditorByName(a)._config.accessibility};top.DEXT5.visible=function(a,b){var c="";!1==a&&(c="none");var d=top.DEXTWIN.document.getElementById("dext_frame_holder"+b);d&&(d.style.display=c)};
top.DEXT5.show=function(a){a=top.DEXTWIN.document.getElementById("dext_frame_holder"+a);a&&(a.style.display="")};top.DEXT5.hidden=function(a){a=top.DEXTWIN.document.getElementById("dext_frame_holder"+a);a&&(a.style.display="none")};
top.DEXT5.setSize=function(a,b,c){var d=top.DEXTWIN.document.getElementById("dext_frame_holder"+c),f=top.DEXTWIN.document.getElementById("dext_frame_"+c).contentWindow.document.getElementById("ue_editor_holder_"+c),e=0;c=_setDEXT5editor(c);e=c.baseMenuToolbarHeight;c._defaultHeight=b-e;d.style.width=a+"px";d.style.height=b+"px";f.style.height=c._defaultHeight+"px"};
top.DEXT5.getServerImages=function(a,b){a=a.toLowerCase();var c=_setDEXT5editor(b),d="";if(c){"source"!=c.getEditorMode()&&"text"!=c.getEditorMode()||c.setChangeMode("design");ReplaceImageToRealObject();changeBodyContenteditable(!1);changeBodyImageProperty(!0);for(var f=c._DOC.getElementsByTagName("img"),e="",g="",g=-1,h=0;h<f.length;h++)e=f[h].src,-1<e.toLowerCase().indexOf(a)&&(g=e.lastIndexOf("/"),g=e.substring(g+1),d=""==d?e+"\x0B"+g:d+"\f"+e+"\x0B"+g);c._PageProp.bshowgrid&&!0==c._PageProp.bshowgrid&&
changeBodyImageProperty(!1);ReplaceRealObjectToImage();changeBodyContenteditable(!0)}return d};top.DEXT5.setAccessibility=function(a,b){var c=getEditorByName(b);"0"==a||"1"==a||"2"==a?c._config.accessibility=a+"":alert("The parameter is incorrect.")};
top.DEXT5.getHtmlValueExWithDocType=function(a){a=_setDEXT5editor(a);var b="";a&&("source"!=a.getEditorMode()&&"text"!=a.getEditorMode()||a.setChangeMode("design"),ReplaceImageToRealObject(),changeBodyContenteditable(!1),changeBodyImageProperty(!0),postimageToServer(a._DOC,a._config.mimeUse),b=a._DOC.documentElement.outerHTML,a._PageProp.bshowgrid&&!0==a._PageProp.bshowgrid&&changeBodyImageProperty(!1),ReplaceRealObjectToImage(),changeBodyContenteditable(!0),void 0!=a._PageProp.doctype&&0<a._docType[a._PageProp.doctype].length&&
(b=a._docType[a._PageProp.doctype]+b),!0==top.DEXT5.browser.ie&&(b=top.DEXT5.util.htmlToLowerCase(b)),b=CleanZeroChar(b));return b};top.DEXT5.setHtmlValueEx=function(a,b){_setHtmlValueEx(a,b)};function _setHtmlValueEx(a,b){var c=_setDEXT5editor(b);c?(setHtmlValueToEditor(a,!0),c._dextCustomDataMode=!0,ReplaceRealObjectToImage(),c.UndoManager.reset(),c._iconEnable(""),setBodyDefalutValue(),setFocusToBody(),setBodyBackground(c)):alert("ErrCode : 9004")}
top.DEXT5.loadHtmlValueExFromURL=function(a,b){_loadHtmlValueExFromURL(a,b)};function _loadHtmlValueExFromURL(a,b){var c=_setDEXT5editor(b);if(c){var d=top.DEXT5.ajax.load(a);setHtmlValueToEditor(d,!0);c._dextCustomDataMode=!0;ReplaceRealObjectToImage();c.UndoManager.reset();c._iconEnable("");setBodyDefalutValue();setFocusToBody();setBodyBackground(c);c=top.DEXT5.getBodyValue();_setBodyValue(c)}else alert("ErrCode : 9005")}
top.DEXT5.getHtmlValueEx=function(a){a=_setDEXT5editor(a);var b="";a&&("source"!=a.getEditorMode()&&"text"!=a.getEditorMode()||a.setChangeMode("design"),ReplaceImageToRealObject(),changeBodyContenteditable(!1),changeBodyImageProperty(!0),postimageToServer(a._DOC,a._config.mimeUse),b=a._DOC.documentElement.outerHTML,a._PageProp.bshowgrid&&!0==a._PageProp.bshowgrid&&changeBodyImageProperty(!1),ReplaceRealObjectToImage(),changeBodyContenteditable(!0),!0==top.DEXT5.browser.ie&&(b=top.DEXT5.util.htmlToLowerCase(b)),
b=CleanZeroChar(b));return b};top.DEXT5.setHtmlValue=function(a,b){_setHtmlValue(a,b)};function _setHtmlValue(a,b){var c=_setDEXT5editor(b);c?(setHeadValueToEditor(a),c._dextCustomDataMode=!0,ReplaceRealObjectToImage(),c.UndoManager.reset(),c._iconEnable(""),setBodyDefalutValue(),setFocusToBody(),setBodyBackground(c)):alert("ErrCode : 9003")}
top.DEXT5.getHtmlValue=function(a){a=_setDEXT5editor(a);var b="";a&&("source"!=a.getEditorMode()&&"text"!=a.getEditorMode()||a.setChangeMode("design"),ReplaceImageToRealObject(),changeBodyContenteditable(!1),changeBodyImageProperty(!0),postimageToServer(a._DOC,a._config.mimeUse),b=a._DOC.documentElement.innerHTML,a._PageProp.bshowgrid&&!0==a._PageProp.bshowgrid&&changeBodyImageProperty(!1),ReplaceRealObjectToImage(),changeBodyContenteditable(!0),!0==top.DEXT5.browser.ie&&(b=top.DEXT5.util.htmlToLowerCase(b)),
b=CleanZeroChar(b));return b};top.DEXT5.setBodyValueExLikeDiv=function(a,b){_setBodyValueExLikeDiv(a,b)};function _setBodyValueExLikeDiv(a,b){var c=_setDEXT5editor(b);c?(a=fakeBodyDivForBackground(a,!0),setBodyValueToEditorEx(a),c._dextCustomDataMode=!0,ReplaceRealObjectToImage(),c.UndoManager.reset(),c._iconEnable(""),setBodyDefalutValue(),setFocusToBody(),setBodyBackground(c)):alert("ErrCode : 9002")}
top.DEXT5.getBodyValueExLikeDiv=function(a){a=_setDEXT5editor(a);var b="";a&&("source"!=a.getEditorMode()&&"text"!=a.getEditorMode()||a.setChangeMode("design"),ReplaceImageToRealObject(),changeBodyContenteditable(!1),changeBodyImageProperty(!0),postimageToServer(a._DOC,a._config.mimeUse),b=a._BODY.outerHTML,b=fakeBodyDivForBackground(b,!1),a._PageProp.bshowgrid&&!0==a._PageProp.bshowgrid&&changeBodyImageProperty(!1),ReplaceRealObjectToImage(),changeBodyContenteditable(!0),!0==top.DEXT5.browser.ie&&
(b=top.DEXT5.util.htmlToLowerCase(b)),b=CleanZeroChar(b));return b};top.DEXT5.setBodyValueEx=function(a,b){_setBodyValueEx(a,b)};function _setBodyValueEx(a,b){var c=_setDEXT5editor(b);c?(setBodyValueToEditorEx(a),c._dextCustomDataMode=!0,ReplaceRealObjectToImage(),c.UndoManager.reset(),c._iconEnable(""),setBodyDefalutValue(),setFocusToBody(),setBodyBackground(c)):alert("ErrCode : 9002")}
top.DEXT5.getBodyValueEx=function(a){a=_setDEXT5editor(a);var b="";a&&("source"!=a.getEditorMode()&&"text"!=a.getEditorMode()||a.setChangeMode("design"),ReplaceImageToRealObject(),changeBodyContenteditable(!1),changeBodyImageProperty(!0),postimageToServer(a._DOC,a._config.mimeUse),b=a._BODY.outerHTML,a._PageProp.bshowgrid&&!0==a._PageProp.bshowgrid&&changeBodyImageProperty(!1),ReplaceRealObjectToImage(),changeBodyContenteditable(!0),!0==top.DEXT5.browser.ie&&(b=top.DEXT5.util.htmlToLowerCase(b)),
b=CleanZeroChar(b));return b};top.DEXT5.getBodyValue=function(a){a=_setDEXT5editor(a);var b="";a&&("source"!=a.getEditorMode()&&"text"!=a.getEditorMode()||a.setChangeMode("design"),ReplaceImageToRealObject(),changeBodyImageProperty(!0),postimageToServer(a._DOC,a._config.mimeUse),b=a._BODY.innerHTML,a._PageProp.bshowgrid&&!0==a._PageProp.bshowgrid&&changeBodyImageProperty(!1),ReplaceRealObjectToImage(),!0==top.DEXT5.browser.ie&&(b=top.DEXT5.util.htmlToLowerCase(b)),b=CleanZeroChar(b));return b};
top.DEXT5.setBodyValue=function(a,b,c){_setBodyValue(a,b,c)};function _setBodyValue(a,b,c){(b=_setDEXT5editor(b))?(setBodyValueToEditor(a),!0!=c&&(b._dextCustomDataMode=!0,ReplaceRealObjectToImage()),b.UndoManager.reset(),b._iconEnable(""),setBodyDefalutValue(),setFocusToBody(),setBodyBackground(b)):alert("ErrCode : 9001")}top.DEXT5.dext5EncodeMime=function(a,b){return G_dext5plugIn&&"1"==top.G_CURREDITOR._config.mimeUse?G_dext5plugIn.Dext5EncodeMine(a,b):"0"};
top.DEXT5.getBodyTextValue=function(a){var b="";if(a=_setDEXT5editor(a))"source"!=a.getEditorMode()&&"text"!=a.getEditorMode()||a.setChangeMode("design"),changeBodyImageProperty(!0),b=getAllNodesInBody(a._DOC),top.DEXT5.util.removeTags(a._DOC,a._config.remove_tags),top.DEXT5.util.removeAttributes(a._DOC,a._config.remove_attributes,b),postimageToServer(a._DOC,a._config.mimeUse),b="textContent"in a._BODY?a._BODY.textContent:a._BODY.innerText,a._PageProp.bshowgrid&&!0==a._PageProp.bshowgrid&&changeBodyImageProperty(!1),
b=CleanZeroChar(b);return b};top.DEXT5.isEmpty=function(a){return _setDEXT5editor(a)?(a=top.DEXT5.getBodyValue(a),a=a.replace(/ /gi,""),a=a.replace(/\t/g,""),a=a.replace(/\r?\n?\r?\n/g,""),a=a.replace(/&nbsp;/gi,""),a=a.replace(/<p><\/p>/gi,""),a=a.replace(/<br \/>/gi,""),a=a.replace(/<br>/gi,""),0<a.length?!1:!0):!1};
top.DEXT5.setInsertHTML=function(a,b){if(void 0!=a&&""!=a)try{var c=_setDEXT5editor(b);if(c){dialogCancel();var d=getFirstRange().range;d.collapse(!1);d.pasteHtml(a);d.collapse(!0);c.UndoManager.putUndo()}}catch(f){}};top.DEXT5.setInsertText=function(a,b){if(void 0!=a&&""!=a)try{var c=_setDEXT5editor(b);if(c){dialogCancel();var d=getFirstRange().range;d.collapse(!1);d.pasteText(a);d.collapse(!0);c.UndoManager.putUndo()}}catch(f){}};

/* ------------- 2 ------------------ */
function setContextMenu(b,a){top.DEXT5.util.cancelEvent(b);DEXT5_CONTEXT.show(b)}
var DEXT5_CONTEXT={_config:null,_context_id:"",_context_iframe:null,_context_zIndex:50001,_context_bg_zIndex:5E4,_context_document:null,_context_main:null,_context_sub:null,_context_bg:null,_context_bg_id:"",_width:"",_height:"0",_item_sub_list:{table_insert:["insert_row_up","insert_row_down","insert_column_left","insert_column_right"],table_select:["table_select_cell","table_select_row","table_select_column","table_select_all"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],
cell_size:["table_same_width","table_same_height","table_same_widthheight"],insert_row:["insert_row_up","insert_row_down"],insert_column:["insert_column_left","insert_column_right"],table_tool:["convert_table_to_text"]},_non_image_item:" table_row_clone table_same_widthheight valign_up valign_center valign_baseline valign_bottom image_property table_select table_select_cell table_select_row table_select_column table_select_all cell_size hyperlink_property insert_row insert_column align_vertical insert_row_column cell_property row_property column_property table_insert table_select select_column select_row select_cell iframe_property flash_property media_property table_tool convert_table_to_text".split(" "),
_create:function(){this._context_id="dext_context_iframe"+this._config.editor_id;this._context_bg_id="dext_context_background"+this._config.editor_id;var b=top.DEXTDOC.getElementById(this._context_id);b&&(top.DEXTDOC.body.removeChild(b),b=null);if(!b){try{b=top.DEXTDOC.createElement("<iframe>")}catch(a){b=top.DEXTDOC.createElement("iframe")}b.id=this._context_id;b.style.margin="0px";b.style.padding="0px";b.style.zIndex=this._context_zIndex;b.style.position="absolute";b.scrolling="no";b.style.overflow=
"auto";b.style.overflowX="hidden";b.style.display="none";b.allowTransparency="true";b.frameBorder="0";top.DEXTDOC.body.appendChild(b);var c;c="<html><head>"+('<link rel="stylesheet" type="text/css" href="'+this._config.webPath.css+'dext_context.css" charset="utf-8">');c+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';c+='<div onselectstart="return false;" style="width:100%; height:100%" id="context_iframe_bg">';c+='<div class="DEXT_fiVe_ED_popup">';
c+='<div class="DEXT_fiVe_EDP">';c+='<div class="Dfe_popup DEXT_fiVe_'+this._config.style.skinName+'">';c+='<ul id="div_context_main"></ul>';c+="</div>";c+="</div>";c+='<div class="DEXT_fiVe_EDP_s" id="context_sub" style="display:none; position:relative;">';c+='<div class="Dfe_popup DEXT_fiVe_'+this._config.style.skinName+'">';c+='<ul id="div_context_sub"></ul>';c+="</div>";c+="</div>";c+="</div>";c+="</div>";c+="</body></html>";_context_document=b.contentWindow.document;_context_document.open();
_context_document.write(c);_context_document.close();this._context_iframe=b;this._context_document=_context_document;this._context_main=_context_document.getElementById("div_context_main");this._context_sub=_context_document.getElementById("div_context_sub")}this._context_main.innerHTML="";this._context_sub.innerHTML=""},_setMenu:function(b){setFocusTopWindow();var a=b.tagName.toLowerCase(),c="default",d=getFirstRange().range,e=GetTableSelectionCells();0<e.length?c=1==e.length?"selectedSingleCell":
"selectedMultiCell":d&&0<d.toString().length?"table"==a?(c="focustable",top.G_SELECTED_ELEMENT=b,setSelectoinElement(b)):c="selectArea":"img"==a?(a=b.dext5customdata,null!=a&&void 0!=a?(a=getDextCustomData(a),"iframe"==a.type?(c="focusiframe",top.G_SELECTED_ELEMENT=b):"flash"==a.type?(c="focusflash",top.G_SELECTED_ELEMENT=b):"media"==a.type?(c="focusmedia",top.G_SELECTED_ELEMENT=b):"link_media"==a.type&&(c="focuslinkmedia",top.G_SELECTED_ELEMENT=b)):(c="focusImage",top.G_SELECTED_ELEMENT=b),setSelectoinElement(b)):
"a"==a?(c="focusa",top.G_SELECTED_ELEMENT=b,setSelectoinElement(b)):"table"==a?(c="focustable",top.G_SELECTED_ELEMENT=b,setSelectoinElement(b)):"embed"==a?(c="focusEmbed",top.G_SELECTED_ELEMENT=b,setSelectoinElement(b)):c="td"==a||"th"==a?"focustd":"default";b=[];a=[];switch(c){case "default":b="paste cut copy  select_all  hyperlink_create".split(" ");a=["cut","copy"];this._height="150px";this._width="200px";break;case "selectArea":b=["paste","cut","copy","","select_all"];a=[];this._height="130px";
this._width="200px";break;case "selectedSingleCell":b="paste cut copy  select_all  align_vertical  cell_property".split(" ");a=["cut","copy","paste"];this._height="300px";this._width="400px";break;case "selectedMultiCell":b="paste cut copy  select_all  merge_cell cell_size align_vertical  table_property cell_property".split(" ");a=["cut","copy","paste"];this._height="300px";this._width="400px";break;case "focusImage":b="paste cut copy  select_all  image_property".split(" ");a=["paste","cut","copy"];
this._height="300px";this._width="200px";break;case "focusa":b="paste cut copy  select_all  hyperlink_property".split(" ");a=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focustable":b="paste cut copy  select_all  table_property".split(" ");a=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focusembed":b="paste cut copy  select_all  flash_property".split(" ");a=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focustd":b=
"cut copy paste  insert_row_column insert_row insert_column table_row_clone  delete_row delete_column split_cell  table_select align_vertical  row_property column_property table_tool table_property cell_property".split(" ");a=["cut","copy"];this._width="350px";this._height="500px";break;case "focusiframe":b="paste cut copy  select_all  iframe_property".split(" ");a=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focusflash":b="paste cut copy  select_all  flash_property".split(" ");
a=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focusmedia":b="paste cut copy  select_all  media_property".split(" ");a=["paste","cut","copy"];this._height="300px";this._width="200px";break;case "focuslinkmedia":b="paste cut copy  select_all ".split(" ");a=["cut","copy"];this._height="130px";this._width="200px";break;default:this._height=this._width="1px"}for(c=0;c<b.length;c++)this._addItem(b[c]);this._disableItem(a)},_disableItem:function(b){for(var a=0;a<b.length;a++){var c=
this._context_document.getElementById("context_"+b[a]);c&&(c.className="item_disabled")}},_addItem:function(b){for(var a=0;a<top.G_CURREDITOR.remove_item.length;a++)if(top.G_CURREDITOR.remove_item[a]==b)return;var a=this._context_document.createElement("li"),c=this,d=this._getImageUrl(b),e=this._getText(b),h=this._item_sub_list[b];if(""==e)a.className="b_border";else{var f=this._context_document.createElement("span"),g=this._context_document.createElement("span"),l=this._context_document.createElement("span"),
k=this._context_document.createElement("img");0<d.length&&(k.setAttribute("src",d),k.width="16",k.height="16",k.alt=e,f.appendChild(k));"textContent"in g?g.textContent=e:g.innerText=e;f.className="s_left";g.className="s_right";a.appendChild(f);a.appendChild(g);h?(l.className="arrow",a.appendChild(l),d=function(a){return function(b){if("item_disabled"!=a.className){c._context_sub.innerHTML="";for(var d=0;d<h.length;d++)c._addSubItem(h[d]);d=getClientRect(b.target?b.target:b.srcElement);c._context_document.getElementById("context_sub").style.display=
"";c._context_document.getElementById("context_sub").style.top=d.top-0+"px";a.className="on_mouseover";top.DEXT5.util.stopEvent(b)}}}(a),e=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",top.DEXT5.util.stopEvent(b))}}(a),top.DEXT5.util.addEvent(a,"mouseover",d),top.DEXT5.util.addEvent(a,"mouseout",e)):(d=function(a){return function(b){c._context_document.getElementById("context_sub").style.display="none";"item_disabled"!=a.className&&(a.className="on_mouseover",top.DEXT5.util.stopEvent(b))}}(a),
e=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",top.DEXT5.util.stopEvent(b))}}(a),c=this,f=function(a){return function(d){"on_mouseover"==a.className&&(_dext_editor._dextCommands(_dext_editor.ID,b),c.hide())}}(a),top.DEXT5.util.addEvent(a,"mouseover",d),top.DEXT5.util.addEvent(a,"mouseout",e),top.DEXT5.util.addEvent(a,"click",f))}0<b.length&&(a.id="context_"+b);a.unselectable="on";this._context_main.appendChild(a)},_addSubItem:function(b){for(var a=0;a<top.G_CURREDITOR.remove_item.length;a++)if(top.G_CURREDITOR.remove_item[a]==
b)return;var a=this._context_document.createElement("li"),c=this,d=this._getImageUrl(b),e=this._getText(b);if(""==e)a.className="b_border";else{var h=this._context_document.createElement("span"),f=this._context_document.createElement("span"),g=this._context_document.createElement("img");0<d.length&&(g.setAttribute("src",d),g.width="16",g.height="16",g.alt=e,h.appendChild(g));"textContent"in f?f.textContent=e:f.innerText=e;h.className="s_left";f.className="s_right";a.appendChild(h);a.appendChild(f);
d=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",top.DEXT5.util.stopEvent(b))}}(a);e=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",top.DEXT5.util.stopEvent(b))}}(a);c=this;h=function(a){return function(d){"on_mouseover"==a.className&&(_dext_editor._dextCommands(_dext_editor.ID,b),c.hide())}}(a);top.DEXT5.util.addEvent(a,"mouseover",d);top.DEXT5.util.addEvent(a,"mouseout",e);top.DEXT5.util.addEvent(a,"click",h);0<b.length&&(a.id=
"context_"+b);a.unselectable="on";this._context_sub.appendChild(a)}},_getImageUrl:function(b){for(var a=this._config.webPath.image+"icon/"+b+".gif",c=0;c<this._non_image_item.length;c++)if(b==this._non_image_item[c]){a="";break}return a},_getText:function(b){var a="";""!=b&&(a=dext5_lang.context[b]);return a},show:function(b){var a=b.target?b.target:b.srcElement;if(null!=a){var c=a.tagName.toLowerCase(),d=null;if("img"!=c&&"hr"!=c&&"a"!=c){if("table"!=c||"td"!=c||"th"!=c)d=GetTDTHCell(a);d&&(top.G_SELECTED_ELEMENT=
d)}this._create();null==d?this._setMenu(a):this._setMenu(d);this._context_iframe.style.width=this._width;this._context_iframe.style.height=this._height;a=Math.round(b.clientX);b=Math.round(b.clientY);var c={},c=getWindowScrollPos(top.DEXTWIN),d=getClientRect(_iframeWin.parent.frameElement),e=getClientRect(_iframeWin.frameElement);this._context_iframe.style.left=a+c[0]+d.left+e.left+"px";this._context_iframe.style.top=b+c[1]+d.top+e.top+"px";this._context_iframe.style.display="";this._makeBackground()}},
hide:function(){this._context_iframe&&(this._context_iframe.style.display="none");this._context_bg&&(this._context_bg.style.display="none");this._context_document&&this._context_document.getElementById("context_sub")&&(this._context_document.getElementById("context_sub").style.display="none")},_makeBackground:function(){var b=this;if(this._context_bg=top.DEXTDOC.getElementById(b._context_bg_id))this._context_bg.style.display="";if(!this._context_bg){this._context_bg=top.DEXTDOC.createElement("div");
this._context_bg.id=this._context_bg_id;this._context_bg.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0;  -khtml-opacity: 0.0; background-color:#ffffff; z-index:'+this._context_bg_zIndex+'; position:absolute; left:0px; top:0px;overflow:hidden; width:1px; height:1px; "></div>';top.DEXTDOC.body.appendChild(this._context_bg);var a=function(){return function(a){b.hide()}}(),c=function(){return function(a){a="CSS1Compat"==top.DEXTDOC.compatMode?
top.DEXTDOC.documentElement.scrollHeight:top.DEXTDOC.body.scrollHeight;b._context_bg.firstChild.style.width=("CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollWidth:top.DEXTDOC.body.scrollWidth)+"px";b._context_bg.firstChild.style.height=a+"px"}}();top.DEXT5.util.addEvent(this._context_bg,"click",a);top.DEXT5.util.addEvent(this._context_bg,"contextmenu",a);top.DEXT5.util.addEvent(top.DEXTWIN,"resize",c);top.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),
"click",a);top.DEXT5.util.addEvent(this._context_document.getElementById("context_iframe_bg"),"contextmenu",a);a="CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollHeight:top.DEXTDOC.body.scrollHeight;this._context_bg.firstChild.style.width=("CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollWidth:top.DEXTDOC.body.scrollWidth)-10+"px";this._context_bg.firstChild.style.height=a-10+"px"}}};

/* ------------- 3 ------------------ */
var g_findRepalceRange=null;
function command_find(a,f,d,h,e,k,c){dext_src_init(f);restoreSelection();setFocusToBody();if(0!=d.length)try{a=null;if(null==g_findRepalceRange){var m=getFirstRange().range;a=rangy.createRange(_iframeDoc);a.selectNodeContents(_iframeDoc.body);a.setStart(m.startContainer,m.startOffset)}else a=g_findRepalceRange;h={caseSensitive:h,wholeWordsOnly:e,direction:k?"forward":"backward"};var b=a.findText(d,h);b?(a.select(),k?a.collapse(!1):a.collapse(!0),setAutoScrollToRange(a),g_findRepalceRange=a):g_findRepalceRange&&
c&&(a=k?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),b=a.findText(d,h))&&(a.select(),k?a.collapse(!1):a.collapse(!0),setAutoScrollToRange(a),g_findRepalceRange=a)}catch(g){}}
function command_replace(a,f,d,h,e,k,c,m){dext_src_init(f);restoreSelection();setFocusToBody();if(0!=d.length)try{var b=null;if(null==g_findRepalceRange){var g=getFirstRange().range,b=rangy.createRange(_iframeDoc);b.selectNodeContents(_iframeDoc.body);b.setStart(g.startContainer,g.startOffset)}else b=g_findRepalceRange;var l={caseSensitive:e,wholeWordsOnly:k,direction:c?"forward":"backward"},n=!1,p=(g=getFirstRange().range)&&g.toString();!e&&g&&(d=d.toLowerCase(),p=p.toLowerCase());if(p==d)if(g.collapse(!0),
b.setStart(g.startContainer,g.startOffset),n=b.findText(d,l)){b.select();b.deleteContents();var q=b.getDocument().createTextNode(h);b.insertNode(q);b.selectNode(q);b.select();c?b.collapse(!1):b.collapse(!0);command_find(a,f,d,e,k,c,m)}else g_findRepalceRange&&m&&(b=c?moveCursorToTag(_iframeDoc.body,!0):moveCursorToTag(_iframeDoc.body,!1),n=b.findText(d,l))&&(b.select(),b.deleteContents(),q=b.getDocument().createTextNode(h),b.insertNode(q),b.selectNode(q),b.select(),c?b.collapse(!1):b.collapse(!0),
command_find(a,f,d,e,k,c,m));else command_find(a,f,d,e,k,c,m)}catch(r){}}
function command_replaceAll(a,f,d,h,e,k,c,m){dext_src_init(f);restoreSelection();setFocusToBody();if(0!=d.length)try{g_findRepalceRange=null;range=rangy.createRange(_iframeDoc);range.selectNodeContents(_iframeDoc.body);a={caseSensitive:e,wholeWordsOnly:k,direction:c?"forward":"backward"};for(f=0;range.findText(d,a);){range.select();range.deleteContents();var b=range.getDocument().createTextNode(h);range.insertNode(b);range.selectNode(b);range.select();f+=1;c?range.collapse(!1):range.collapse(!0)}0<
f&&alert(f+dext5_lang.replace.replaceall_result)}catch(g){}}
function command_changeWordUpperLower(a,f,d){dext_src_init(f);restoreSelection();setFocusToBody();a=getFirstRange().range;try{if(a||(a=rangy.createRange(_iframeDoc),a.selectNodeContents(_iframeDoc.body)),a){var h=getNodesInRange(a),e=a.startContainer;e.firstNode&&(e=e.firstNode);var k=a.startOffset,c=a.endContainer;c.lasttNode&&(c=c.lasttNode);var m=a.endOffset;for(a=0;a<h.length;a++){var b=h[a];if(3==b.nodeType){var g=b.nodeValue,l,n,p;l=n=p="";b==e&&b==c?(n=g.substring(0,k),l=g.substring(k,m),p=
g.substring(m,g.length)):b==e&&0<k?(n=g.substring(0,k),l=g.substring(k,g.length)):b==c&&m<g.length?(l=g.substring(0,m),n=g.substring(m,g.length)):l=g;if("UPPER"==d)l=l.toUpperCase();else if("LOWER"==d)l=l.toLowerCase();else if("FIRSTUPPER"==d)l=l.replace(/\b([a-z])/g,function(a){return a.toUpperCase()});else return;g=b==e&&b==c?n+l+p:b==e&&0<k?n+l:l+n;b.nodeValue=g}}rangy.getSelection(_iframeWin).removeAllRanges();moveCursorToTag(_iframeDoc.body,!0)}}catch(q){}}
function moveCursorToTag(a,f){if(null!=a&&void 0!=a){var d=rangy.createRange(_iframeDoc);d.selectNodeContents(a);try{f?d.collapse(!0):d.collapse(!1),rangy.getSelection(_iframeWin).setSingleRange(d)}catch(h){}return d}}function getNextNode(a){if(a.firstChild)return a.firstChild;for(;a;){if(a.nextSibling)return a.nextSibling;a=a.parentNode}}
function getNodesInRange(a){var f=a.startContainer,d=a.endContainer;a=a.commonAncestorContainer;var h=[],e;for(e=f.parentNode;e&&(h.push(e),e!=a);e=e.parentNode);h.reverse();for(e=f;e&&(h.push(e),e!=d);e=getNextNode(e));return h}
function getAllNodesInBody(a,f){var d=[];if(f){var h=a.getElementsByTagName("*");if(h)for(var e=h.length,k=0;k<e;k++){var c=h[k];c.tagName.toLowerCase();1==c.nodeType&&d.push(c)}}else for(c=a.childNodes[0];null!=c;)if(1==c.nodeType&&d.push(c),c.hasChildNodes())c=c.firstChild;else{for(;null==c.nextSibling&&c!=a;)c=c.parentNode;c=c.nextSibling}return d}function setAutoScrollToRange(a){try{var f=a.startContainer.parentNode;if(f){var d=getElementOffset(f);_iframeWin.scroll(d.left,d.top)}}catch(h){}};

/* ------------- 4 ------------------ */
var ImageHTML=function(a,b){this.htmlSource=a;this.range=b},UndoManager=function(){this.arrImageHTML=[];this.limitCount=20;this.currentImage=null;this.index=-1;this.canRedo=this.canUndo=!1};
UndoManager.prototype={reset:function(){this.arrImageHTML=[];this.limitCount=20;this.currentImage=null;this.index=-1;this.canRedo=this.canUndo=!1},putUndo:function(){var a=_iframeDoc.body.innerHTML,a=a.replace(unescape("%uFEFF"),"");this.currentImage&&this.currentImage.htmlSource==a||(a=new ImageHTML(a,null),this.arrImageHTML.length==this.limitCount&&this.arrImageHTML.shift(),this.index=this.arrImageHTML.push(a)-1,this.canRedo=!1,this.currentImage=a,this.canUndo=0<this.arrImageHTML.length?!0:!1)},
execUndo:function(){!1!=this.canUndo&&(this.index-=1,-1==this.index?this.canRedo=this.canUndo=!1:(_iframeDoc.body.innerHTML=this.arrImageHTML[this.index].htmlSource,this.canRedo=!0,0==this.index&&(this.canUndo=!1)))},execRedo:function(){!1!=this.canRedo&&(this.index+=1,_iframeDoc.body.innerHTML=this.arrImageHTML[this.index].htmlSource,this.canUndo=!0,this.index==this.arrImageHTML.length-1&&(this.canRedo=!1))}};

/* ------------- 5 ------------------ */
/**
 * Rangy, a cross-browser JavaScript range and selection library
 * http://code.google.com/p/rangy/
 *
 * Copyright 2013, Tim Down
 * Licensed under the MIT license.
 * Version: 1.3alpha.772
 * Build date: 26 February 2013
 */
var rangy;rangy=rangy||function(){function h(c,d){var e=typeof c[d];return e==b||e==a&&!!c[d]||e=="unknown"}function i(b,c){return typeof b[c]==a&&!!b[c]}function j(a,b){return typeof a[b]!=c}function k(a){return function(b,c){var d=c.length;while(d--)if(!a(b,c[d]))return!1;return!0}}function o(a){return a&&l(a,g)&&n(a,f)}function p(a){return i(a,"body")?a.body:a.getElementsByTagName("body")[0]}function s(a){i(window,"console")&&h(window.console,"log")&&window.console.log(a)}function t(a,b){b?window.alert(a):s(a)}function u(a){r.initialized=!0,r.supported=!1,t("Rangy is not supported on this page in your browser. Reason: "+a,r.config.alertOnFail)}function v(a){t("Rangy warning: "+a,r.config.alertOnWarn)}function y(a){return a.message||a.description||String(a)}function z(){if(r.initialized)return;var a,b=!1,c=!1;h(document,"createRange")&&(a=document.createRange(),l(a,e)&&n(a,d)&&(b=!0),a.detach());var f=p(document);if(!f||f.nodeName.toLowerCase()!="body"){u("No body element found");return}f&&h(f,"createTextRange")&&(a=f.createTextRange(),o(a)&&(c=!0));if(!b&&!c){u("Neither Range nor TextRange are available");return}r.initialized=!0,r.features={implementsDomRange:b,implementsTextRange:c};var g,i;for(var j in q)(g=q[j])instanceof C&&g.init();for(var k=0,m=x.length;k<m;++k)try{x[k](r)}catch(t){i="Rangy init listener threw an exception. Continuing. Detail: "+y(t),s(i)}}function B(a){a=a||window,z();for(var b=0,c=A.length;b<c;++b)A[b](a)}function C(a,b){this.name=a,this.initialized=!1,this.supported=!1,this.init=b}var a="object",b="function",c="undefined",d=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],e=["setStart","setStartBefore","setStartAfter","setEnd","setEndBefore","setEndAfter","collapse","selectNode","selectNodeContents","compareBoundaryPoints","deleteContents","extractContents","cloneContents","insertNode","surroundContents","cloneRange","toString","detach"],f=["boundingHeight","boundingLeft","boundingTop","boundingWidth","htmlText","text"],g=["collapse","compareEndPoints","duplicate","moveToElementText","parentElement","select","setEndPoint","getBoundingClientRect"],l=k(h),m=k(i),n=k(j),q={},r={version:"1.3alpha.772",initialized:!1,supported:!0,util:{isHostMethod:h,isHostObject:i,isHostProperty:j,areHostMethods:l,areHostObjects:m,areHostProperties:n,isTextRange:o,getBody:p},features:{},modules:q,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1}};r.fail=u,r.warn=v,{}.hasOwnProperty?r.util.extend=function(a,b,c){var d,e;for(var f in b)b.hasOwnProperty(f)&&(d=a[f],e=b[f],c&&d!==null&&typeof d=="object"&&e!==null&&typeof e=="object"&&r.util.extend(d,e,!0),a[f]=e);return a}:u("hasOwnProperty not supported"),function(){var a=document.createElement("div");a.appendChild(document.createElement("span"));var b=[].slice,c;try{b.call(a.childNodes,0)[0].nodeType==1&&(c=function(a){return b.call(a,0)})}catch(d){}c||(c=function(a){var b=[];for(var c=0,d=a.length;c<d;++c)b[c]=a[c];return b}),r.util.toArray=c}();var w;h(document,"addEventListener")?w=function(a,b,c){a.addEventListener(b,c,!1)}:h(document,"attachEvent")?w=function(a,b,c){a.attachEvent("on"+b,c)}:u("Document does not have required addEventListener or attachEvent method"),r.util.addListener=w;var x=[];r.init=z,r.addInitListener=function(a){r.initialized?a(r):x.push(a)};var A=[];r.addCreateMissingNativeApiListener=function(a){A.push(a)},r.createMissingNativeApi=B,C.prototype={fail:function(a){throw this.initialized=!0,this.supported=!1,new Error("Module '"+this.name+"' failed to load: "+a)},warn:function(a){r.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,b){r.warn("DEPRECATED: "+a+" in module "+this.name+"is deprecated. Please use "+b+" instead")},createError:function(a){return new Error("Error in Rangy "+this.name+" module: "+a)}},r.createModule=function(a,b){var c=new C(a,function(){if(!c.initialized){c.initialized=!0;try{b(r,c),c.supported=!0}catch(d){var e="Module '"+a+"' failed to load: "+y(d);s(e)}}});q[a]=c},r.requireModules=function(a){for(var b=0,c=a.length,d,e;b<c;++b){e=a[b],d=q[e];if(!d||!(d instanceof C))throw new Error("required module '"+e+"' not found");d.init();if(!d.supported)throw new Error("required module '"+e+"' not supported")}};var D=!1,E=function(a){D||(D=!0,r.initialized||z())};if(typeof window==c){u("No window found");return}if(typeof document==c){u("No document found");return}return h(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",E,!1),w(window,"load",E),r}(),rangy.createModule("DomUtil",function(a,b){function h(a){var b;return typeof a.namespaceURI==c||(b=a.namespaceURI)===null||b=="http://www.w3.org/1999/xhtml"}function i(a){var b=a.parentNode;return b.nodeType==1?b:null}function j(a){var b=0;while(a=a.previousSibling)++b;return b}function k(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}}function l(a,b){var c=[],d;for(d=a;d;d=d.parentNode)c.push(d);for(d=b;d;d=d.parentNode)if(g(c,d))return d;return null}function m(a,b,c){var d=c?b:b.parentNode;while(d){if(d===a)return!0;d=d.parentNode}return!1}function n(a,b){return m(a,b,!0)}function o(a,b,c){var d,e=c?a:a.parentNode;while(e){d=e.parentNode;if(d===b)return e;e=d}return null}function p(a){var b=a.nodeType;return b==3||b==4||b==8}function q(a){if(!a)return!1;var b=a.nodeType;return b==3||b==8}function r(a,b){var c=b.nextSibling,d=b.parentNode;return c?d.insertBefore(a,c):d.appendChild(a),a}function s(a,b,c){var d=a.cloneNode(!1);d.deleteData(0,b),a.deleteData(b,a.length-b),r(d,a);if(c)for(var e=0,f;f=c[e++];)f.node==a&&f.offset>b?(f.node=d,f.offset-=b):f.node==a.parentNode&&f.offset>j(a)&&++f.offset;return d}function t(a){if(a.nodeType==9)return a;if(typeof a.ownerDocument!=c)return a.ownerDocument;if(typeof a.document!=c)return a.document;if(a.parentNode)return t(a.parentNode);throw b.createError("getDocument: no document found for node")}function u(a){var d=t(a);if(typeof d.defaultView!=c)return d.defaultView;if(typeof d.parentWindow!=c)return d.parentWindow;throw b.createError("Cannot get a window object for node")}function v(a){if(typeof a.contentDocument!=c)return a.contentDocument;if(typeof a.contentWindow!=c)return a.contentWindow.document;throw b.createError("getIframeDocument: No Document object found for iframe element")}function w(a){if(typeof a.contentWindow!=c)return a.contentWindow;if(typeof a.contentDocument!=c)return a.contentDocument.defaultView;throw b.createError("getIframeWindow: No Window object found for iframe element")}function x(a){return a&&d.isHostMethod(a,"setTimeout")&&d.isHostObject(a,"document")}function y(a,b,c){var e;a?d.isHostProperty(a,"nodeType")?e=a.nodeType==1&&a.tagName.toLowerCase()=="iframe"?v(a):t(a):x(a)&&(e=a.document):e=document;if(!e)throw b.createError(c+"(): Parameter must be a Window object or DOM node");return e}function z(a){var b;while(b=a.parentNode)a=b;return a}function A(a,c,d,e){var f,g,h,i,k;if(a==d)return c===e?0:c<e?-1:1;if(f=o(d,a,!0))return c<=j(f)?-1:1;if(f=o(a,d,!0))return j(f)<e?-1:1;g=l(a,d),h=a===g?g:o(a,g,!0),i=d===g?g:o(d,g,!0);if(h===i)throw b.createError("comparePoints got to case 4 and childA and childB are the same!");k=g.firstChild;while(k){if(k===h)return-1;if(k===i)return 1;k=k.nextSibling}}function C(a){try{return a.parentNode,!1}catch(b){return!0}}function D(a){if(!a)return"[No node]";if(B&&C(a))return"[Broken node]";if(p(a))return'"'+a.data+'"';if(a.nodeType==1){var b=a.id?' id="'+a.id+'"':"";return"<"+a.nodeName+b+">["+a.childNodes.length+"]["+a.innerHTML.slice(0,20)+"]"}return a.nodeName}function E(a){var b=t(a).createDocumentFragment(),c;while(c=a.firstChild)b.appendChild(c);return b}function G(a){this.root=a,this._next=a}function H(a){return new G(a)}function I(a,b){this.node=a,this.offset=b}function J(a){this.code=this[a],this.codeName=a,this.message="DOMException: "+this.codeName}var c="undefined",d=a.util;d.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method"),d.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var e=document.createElement("div");d.areHostMethods(e,["insertBefore","appendChild","cloneNode"]||!d.areHostObjects(e,["previousSibling","nextSibling","childNodes","parentNode"]))||b.fail("Incomplete Element implementation"),d.isHostProperty(e,"innerHTML")||b.fail("Element is missing innerHTML property");var f=document.createTextNode("test");d.areHostMethods(f,["splitText","deleteData","insertData","appendData","cloneNode"]||!d.areHostObjects(e,["previousSibling","nextSibling","childNodes","parentNode"])||!d.areHostProperties(f,["data"]))||b.fail("Incomplete Text Node implementation");var g=function(a,b){var c=a.length;while(c--)if(a[c]===b)return!0;return!1},B=!1;(function(){var b=document.createElement("b");b.innerHTML="1";var c=b.firstChild;b.innerHTML="<br>",B=C(c),a.features.crashyTextNodes=B})();var F;typeof window.getComputedStyle!=c?F=function(a,b){return u(a).getComputedStyle(a,null)[b]}:typeof document.documentElement.currentStyle!=c?F=function(a,b){return a.currentStyle[b]}:b.fail("No means of obtaining computed style properties found"),G.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next,b,c;if(this._current){b=a.firstChild;if(b)this._next=b;else{c=null;while(a!==this.root&&!(c=a.nextSibling))a=a.parentNode;this._next=c}}return this._current},detach:function(){this._current=this._next=this.root=null}},I.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+D(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}},J.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11},J.prototype.toString=function(){return this.message},a.dom={arrayContains:g,isHtmlNamespace:h,parentElement:i,getNodeIndex:j,getNodeLength:k,getCommonAncestor:l,isAncestorOf:m,isOrIsAncestorOf:n,getClosestAncestorIn:o,isCharacterDataNode:p,isTextOrCommentNode:q,insertAfter:r,splitDataNode:s,getDocument:t,getWindow:u,getIframeWindow:w,getIframeDocument:v,getBody:d.getBody,isWindow:x,getContentDocument:y,getRootContainer:z,comparePoints:A,isBrokenNode:C,inspectNode:D,getComputedStyleProperty:F,fragmentFromNodeChildren:E,createIterator:H,DomPosition:I},a.DOMException=J}),rangy.createModule("DomRange",function(a,b){function r(a,b){return a.nodeType!=3&&(i(a,b.startContainer)||i(a,b.endContainer))}function s(a){return a.document||j(a.startContainer)}function t(a){return new e(a.parentNode,h(a))}function u(a){return new e(a.parentNode,h(a)+1)}function v(a,b,d){var e=a.nodeType==11?a.firstChild:a;return g(b)?d==b.length?c.insertAfter(a,b):b.parentNode.insertBefore(a,d==0?b:l(b,d)):d>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[d]),e}function w(a,b,c){Y(a),Y(b);var d=k(a.startContainer,a.startOffset,b.endContainer,b.endOffset),e=k(a.endContainer,a.endOffset,b.startContainer,b.startOffset);return c?d<=0&&e>=0:d<0&&e>0}function x(a){var b;for(var c,d=s(a.range).createDocumentFragment(),e;c=a.next();){b=a.isPartiallySelectedSubtree(),c=c.cloneNode(!b),b&&(e=a.getSubtreeIterator(),c.appendChild(x(e)),e.detach(!0));d.appendChild(c)}return d}function y(a,b,d){var e,f;d=d||{stop:!1};for(var g,h;g=a.next();)if(a.isPartiallySelectedSubtree()){if(b(g)===!1){d.stop=!0;return}h=a.getSubtreeIterator(),y(h,b,d),h.detach(!0);if(d.stop)return}else{e=c.createIterator(g);while(f=e.next())if(b(f)===!1){d.stop=!0;return}}}function z(a){var b;while(a.next())a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),z(b),b.detach(!0)):a.remove()}function A(a){for(var b,c=s(a.range).createDocumentFragment(),d;b=a.next();){a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),d=a.getSubtreeIterator(),b.appendChild(A(d)),d.detach(!0)):a.remove();c.appendChild(b)}return c}function B(a,b,c){var d=!!b&&!!b.length,e,f=!!c;d&&(e=new RegExp("^("+b.join("|")+")$"));var g=[];return y(new D(a,!1),function(a){(!d||e.test(a.nodeType))&&(!f||c(a))&&g.push(a)}),g}function C(a){var b=typeof a.getName=="undefined"?"Range":a.getName();return"["+b+"("+c.inspectNode(a.startContainer)+":"+a.startOffset+", "+c.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function D(a,b){this.range=a,this.clonePartiallySelectedTextNodes=b;if(!a.collapsed){this.sc=a.startContainer,this.so=a.startOffset,this.ec=a.endContainer,this.eo=a.endOffset;var c=a.commonAncestorContainer;this.sc===this.ec&&g(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc===c&&!g(this.sc)?this.sc.childNodes[this.so]:m(this.sc,c,!0),this._last=this.ec===c&&!g(this.ec)?this.ec.childNodes[this.eo-1]:m(this.ec,c,!0))}}function E(a){this.code=this[a],this.codeName=a,this.message="RangeException: "+this.codeName}function K(a){return function(b,c){var d,e=c?b:b.parentNode;while(e){d=e.nodeType;if(o(a,d))return e;e=e.parentNode}return null}}function O(a,b){}function P(a){}function Q(a,b){}function R(a,b){}function S(a,b){}function T(a){}function U(a,b){}function V(a){return q&&c.isBrokenNode(a)||!o(G,a.nodeType)&&!L(a,!0)}function W(a,b){return b<=(g(a)?a.length:a.childNodes.length)}function X(a){return!!a.startContainer&&!!a.endContainer&&!V(a.startContainer)&&!V(a.endContainer)&&W(a.startContainer,a.startOffset)&&W(a.endContainer,a.endOffset)}function Y(a){P(a);}function bb(a,b){Y(a);var c=a.startContainer,d=a.startOffset,e=a.endContainer,f=a.endOffset,i=c===e;g(e)&&f>0&&f<e.length&&l(e,f,b),g(c)&&d>0&&d<c.length&&(c=l(c,d,b),i?(f-=d,e=c):e==c.parentNode&&f>=h(c)&&f++,d=0),a.setStartAndEnd(c,d,e,f)}function lb(){}function mb(a){a.START_TO_START=db,a.START_TO_END=eb,a.END_TO_END=fb,a.END_TO_START=gb,a.NODE_BEFORE=hb,a.NODE_AFTER=ib,a.NODE_BEFORE_AND_AFTER=jb,a.NODE_INSIDE=kb}function nb(a){mb(a),mb(a.prototype)}function ob(a,b){return function(){Y(this);var c=this.startContainer,d=this.startOffset,e=this.commonAncestorContainer,f=new D(this,!0),g,h;c!==e&&(g=m(c,e,!0),h=u(g),c=h.node,d=h.offset),y(f,T),f.reset();var i=a(f);return f.detach(),b(this,c,d,c,d),i}}function pb(a,b,c){function e(a,b){return function(c){P(this),Q(c,F),Q(p(c),G);var d=(a?t:u)(c);(b?f:i)(this,d.node,d.offset)}}function f(a,c,d){var e=a.endContainer,f=a.endOffset;if(c!==a.startContainer||d!==a.startOffset){if(p(c)!=p(e)||k(c,d,e,f)==1)e=c,f=d;b(a,c,d,e,f)}}function i(a,c,d){var e=a.startContainer,f=a.startOffset;if(c!==a.endContainer||d!==a.endOffset){if(p(c)!=p(e)||k(c,d,e,f)==-1)e=c,f=d;b(a,e,f,c,d)}}a.prototype=new lb,d.extend(a.prototype,{setStart:function(a,b){P(this),O(a,!0),R(a,b),f(this,a,b)},setEnd:function(a,b){P(this),O(a,!0),R(a,b),i(this,a,b)},setStartAndEnd:function(){P(this);var a=arguments,c=a[0],d=a[1],e=c,f=d;switch(a.length){case 3:f=a[2];break;case 4:e=a[2],f=a[3]}b(this,c,d,e,f)},setBoundary:function(a,b,c){this["set"+(c?"Start":"End")](a,b)},setStartBefore:e(!0,!0),setStartAfter:e(!1,!0),setEndBefore:e(!0,!1),setEndAfter:e(!1,!1),collapse:function(a){Y(this),a?b(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):b(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){P(this),O(a,!0),b(this,a,0,a,n(a))},selectNode:function(a){P(this),O(a,!1),Q(a,F);var c=t(a),d=u(a);b(this,c.node,c.offset,d.node,d.offset)},extractContents:ob(A,b),deleteContents:ob(z,b),canSurroundContents:function(){Y(this),T(this.startContainer),T(this.endContainer);var a=new D(this,!0),b=a._first&&r(a._first,this)||a._last&&r(a._last,this);return a.detach(),!b},detach:function(){c(this)},splitBoundaries:function(){bb(this)},splitBoundariesPreservingPositions:function(a){bb(this,a)},normalizeBoundaries:function(){Y(this);var a=this.startContainer,c=this.startOffset,d=this.endContainer,e=this.endOffset,f=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&(d=a,e=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},i=function(b){var f=b.previousSibling;if(f&&f.nodeType==b.nodeType){a=b;var g=b.length;c=f.length,b.insertData(0,f.data),f.parentNode.removeChild(f);if(a==d)e+=c,d=a;else if(d==b.parentNode){var i=h(b);e==i?(d=b,e=g):e>i&&e--}}},j=!0;if(g(d))d.length==e&&f(d);else{if(e>0){var k=d.childNodes[e-1];k&&g(k)&&f(k)}j=!this.collapsed}if(j){if(g(a))c==0&&i(a);else if(c<a.childNodes.length){var l=a.childNodes[c];l&&g(l)&&i(l)}}else a=d,c=e;b(this,a,c,d,e)},collapseToPoint:function(a,b){P(this),O(a,!0),R(a,b),this.setStartAndEnd(a,b)}}),nb(a)}function qb(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a.commonAncestorContainer=a.collapsed?a.startContainer:c.getCommonAncestor(a.startContainer,a.endContainer)}function rb(a,b,d,e,f){a.startContainer=b,a.startOffset=d,a.endContainer=e,a.endOffset=f,a.document=c.getDocument(b),qb(a)}function sb(a){P(a),a.startContainer=a.startOffset=a.endContainer=a.endOffset=a.document=null,a.collapsed=a.commonAncestorContainer=null}function tb(a){this.startContainer=a,this.startOffset=0,this.endContainer=a,this.endOffset=0,this.document=a,qb(this)}a.requireModules(["DomUtil"]);var c=a.dom,d=a.util,e=c.DomPosition,f=a.DOMException,g=c.isCharacterDataNode,h=c.getNodeIndex,i=c.isOrIsAncestorOf,j=c.getDocument,k=c.comparePoints,l=c.splitDataNode,m=c.getClosestAncestorIn,n=c.getNodeLength,o=c.arrayContains,p=c.getRootContainer,q=a.features.crashyTextNodes;D.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null,this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;return a&&(this._next=a!==this._last?a.nextSibling:null,g(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so))),a},remove:function(){var a=this._current,b,c;!g(a)||a!==this.sc&&a!==this.ec?a.parentNode&&a.parentNode.removeChild(a):(b=a===this.sc?this.so:0,c=a===this.ec?this.eo:a.length,b!=c&&a.deleteData(b,c-b))},isPartiallySelectedSubtree:function(){var a=this._current;return r(a,this.range)},getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new tb(s(this.range));var b=this._current,c=b,d=0,e=b,f=n(b);i(b,this.sc)&&(c=this.sc,d=this.so),i(b,this.ec)&&(e=this.ec,f=this.eo),rb(a,c,d,e,f)}return new D(a,this.clonePartiallySelectedTextNodes)},detach:function(a){a&&this.range.detach(),this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}},E.prototype={BAD_BOUNDARYPOINTS_ERR:1,INVALID_NODE_TYPE_ERR:2},E.prototype.toString=function(){return this.message};var F=[1,3,4,5,7,8,10],G=[2,9,11],H=[5,6,10,12],I=[1,3,4,5,7,8,10,11],J=[1,3,4,5,7,8],L=K([9,11]),M=K(H),N=K([6,10,12]),Z=document.createElement("style"),$=!1;try{Z.innerHTML="<b>x</b>",$=Z.firstChild.nodeType==3}catch(_){}a.features.htmlParsingConforms=$;var ab=$?function(a){var b=this.startContainer,d=j(b);var e=null;return b.nodeType==1?e=b:g(b)&&(e=c.parentElement(b)),e===null||e.nodeName=="HTML"&&c.isHtmlNamespace(j(e).documentElement)&&c.isHtmlNamespace(e)?e=d.createElement("body"):e=e.cloneNode(!1),e.innerHTML=a,c.fragmentFromNodeChildren(e)}:function(a){P(this);var b=s(this),d=b.createElement("body");return d.innerHTML=a,c.fragmentFromNodeChildren(d)},cb=["startContainer","startOffset","endContainer","endOffset","collapsed","commonAncestorContainer"],db=0,eb=1,fb=2,gb=3,hb=0,ib=1,jb=2,kb=3;lb.prototype={compareBoundaryPoints:function(a,b){Y(this),S(this.startContainer,b.startContainer);var c,d,e,f,g=a==gb||a==db?"start":"end",h=a==eb||a==db?"start":"end";return c=this[g+"Container"],d=this[g+"Offset"],e=b[h+"Container"],f=b[h+"Offset"],k(c,d,e,f)},insertNode:function(a){Y(this),Q(a,I),T(this.startContainer);var b=v(a,this.startContainer,this.startOffset);this.setStartBefore(b)},cloneContents:function(){Y(this);var a,b;if(this.collapsed)return s(this).createDocumentFragment();if(this.startContainer===this.endContainer&&g(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,this.endOffset),b=s(this).createDocumentFragment(),b.appendChild(a),b;var c=new D(this,!0);return a=x(c),c.detach(),a},canSurroundContents:function(){Y(this),T(this.startContainer),T(this.endContainer);var a=new D(this,!0),b=a._first&&r(a._first,this)||a._last&&r(a._last,this);return a.detach(),!b},surroundContents:function(a){Q(a,J);var b=this.extractContents();if(a.hasChildNodes())while(a.lastChild)a.removeChild(a.lastChild);v(a,this.startContainer,this.startOffset),a.appendChild(b),this.selectNode(a)},cloneRange:function(){Y(this);var a=new tb(s(this)),b=cb.length,c;while(b--)c=cb[b],a[c]=this[c];return a},toString:function(){Y(this);var a=this.startContainer;if(a===this.endContainer&&g(a))return a.nodeType==3||a.nodeType==4?a.data.slice(this.startOffset,this.endOffset):"";var b=[],c=new D(this,!0);return y(c,function(a){(a.nodeType==3||a.nodeType==4)&&b.push(a.data)}),c.detach(),b.join("")},compareNode:function(a){Y(this);var b=a.parentNode,c=h(a);var d=this.comparePoint(b,c),e=this.comparePoint(b,c+1);return d<0?e>0?jb:hb:e>0?ib:kb},comparePoint:function(a,b){return Y(this),U(a,"HIERARCHY_REQUEST_ERR"),S(a,this.startContainer),k(a,b,this.startContainer,this.startOffset)<0?-1:k(a,b,this.endContainer,this.endOffset)>0?1:0},createContextualFragment:ab,toHtml:function(){Y(this);var a=this.commonAncestorContainer.parentNode.cloneNode(!1);return a.appendChild(this.cloneContents()),a.innerHTML},intersectsNode:function(a,b){Y(this),U(a,"NOT_FOUND_ERR");if(j(a)!==s(this))return!1;var c=a.parentNode,d=h(a);U(c,"NOT_FOUND_ERR");var e=k(c,d,this.endContainer,this.endOffset),f=k(c,d+1,this.startContainer,this.startOffset);return b?e<=0&&f>=0:e<0&&f>0},isPointInRange:function(a,b){return Y(this),U(a,"HIERARCHY_REQUEST_ERR"),S(a,this.startContainer),k(a,b,this.startContainer,this.startOffset)>=0&&k(a,b,this.endContainer,this.endOffset)<=0},intersectsRange:function(a){return w(this,a,!1)},intersectsOrTouchesRange:function(a){return w(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var b=k(this.startContainer,this.startOffset,a.startContainer,a.startOffset),c=k(this.endContainer,this.endOffset,a.endContainer,a.endOffset),d=this.cloneRange();return b==-1&&d.setStart(a.startContainer,a.startOffset),c==1&&d.setEnd(a.endContainer,a.endOffset),d}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var b=this.cloneRange();return k(a.startContainer,a.startOffset,this.startContainer,this.startOffset)==-1&&b.setStart(a.startContainer,a.startOffset),k(a.endContainer,a.endOffset,this.endContainer,this.endOffset)==1&&b.setEnd(a.endContainer,a.endOffset),b}},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==kb},containsNodeContents:function(a){return this.comparePoint(a,0)>=0&&this.comparePoint(a,n(a))<=0},containsRange:function(a){var b=this.intersection(a);return b!==null&&a.equals(b)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var c=b.getNodes([3]);if(c.length>0){b.setStart(c[0],0);var d=c.pop();b.setEnd(d,d.length);var e=this.containsRange(b);return b.detach(),e}return this.containsNodeContents(a)},getNodes:function(a,b){return Y(this),B(this,a,b)},getDocument:function(){return s(this)},collapseBefore:function(a){P(this),this.setEndBefore(a),this.collapse(!1)},collapseAfter:function(a){P(this),this.setStartAfter(a),this.collapse(!0)},getBookmark:function(b){var d=s(this),e=a.createRange(d);b=b||c.getBody(d),e.selectNodeContents(b);var f=this.intersection(e),g=0,h=0;return f&&(e.setEnd(f.startContainer,f.startOffset),g=e.toString().length,h=g+f.toString().length,e.detach()),{start:g,end:h,containerNode:b}},moveToBookmark:function(a){var b=a.containerNode,c=0;this.setStart(b,0),this.collapse(!0);var d=[b],e,f=!1,g=!1,h,i,j;while(!g&&(e=d.pop()))if(e.nodeType==3)h=c+e.length,!f&&a.start>=c&&a.start<=h&&(this.setStart(e,a.start-c),f=!0),f&&a.end>=c&&a.end<=h&&(this.setEnd(e,a.end-c),g=!0),c=h;else{j=e.childNodes,i=j.length;while(i--)d.push(j[i])}},getName:function(){return"DomRange"},equals:function(a){return tb.rangesEqual(this,a)},isValid:function(){return X(this)},inspect:function(){return C(this)}},pb(tb,rb,sb),a.rangePrototype=lb.prototype,d.extend(tb,{rangeProperties:cb,RangeIterator:D,copyComparisonConstants:nb,createPrototypeRange:pb,inspect:C,getRangeDocument:s,rangesEqual:function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset}}),a.DomRange=tb,a.RangeException=E}),rangy.createModule("WrappedRange",function(a,b){a.requireModules(["DomUtil","DomRange"]);var c,d,e=a.dom,f=a.util,g=e.DomPosition,h=a.DomRange,i=e.getBody,j=e.getContentDocument,k=e.isCharacterDataNode;a.features.implementsDomRange&&function(){function k(a){var b=g.length,c;while(b--)c=g[b],a[c]=a.nativeRange[c];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}function l(a,b,c,d,e){var f=a.startContainer!==b||a.startOffset!=c,g=a.endContainer!==d||a.endOffset!=e,h=!a.equals(a.nativeRange);if(f||g||h)a.setEnd(d,e),a.setStart(b,c)}function m(a){a.nativeRange.detach(),a.detached=!0;var b=g.length;while(b--)a[g[b]]=null}var d,g=h.rangeProperties,n;c=function(a){if(!a)throw b.createError("WrappedRange: Range must be specified");this.nativeRange=a,k(this)},h.createPrototypeRange(c,l,m),d=c.prototype,d.selectNode=function(a){this.nativeRange.selectNode(a),k(this)},d.cloneContents=function(){return this.nativeRange.cloneContents()},d.surroundContents=function(a){this.nativeRange.surroundContents(a),k(this)},d.collapse=function(a){this.nativeRange.collapse(a),k(this)},d.cloneRange=function(){return new c(this.nativeRange.cloneRange())},d.refresh=function(){k(this)},d.toString=function(){return this.nativeRange.toString()};var o=document.createTextNode("test");i(document).appendChild(o);var p=document.createRange();p.setStart(o,0),p.setEnd(o,0);try{p.setStart(o,1),d.setStart=function(a,b){this.nativeRange.setStart(a,b),k(this)},d.setEnd=function(a,b){this.nativeRange.setEnd(a,b),k(this)},n=function(a){return function(b){this.nativeRange[a](b),k(this)}}}catch(q){d.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(c){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}k(this)},d.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(c){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,b)}k(this)},n=function(a,b){return function(c){try{this.nativeRange[a](c)}catch(d){this.nativeRange[b](c),this.nativeRange[a](c)}k(this)}}}d.setStartBefore=n("setStartBefore","setEndBefore"),d.setStartAfter=n("setStartAfter","setEndAfter"),d.setEndBefore=n("setEndBefore","setStartBefore"),d.setEndAfter=n("setEndAfter","setStartAfter"),p.selectNodeContents(o),p.startContainer==o&&p.endContainer==o&&p.startOffset==0&&p.endOffset==o.length?d.selectNodeContents=function(a){this.nativeRange.selectNodeContents(a),k(this)}:d.selectNodeContents=function(a){this.setStartAndEnd(a,0,e.getNodeLength(a))},p.selectNodeContents(o),p.setEnd(o,3);var r=document.createRange();r.selectNodeContents(o),r.setEnd(o,4),r.setStart(o,2),p.compareBoundaryPoints(p.START_TO_END,r)==-1&&p.compareBoundaryPoints(p.END_TO_START,r)==1?d.compareBoundaryPoints=function(a,b){return b=b.nativeRange||b,a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END),this.nativeRange.compareBoundaryPoints(a,b)}:d.compareBoundaryPoints=function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};var s=document.createElement("div");s.innerHTML="123";var t=s.firstChild,u=i(document);u.appendChild(s),p.setStart(t,1),p.setEnd(t,2),p.deleteContents(),t.data=="13"&&(d.deleteContents=function(){this.nativeRange.deleteContents(),k(this)},d.extractContents=function(){var a=this.nativeRange.extractContents();return k(this),a}),u.removeChild(s),u=null,f.isHostMethod(p,"createContextualFragment")&&(d.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)}),i(document).removeChild(o),p.detach(),r.detach(),d.getName=function(){return"WrappedRange"},a.WrappedRange=c,a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),a.createRange()}}();if(a.features.implementsTextRange){var l=function(a){var b=a.parentElement(),c=a.duplicate();c.collapse(!0);var d=c.parentElement();c=a.duplicate(),c.collapse(!1);var f=c.parentElement(),g=d==f?d:e.getCommonAncestor(d,f);return g==b?g:e.getCommonAncestor(b,g)},m=function(a){return a.compareEndPoints("StartToEnd",a)==0},n=function(a,b,c,d,f){var h=a.duplicate();h.collapse(c);var i=h.parentElement();e.isOrIsAncestorOf(b,i)||(i=b);if(!i.canHaveHTML){var j=new g(i.parentNode,e.getNodeIndex(i));return{boundaryPosition:j,nodeInfo:{nodeIndex:j.offset,containerElement:j.node}}}var l=e.getDocument(i).createElement("span");l.parentNode&&l.parentNode.removeChild(l);var m,n=c?"StartToStart":"StartToEnd",o,p,q,r,s=f&&f.containerElement==i?f.nodeIndex:0,t=i.childNodes.length,u=t,v=u;for(;;){v==t?i.appendChild(l):i.insertBefore(l,i.childNodes[v]),h.moveToElementText(l),m=h.compareEndPoints(n,a);if(m==0||s==u)break;if(m==-1){if(u==s+1)break;s=v}else u=u==s+1?s:v;v=Math.floor((s+u)/2),i.removeChild(l)}r=l.nextSibling;if(m==-1&&r&&k(r)){h.setEndPoint(c?"EndToStart":"EndToEnd",a);var w;if(/[\r\n]/.test(r.data)){var x=h.duplicate(),y=x.text.replace(/\r\n/g,"\r").length;w=x.moveStart("character",y);while((m=x.compareEndPoints("StartToEnd",x))==-1)w++,x.moveStart("character",1)}else w=h.text.length;q=new g(r,w)}else o=(d||!c)&&l.previousSibling,p=(d||c)&&l.nextSibling,p&&k(p)?q=new g(p,0):o&&k(o)?q=new g(o,o.data.length):q=new g(i,e.getNodeIndex(l));return l.parentNode.removeChild(l),{boundaryPosition:q,nodeInfo:{nodeIndex:v,containerElement:i}}},o=function(a,b){var c,d,f=a.offset,g=e.getDocument(a.node),h,j,l=i(g).createTextRange(),m=k(a.node);return m?(c=a.node,d=c.parentNode):(j=a.node.childNodes,c=f<j.length?j[f]:null,d=a.node),h=g.createElement("span"),h.innerHTML="&#feff;",c?d.insertBefore(h,c):d.appendChild(h),l.moveToElementText(h),l.collapse(!b),d.removeChild(h),m&&l[b?"moveStart":"moveEnd"]("character",f),l};d=function(a){this.textRange=a,this.refresh()},d.prototype=new h(document),d.prototype.refresh=function(){var a,b,c,d=l(this.textRange);m(this.textRange)?b=a=n(this.textRange,d,!0,!0).boundaryPosition:(c=n(this.textRange,d,!0,!1),a=c.boundaryPosition,b=n(this.textRange,d,!1,!1,c.nodeInfo).boundaryPosition),this.setStart(a.node,a.offset),this.setEnd(b.node,b.offset)},d.prototype.getName=function(){return"WrappedTextRange"},h.copyComparisonConstants(d),d.rangeToTextRange=function(a){if(a.collapsed)return o(new g(a.startContainer,a.startOffset),!0);var b=o(new g(a.startContainer,a.startOffset),!0),c=o(new g(a.endContainer,a.endOffset),!1),d=i(h.getRangeDocument(a)).createTextRange();return d.setEndPoint("StartToStart",b),d.setEndPoint("EndToEnd",c),d},a.WrappedTextRange=d;if(!a.features.implementsDomRange||a.config.preferTextRange){var p=function(){return this}();typeof p.Range=="undefined"&&(p.Range=d),a.createNativeRange=function(a){return a=j(a,b,"createNativeRange"),i(a).createTextRange()},a.WrappedRange=d}}a.createRange=function(c){return c=j(c,b,"createRange"),new a.WrappedRange(a.createNativeRange(c))},a.createRangyRange=function(a){return a=j(a,b,"createRangyRange"),new h(a)},a.createIframeRange=function(c){return b.deprecationNotice("createIframeRange()","createRange(iframeEl)"),a.createRange(c)},a.createIframeRangyRange=function(c){return b.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)"),a.createRangyRange(c)},a.addCreateMissingNativeApiListener(function(b){var c=b.document;typeof c.createRange=="undefined"&&(c.createRange=function(){return a.createRange(c)}),c=b=null})}),rangy.createModule("WrappedSelection",function(a,b){function r(a){return typeof a=="string"?a=="backward":!!a}function s(a,c){if(!a)return window;if(d.isWindow(a))return a;if(a instanceof T)return a.win;var e=d.getContentDocument(a,b,c);return d.getWindow(e)}function t(a){return s(a,"getWinSelection").getSelection()}function u(a){return s(a,"getDocSelection").document.selection}function I(a,b,c){var d=c?"end":"start",e=c?"start":"end";a.anchorNode=b[d+"Container"],a.anchorOffset=b[d+"Offset"],a.focusNode=b[e+"Container"],a.focusOffset=b[e+"Offset"]}function J(a){var b=a.nativeSelection;a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset}function K(a){a.anchorNode=a.focusNode=null,a.anchorOffset=a.focusOffset=0,a.rangeCount=0,a.isCollapsed=!0,a._ranges.length=0}function L(b){var c;return b instanceof g?(c=a.createNativeRange(b.getDocument()),c.setEnd(b.endContainer,b.endOffset),c.setStart(b.startContainer,b.startOffset)):b instanceof h?c=b.nativeRange:m.implementsDomRange&&b instanceof d.getWindow(b.startContainer).Range&&(c=b),c}function M(a){if(!a.length||a[0].nodeType!=1)return!1;for(var b=1,c=a.length;b<c;++b)if(!d.isAncestorOf(a[0],a[b]))return!1;return!0}function N(a){var c=a.getNodes();if(!M(c))throw b.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return c[0]}function O(a){return!!a&&typeof a.text!="undefined"}function P(a,b){var c=new h(b);a._ranges=[c],I(a,c,!1),a.rangeCount=1,a.isCollapsed=c.collapsed}function Q(b){b._ranges.length=0;if(b.docSelection.type=="None")K(b);else{var c=b.docSelection.createRange();if(O(c))P(b,c);else{b.rangeCount=c.length;var d,e=o(c.item(0));for(var f=0;f<b.rangeCount;++f)d=a.createRange(e),d.selectNode(c.item(f)),b._ranges.push(d);b.isCollapsed=b.rangeCount==1&&b._ranges[0].collapsed,I(b,b._ranges[b.rangeCount-1],!1)}}}function R(a,c){var d=a.docSelection.createRange(),e=N(c),f=o(d.item(0)),g=p(f).createControlRange();for(var h=0,i=d.length;h<i;++h)g.add(d.item(h));try{g.add(e)}catch(j){throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)")}g.select(),Q(a)}function T(a,b,c){this.nativeSelection=a,this.docSelection=b,this._ranges=[],this.win=c,this.refresh()}function U(a){a.win=a.anchorNode=a.focusNode=a._ranges=null,a.rangeCount=a.anchorOffset=a.focusOffset=0,a.detached=!0}function W(a,b){var c=V.length,d,e;while(c--){d=V[c],e=d.selection;if(b=="deleteAll")U(e);else if(d.win==a)return b=="delete"?(V.splice(c,1),!0):e}return b=="deleteAll"&&(V.length=0),null}function Z(a,c){var d=o(c[0].startContainer),e=p(d).createControlRange();for(var f=0,g;f<rangeCount;++f){g=N(c[f]);try{e.add(g)}catch(h){throw b.createError("setRanges(): Element within the one of the specified Ranges could not be added to control selection (does it have layout?)")}}e.select(),Q(a)}function cb(a,b){}function db(b){return function(c,d){var e;this.rangeCount?(e=this.getRangeAt(0),e["set"+(b?"Start":"End")](c,d)):(e=a.createRange(this.win.document),e.setStartAndEnd(c,d)),this.setSingleRange(e,this.isBackward())}}function eb(a){var b=[],c=new j(a.anchorNode,a.anchorOffset),d=new j(a.focusNode,a.focusOffset),e=typeof a.getName=="function"?a.getName():"Selection";if(typeof a.rangeCount!="undefined")for(var f=0,h=a.rangeCount;f<h;++f)b[f]=g.inspect(a.getRangeAt(f));return"["+e+"(Ranges: "+b.join(", ")+")(anchor: "+c.inspect()+", focus: "+d.inspect()+"]"}a.requireModules(["DomUtil","DomRange","WrappedRange"]),a.config.checkSelectionRanges=!0;var c="boolean",d=a.dom,e=a.util,f=e.isHostMethod,g=a.DomRange,h=a.WrappedRange,i=a.DOMException,j=d.DomPosition,k,l,m=a.features,n="Control",o=d.getDocument,p=d.getBody,q=g.rangesEqual,v=f(window,"getSelection"),w=e.isHostObject(document,"selection");m.implementsWinGetSelection=v,m.implementsDocSelection=w;var x=w&&(!v||a.config.preferTextRange);x?(k=u,a.isSelectionValid=function(a){var b=s(a,"isSelectionValid").document,c=b.selection;return c.type!="None"||o(c.createRange().parentElement())==b}):v?(k=t,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected."),a.getNativeSelection=k;var y=k(),z=a.createNativeRange(document),A=p(document),B=e.areHostProperties(y,["anchorNode","focusNode","anchorOffset","focusOffset"]);m.selectionHasAnchorAndFocus=B;var C=f(y,"extend");m.selectionHasExtend=C;var D=typeof y.rangeCount=="number";m.selectionHasRangeCount=D;var E=!1,F=!0;e.areHostMethods(y,["addRange","getRangeAt","removeAllRanges"])&&typeof y.rangeCount=="number"&&m.implementsDomRange&&function(){var a=window.getSelection();if(a){var b=p(document),c=b.appendChild(document.createElement("div"));c.contentEditable="false";var d=c.appendChild(document.createTextNode("\u00a0\u00a0\u00a0")),e=document.createRange();e.setStart(d,1),e.collapse(!0),a.addRange(e),F=a.rangeCount==1,a.removeAllRanges();var f=e.cloneRange();e.setStart(d,0),f.setEnd(d,3),f.setStart(d,2),a.addRange(e),a.addRange(f),E=a.rangeCount==2,b.removeChild(c),a.removeAllRanges(),e.detach(),f.detach()}}(),m.selectionSupportsMultipleRanges=E,m.collapsedNonEditableSelectionsSupported=F;var G=!1,H;A&&f(A,"createControlRange")&&(H=A.createControlRange(),e.areHostProperties(H,["item","add"])&&(G=!0)),m.implementsControlRange=G,B?l=function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:l=function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var S;f(y,"getRangeAt")?S=function(a,b){try{return a.getRangeAt(b)}catch(c){return null}}:B&&(S=function(b){var c=o(b.anchorNode),d=a.createRange(c);return d.setStartAndEnd(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset),d.collapsed!==this.isCollapsed&&d.setStartAndEnd(b.focusNode,b.focusOffset,b.anchorNode,b.anchorOffset),d});var V=[],X=function(a){if(a&&a instanceof T)return a.refresh(),a;a=s(a,"getNativeSelection");var b=W(a),c=k(a),d=w?u(a):null;return b?(b.nativeSelection=c,b.docSelection=d,b.refresh()):(b=new T(c,d,a),V.push({win:a,selection:b})),b};a.getSelection=X,a.getIframeSelection=function(c){return b.deprecationNotice("getIframeSelection()","getSelection(iframeEl)"),a.getSelection(d.getIframeWindow(c))};var Y=T.prototype;if(!x&&B&&e.areHostMethods(y,["removeAllRanges","addRange"])){Y.removeAllRanges=function(){this.nativeSelection.removeAllRanges(),K(this)};var $=function(b,c){var d=g.getRangeDocument(c),e=a.createRange(d);e.collapseToPoint(c.endContainer,c.endOffset),b.nativeSelection.addRange(L(e)),b.nativeSelection.extend(c.startContainer,c.startOffset),b.refresh()};D?Y.addRange=function(b,c){if(G&&w&&this.docSelection.type==n)R(this,b);else if(r(c)&&C)$(this,b);else{var d;E?d=this.rangeCount:(this.removeAllRanges(),d=0),this.nativeSelection.addRange(L(b).cloneRange()),this.rangeCount=this.nativeSelection.rangeCount;if(this.rangeCount==d+1){if(a.config.checkSelectionRanges){var e=S(this.nativeSelection,this.rangeCount-1);e&&!q(e,b)&&(b=new h(e))}this._ranges[this.rangeCount-1]=b,I(this,b,bb(this.nativeSelection)),this.isCollapsed=l(this)}else this.refresh()}}:Y.addRange=function(a,b){r(b)&&C?$(this,a):(this.nativeSelection.addRange(L(a)),this.refresh())},Y.setRanges=function(a){if(G&&a.length>1)Z(this,a);else{this.removeAllRanges();for(var b=0,c=a.length;b<c;++b)this.addRange(a[b])}}}else{if(!(f(y,"empty")&&f(z,"select")&&G&&x))return b.fail("No means of selecting a Range or TextRange was found"),!1;Y.removeAllRanges=function(){try{this.docSelection.empty();if(this.docSelection.type!="None"){var a;if(this.anchorNode)a=o(this.anchorNode);else if(this.docSelection.type==n){var b=this.docSelection.createRange();b.length&&(a=o(b.item(0)))}if(a){var c=p(a).createTextRange();c.select(),this.docSelection.empty()}}}catch(d){}K(this)},Y.addRange=function(a){this.docSelection.type==n?R(this,a):(h.rangeToTextRange(a).select(),this._ranges[0]=a,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,I(this,a,!1))},Y.setRanges=function(a){this.removeAllRanges();var b=a.length;b>1?Z(this,a):b&&this.addRange(a[0])}}Y.getRangeAt=function(a){return this._ranges[a].cloneRange()};var _;if(x)_=function(b){var c;a.isSelectionValid(b.win)?c=b.docSelection.createRange():(c=p(b.win.document).createTextRange(),c.collapse(!0)),b.docSelection.type==n?Q(b):O(c)?P(b,c):K(b)};else if(f(y,"getRangeAt")&&typeof y.rangeCount=="number")_=function(b){if(G&&w&&b.docSelection.type==n)Q(b);else{b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount;if(b.rangeCount){for(var c=0,d=b.rangeCount;c<d;++c)b._ranges[c]=new a.WrappedRange(b.nativeSelection.getRangeAt(c));I(b,b._ranges[b.rangeCount-1],bb(b.nativeSelection)),b.isCollapsed=l(b)}else K(b)}};else{if(!B||typeof y.isCollapsed!=c||typeof z.collapsed!=c||!m.implementsDomRange)return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;_=function(a){var b,c=a.nativeSelection;c.anchorNode?(b=S(c,0),a._ranges=[b],a.rangeCount=1,J(a),a.isCollapsed=l(a)):K(a)}}Y.refresh=function(a){var b=a?this._ranges.slice(0):null,c=this.anchorNode,d=this.anchorOffset;_(this);if(a){var e=b.length;if(e!=this._ranges.length)return!0;if(this.anchorNode!=c||this.anchorOffset!=d)return!0;while(e--)if(!q(b[e],this._ranges[e]))return!0;return!1}};var ab=function(b,c){var d=b.getAllRanges();b.removeAllRanges();for(var e=0,f=d.length;e<f;++e)a.rangesEqual(c,d[e])||b.addRange(d[e]);b.rangeCount||K(b)};G?Y.removeRange=function(a){if(this.docSelection.type==n){var b=this.docSelection.createRange(),c=N(a),d=o(b.item(0)),e=p(d).createControlRange(),f,g=!1;for(var h=0,i=b.length;h<i;++h)f=b.item(h),f!==c||g?e.add(b.item(h)):g=!0;e.select(),Q(this)}else ab(this,a)}:Y.removeRange=function(a){ab(this,a)};var bb;!x&&B&&m.implementsDomRange?(bb=function(a){var b=!1;return a.anchorNode&&(b=d.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset)==1),b},Y.isBackward=function(){return bb(this)}):bb=Y.isBackward=function(){return!1},Y.isBackwards=Y.isBackward,Y.toString=function(){var a=[];for(var b=0,c=this.rangeCount;b<c;++b)a[b]=""+this._ranges[b];return a.join("")},Y.collapse=function(b,c){cb(this,b);var d=a.createRange(b);d.collapseToPoint(b,c),this.setSingleRange(d),this.isCollapsed=!0},Y.collapseToStart=function(){var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)},Y.collapseToEnd=function(){var a=this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)},Y.selectAllChildren=function(b){cb(this,b);var c=a.createRange(b);c.selectNodeContents(b),this.removeAllRanges(),this.addRange(c)},Y.deleteFromDocument=function(){if(G&&w&&this.docSelection.type==n){var a=this.docSelection.createRange(),b;while(a.length)b=a.item(0),a.remove(b),b.parentNode.removeChild(b);this.refresh()}else if(this.rangeCount){var c=this.getAllRanges();if(c.length){this.removeAllRanges();for(var d=0,e=c.length;d<e;++d)c[d].deleteContents();this.addRange(c[e-1])}}},Y.eachRange=function(a,b){for(var c=0,d=this._ranges.length;c<d;++c)if(a(this.getRangeAt(c)))return b},Y.getAllRanges=function(){var a=[];return this.eachRange(function(b){a.push(b)}),a},Y.setSingleRange=function(a,b){this.removeAllRanges(),this.addRange(a,b)},Y.callMethodOnEachRange=function(a,b){var c=[];return this.eachRange(function(d){c.push(d[a].apply(d,b))}),c},Y.setStart=db(!0),Y.setEnd=db(!1),a.rangePrototype.select=function(a){X(this.getDocument()).setSingleRange(this,a)},Y.changeEachRange=function(a){var b=[],c=this.isBackward();this.eachRange(function(c){a(c),b.push(c)}),this.removeAllRanges(),c&&b.length==1?this.addRange(b[0],"backward"):this.setRanges(b)},Y.containsNode=function(a,b){return this.eachRange(function(c){return c.containsNode(a,b)},!0)},Y.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}},Y.moveToBookmark=function(b){var c=[];for(var d=0,e,f;e=b.rangeBookmarks[d++];)f=a.createRange(this.win),f.moveToBookmark(e),c.push(f);b.backward?this.setSingleRange(c[0],"backward"):this.setRanges(c)},Y.toHtml=function(){return this.callMethodOnEachRange("toHtml").join("")},Y.getName=function(){return"WrappedSelection"},Y.inspect=function(){return eb(this)},Y.detach=function(){W(this.win,"delete"),U(this)},T.detachAll=function(){W(null,"deleteAll")},T.inspect=eb,T.isDirectionBackward=r,a.Selection=T,a.selectionPrototype=Y,a.addCreateMissingNativeApiListener(function(a){typeof a.getSelection=="undefined"&&(a.getSelection=function(){return X(a)}),a=null})})

/* ------------- 6 ------------------ */
/**
 * Text range module for Rangy.
 * Text-based manipulation and searching of ranges and selections.
 *
 * Features
 *
 * - Ability to move range boundaries by character or word offsets
 * - Customizable word tokenizer
 * - Ignores text nodes inside <script> or <style> elements or those hidden by CSS display and visibility properties
 * - Range findText method to search for text or regex within the page or within a range. Flags for whole words and case
 *   sensitivity
 * - Selection and range save/restore as text offsets within a node
 * - Methods to return visible text within a range or selection
 * - innerText method for elements
 *
 * References
 *
 * https://www.w3.org/Bugs/Public/show_bug.cgi?id=13145
 * http://aryeh.name/spec/innertext/innertext.html
 * http://dvcs.w3.org/hg/editing/raw-file/tip/editing.html
 *
 * Part of Rangy, a cross-browser JavaScript range and selection library
 * http://code.google.com/p/rangy/
 *
 * Depends on Rangy core.
 *
 * Copyright 2013, Tim Down
 * Licensed under the MIT license.
 * Version: 1.3alpha.772
 * Build date: 26 February 2013
 */
rangy.createModule("TextRange",function(a,b){function t(a,b){function f(b,c,d){var f=a.slice(b,c),g={isWord:d,chars:f,toString:function(){return f.join("")}};for(var h=0,i=f.length;h<i;++h)f[h].token=g;e.push(g)}var c=a.join(""),d,e=[],g=0,h,i;while(d=b.wordRegex.exec(c)){h=d.index,i=h+d[0].length,h>g&&f(g,h,!1);if(b.includeTrailingSpace)while(m.test(a[i]))++i;f(h,i,!0),g=i}return g<a.length&&f(g,a.length,!1),e}function x(a,b){if(!a)return b;var c={};return h(c,b),h(c,a),c}function y(a){var b,c;return a?(b=a.language||o,c={},h(c,w[b]||w[o]),h(c,a),c):w[o]}function z(a){return x(a,u)}function A(a){return x(a,v)}function I(a,b){var c=F(a,"display",b),d=a.tagName.toLowerCase();return c=="block"&&G&&H.hasOwnProperty(d)?H[d]:c}function J(a){var b=P(a);for(var c=0,d=b.length;c<d;++c)if(b[c].nodeType==1&&I(b[c])=="none")return!0;return!1}function K(a){var b;return a.nodeType==3&&(b=a.parentNode)&&F(b,"visibility")=="hidden"}function L(a){return a&&(a.nodeType==1&&!/^(inline(-block|-table)?|none)$/.test(I(a))||a.nodeType==9||a.nodeType==11)}function M(a){var b=a.lastChild;return b?M(b):a}function N(a){return f.isCharacterDataNode(a)||!/^(area|base|basefont|br|col|frame|hr|img|input|isindex|link|meta|param)$/i.test(a.nodeName)}function O(a){var b=[];while(a.parentNode)b.unshift(a.parentNode),a=a.parentNode;return b}function P(a){return O(a).concat([a])}function Q(a){var b;return typeof (b=a.namespaceURI)==c||b===null||b=="http://www.w3.org/1999/xhtml"}function R(a,b){if(!a||a.nodeType!=1||!Q(a))return!1;switch(typeof b){case"string":return a.tagName.toLowerCase()==b.toLowerCase();case"object":return(new RegExp("^("+b.join("|S")+")$","i")).test(a.tagName);default:return!0}}function S(a){while(a&&!a.nextSibling)a=a.parentNode;return a?a.nextSibling:null}function T(a,b){return!b&&a.hasChildNodes()?a.firstChild:S(a)}function U(a){var b=a.previousSibling;if(b){a=b;while(a.hasChildNodes())a=a.lastChild;return a}var c=a.parentNode;return c&&c.nodeType==1?c:null}function V(a){if(!a||a.nodeType!=3)return!1;var b=a.data;if(b==="")return!0;var c=a.parentNode;if(!c||c.nodeType!=1)return!1;var d=F(a.parentNode,"whiteSpace");return/^[\t\n\r ]+$/.test(b)&&/^(normal|nowrap)$/.test(d)||/^[\t\r ]+$/.test(b)&&d=="pre-line"}function W(a){if(a.data==="")return!0;if(!V(a))return!1;var b=a.parentNode;return b?J(a)?!0:!1:!0}function X(a){var b=a.nodeType;return b==7||b==8||J(a)||/^(script|style)$/i.test(a.nodeName)||K(a)||W(a)}function Y(a,b){var c=a.nodeType;return c==7||c==8||c==1&&I(a,b)=="none"}function Z(){this.store={}}function ab(a,b,c){return function(d){var e=this.cache;if(e.hasOwnProperty(a))return $++,e[a];_++;var f=b.call(this,c?this[c]:this,d);return e[a]=f,f}}function bb(a,b){this.node=a,this.session=b,this.cache=new Z,this.positions=new Z}function kb(a,b){this.offset=b,this.nodeWrapper=a,this.node=a.node,this.session=a.session,this.cache=new Z}function lb(){return"[Position("+f.inspectNode(this.node)+":"+this.offset+")]"}function pb(){return rb(),nb=new ob}function qb(){return nb||pb()}function rb(){nb&&nb.detach(),nb=null}function sb(a,c,d,e){function h(){var a=null,b=null;return c?(b=f,g||(f=f.previousVisible(),g=!f||d&&f.equals(d))):g||(b=f=f.nextVisible(),g=!f||d&&f.equals(d)),g&&(f=null),b}d&&(c?X(d.node)&&(d=a.previousVisible()):X(d.node)&&(d=d.nextVisible()));var f=a,g=!1,i,j=!1;return{next:function(){if(j)return j=!1,i;var a,b;while(a=h()){b=a.getCharacter(e);if(b)return i=a,a}return null},rewind:function(){if(!i)throw b.createError("createCharacterIterator: cannot rewind. Only one position can be rewound.");j=!0},dispose:function(){a=d=null}}}function ub(a,b,c){function g(a){var b,c,f=[],g=a?d:e,h=!1,i=!1;while(b=g.next()){c=b.character;if(l.test(c))i&&(i=!1,h=!0);else{if(h){g.rewind();break}i=!0}f.push(b)}return f}function n(a){var b=["["+a.length+"]"];for(var c=0;c<a.length;++c)b.push("(word: "+a[c]+", is word: "+a[c].isWord+")");return b}var d=sb(a,!1,null,b),e=sb(a,!0,null,b),f=c.tokenizer,h=g(!0),i=g(!1).reverse(),j=f(i.concat(h),c),k=h.length?j.slice(tb(j,h[0].token)):[],m=i.length?j.slice(0,tb(j,i.pop().token)+1):[];return{nextEndToken:function(){var a,b;while(k.length==1&&!(a=k[0]).isWord&&(b=g(!0)).length>0)k=f(a.chars.concat(b),c);return k.shift()},previousStartToken:function(){var a,b;while(m.length==1&&!(a=m[0]).isWord&&(b=g(!1)).length>0)m=f(b.reverse().concat(a.chars),c);return m.pop()},dispose:function(){d.dispose(),e.dispose(),k=m=null}}}function vb(a,b,c,f,g){var h=0,i,j=a,k,l,m=Math.abs(c),n;if(c!==0){var o=c<0;switch(b){case d:k=sb(a,o,null,f);while((i=k.next())&&h<m)++h,j=i;l=i,k.dispose();break;case e:var p=ub(a,f,g),q=o?p.previousStartToken:p.nextEndToken;while((n=q())&&h<m)n.isWord&&(++h,j=o?n.chars[0]:n.chars[n.chars.length-1]);break;default:throw new Error("movePositionBy: unit '"+b+"' not implemented")}o?(j=j.previousVisible(),h=-h):j&&j.isLeadingSpace&&(b==e&&(k=sb(a,!1,null,f),l=k.next(),k.dispose()),l&&(j=l.previousVisible()))}return{position:j,unitsMoved:h}}function wb(a,b,c,d){var e=a.getRangeBoundaryPosition(b,!0),f=a.getRangeBoundaryPosition(b,!1),g=d?f:e,h=d?e:f;return sb(g,!!d,h,c)}function xb(a,b,c){var d=[],e=wb(a,b,c),f;while(f=e.next())d.push(f);return e.dispose(),d}function yb(b,c,d){var e=a.createRange(b.node);e.setStartAndEnd(b.node,b.offset,c.node,c.offset);var f=!e.expand("word",d);return e.detach(),f}function zb(a,b,c,d,e){function r(a,b){var c=i[a].previousVisible(),d=i[b-1],f=!e.wholeWordsOnly||yb(c,d,e.wordOptions);return{startPos:c,endPos:d,valid:f}}var f=p(e.direction),g=sb(a,f,a.session.getRangeBoundaryPosition(d,f),e),h="",i=[],j,k,l,m,n,o,q=null;while(j=g.next()){k=j.character,!c&&!e.caseSensitive&&(k=k.toLowerCase()),f?(i.unshift(j),h=k+h):(i.push(j),h+=k);if(c){n=b.exec(h);if(n)if(o){l=n.index,m=l+n[0].length;if(!f&&m<h.length||f&&l>0){q=r(l,m);break}}else o=!0}else if((l=h.indexOf(b))!=-1){q=r(l,l+b.length);break}}return o&&(q=r(l,m)),g.dispose(),q}function Ab(a){return function(){var b=!!nb,c=qb(),d=[c].concat(g.toArray(arguments)),e=a.apply(this,d);return b||rb(),e}}function Bb(a,b){return Ab(function(c,e,f,g){typeof f=="undefined"&&(f=e,e=d),g=x(g,C);var h=z(g.characterOptions),i=y(g.wordOptions),j=a;b&&(j=f>=0,this.collapse(!j));var k=vb(c.getRangeBoundaryPosition(this,j),e,f,h,i),l=k.position;return this[j?"setStart":"setEnd"](l.node,l.offset),k.unitsMoved})}function Cb(a){return Ab(function(b,c){c=z(c);var d,e=wb(b,this,c,!a),f=0;while((d=e.next())&&l.test(d.character))++f;e.dispose();var g=f>0;return g&&this[a?"moveStart":"moveEnd"]("character",a?f:-f,{characterOptions:c}),g})}function Db(a){return Ab(function(b,c){var d=!1;return this.changeEachRange(function(b){d=b[a](c)||d}),d})}a.requireModules(["WrappedSelection"]);var c="undefined",d="character",e="word",f=a.dom,g=a.util,h=g.extend,i=f.getBody,j=/^[ \t\f\r\n]+$/,k=/^[ \t\f\r]+$/,l=/^[\t-\r \u0085\u00A0\u1680\u180E\u2000-\u200B\u2028\u2029\u202F\u205F\u3000]+$/,m=/^[\t \u00A0\u1680\u180E\u2000-\u200B\u202F\u205F\u3000]+$/,n=/^[\n-\r\u0085\u2028\u2029]$/,o="en",p=a.Selection.isDirectionBackward,q=!1,r=!1,s=!0;(function(){var b=document.createElement("div");b.contentEditable="true",b.innerHTML="<p>1 </p><p></p>";var c=i(document),d=b.firstChild,e=a.getSelection();c.appendChild(b),e.collapse(d.lastChild,2),e.setStart(d.firstChild,0),q=(""+e).length==1,b.innerHTML="1 <br>",e.collapse(b,2),e.setStart(b.firstChild,0),r=(""+e).length==1,c.removeChild(b),e.removeAllRanges()})();var u={includeBlockContentTrailingSpace:!0,includeSpaceBeforeBr:!0,includePreLineTrailingSpace:!0},v={includeBlockContentTrailingSpace:!s,includeSpaceBeforeBr:!r,includePreLineTrailingSpace:!0},w={en:{wordRegex:/[a-z0-9]+('[a-z0-9]+)*/gi,includeTrailingSpace:!1,tokenizer:t}},B={caseSensitive:!1,withinRange:null,wholeWordsOnly:!1,wrap:!1,direction:"forward",wordOptions:null,characterOptions:null},C={wordOptions:null,characterOptions:null},D={wordOptions:null,characterOptions:null,trim:!1,trimStart:!0,trimEnd:!0},E={wordOptions:null,characterOptions:null,direction:"forward"},F=f.getComputedStyleProperty,G;(function(){var a=document.createElement("table"),b=i(document);b.appendChild(a),G=F(a,"display")=="block",b.removeChild(a)})(),a.features.tableCssDisplayBlock=G;var H={table:"table",caption:"table-caption",colgroup:"table-column-group",col:"table-column",thead:"table-header-group",tbody:"table-row-group",tfoot:"table-footer-group",tr:"table-row",td:"table-cell",th:"table-cell"};Z.prototype={get:function(a){return this.store.hasOwnProperty(a)?this.store[a]:null},set:function(a,b){return this.store[a]=b}};var $=0,_=0;a.report=function(){console.log("Cached: "+$+", uncached: "+_)};var cb={getPosition:function(a){var b=this.positions;return b.get(a)||b.set(a,new kb(this,a))},toString:function(){return"[NodeWrapper("+f.inspectNode(this.node)+")]"}};bb.prototype=cb;var db="EMPTY",eb="NON_SPACE",fb="UNCOLLAPSIBLE_SPACE",gb="COLLAPSIBLE_SPACE",hb="TRAILING_SPACE_IN_BLOCK",ib="TRAILING_SPACE_BEFORE_BR",jb="PRE_LINE_TRAILING_SPACE_BEFORE_LINE_BREAK";h(cb,{isCharacterDataNode:ab("isCharacterDataNode",f.isCharacterDataNode,"node"),getNodeIndex:ab("nodeIndex",f.getNodeIndex,"node"),getLength:ab("nodeLength",f.getNodeLength,"node"),containsPositions:ab("containsPositions",N,"node"),isWhitespace:ab("isWhitespace",V,"node"),isCollapsedWhitespace:ab("isCollapsedWhitespace",W,"node"),getComputedDisplay:ab("computedDisplay",I,"node"),isCollapsed:ab("collapsed",X,"node"),isIgnored:ab("ignored",Y,"node"),next:ab("nextPos",T,"node"),previous:ab("previous",U,"node"),getTextNodeInfo:ab("textNodeInfo",function(a){var b=null,c=!1,d=F(a.parentNode,"whiteSpace"),e=d=="pre-line";if(e)b=k,c=!0;else if(d=="normal"||d=="nowrap")b=j,c=!0;return{node:a,text:a.data,spaceRegex:b,collapseSpaces:c,preLine:e}},"node"),hasInnerText:ab("hasInnerText",function(a,b){var c=this.session,d=c.getPosition(a.parentNode,this.getNodeIndex()+1),e=c.getPosition(a,0),f=b?d:e,g=b?e:d;while(f!==g){f.prepopulateChar();if(f.isDefinitelyNonEmpty())return!0;f=b?f.previousVisible():f.nextVisible()}return!1},"node"),getTrailingSpace:ab("trailingSpace",function(a){if(a.tagName.toLowerCase()=="br")return"";switch(this.getComputedDisplay()){case"inline":var b=a.lastChild;while(b){if(!Y(b))return b.nodeType==1?this.session.getNodeWrapper(b).getTrailingSpace():"";b=b.previousSibling}break;case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":break;case"table-cell":return"	";default:return this.hasInnerText(!0)?"\n":""}return""},"node"),getLeadingSpace:ab("leadingSpace",function(a){switch(this.getComputedDisplay()){case"inline":case"inline-block":case"inline-table":case"none":case"table-column":case"table-column-group":case"table-cell":break;default:return this.hasInnerText(!1)?"\n":""}return""},"node")});var mb={character:"",characterType:db,isBr:!1,prepopulateChar:function(){var a=this;if(!a.prepopulatedChar){var b=a.node,c=a.offset,d="",e=db,f=!1;if(c>0)if(b.nodeType==3){var g=b.data,h=g.charAt(c-1),i=a.nodeWrapper.getTextNodeInfo(),j=i.spaceRegex;i.collapseSpaces?j.test(h)?c>1&&j.test(g.charAt(c-2))||(i.preLine&&g.charAt(c)==="\n"?(d=" ",e=jb):(d=" ",e=gb)):(d=h,e=eb,f=!0):(d=h,e=fb,f=!0)}else{var k=b.childNodes[c-1];k&&k.nodeType==1&&!X(k)&&(k.tagName.toLowerCase()=="br"?(d="\n",a.isBr=!0,e=gb,f=!1):a.checkForTrailingSpace=!0);if(!d){var l=b.childNodes[c];l&&l.nodeType==1&&!X(l)&&(a.checkForLeadingSpace=!0)}}a.prepopulatedChar=!0,a.character=d,a.characterType=e,a.isCharInvariant=f}},isDefinitelyNonEmpty:function(){var a=this.characterType;return a==eb||a==fb},resolveLeadingAndTrailingSpaces:function(){this.prepopulatedChar||this.prepopulateChar();if(this.checkForTrailingSpace){var a=this.session.getNodeWrapper(this.node.childNodes[this.offset-1]).getTrailingSpace();a&&(this.isTrailingSpace=!0,this.character=a,this.characterType=gb),this.checkForTrailingSpace=!1}if(this.checkForLeadingSpace){var b=this.session.getNodeWrapper(this.node.childNodes[this.offset]).getLeadingSpace();b&&(this.isLeadingSpace=!0,this.character=b,this.characterType=gb),this.checkForLeadingSpace=!1}},getPrecedingUncollapsedPosition:function(a){var b=this,c;while(b=b.previousVisible()){c=b.getCharacter(a);if(c!=="")return b}return null},getCharacter:function(a){function j(){return h||(g=i.getPrecedingUncollapsedPosition(a),h=!0),g}this.resolveLeadingAndTrailingSpaces();if(this.isCharInvariant)return this.character;var b=["character",a.includeSpaceBeforeBr,a.includeBlockContentTrailingSpace,a.includePreLineTrailingSpace].join("_"),c=this.cache.get(b);if(c!==null)return c;var d="",e=this.characterType==gb,f,g,h=!1,i=this;if(e){if(this.character!=" "||!!j()&&!g.isTrailingSpace&&g.character!="\n")if(this.character=="\n"&&this.isLeadingSpace)j()&&g.character!="\n"&&(d="\n");else{f=this.nextUncollapsed();if(f){f.isBr?this.type=ib:f.isTrailingSpace&&f.character=="\n"&&(this.type=hb);if(f.character==="\n"){if(this.type!=ib||!!a.includeSpaceBeforeBr)if(this.type!=hb||!f.isTrailingSpace||!!a.includeBlockContentTrailingSpace)if(this.type!=jb||f.type!=eb||!!a.includePreLineTrailingSpace)this.character==="\n"?f.isTrailingSpace?this.isTrailingSpace||!this.isBr:d="\n":this.character===" "&&(d=" ")}else d=this.character}}}else this.character!=="\n"||!!(f=this.nextUncollapsed())&&!f.isTrailingSpace;return this.cache.set(b,d),d},equals:function(a){return!!a&&this.node===a.node&&this.offset===a.offset},inspect:lb,toString:function(){return this.character}};kb.prototype=mb,h(mb,{next:ab("nextPos",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session;if(!c)return null;var f,g,h;return d==b.getLength()?(f=c.parentNode,g=f?b.getNodeIndex()+1:0):b.isCharacterDataNode()?(f=c,g=d+1):(h=c.childNodes[d],e.getNodeWrapper(h).containsPositions()?(f=h,g=0):(f=c,g=d+1)),f?e.getPosition(f,g):null}),previous:ab("previous",function(a){var b=a.nodeWrapper,c=a.node,d=a.offset,e=b.session,g,h,i;return d==0?(g=c.parentNode,h=g?b.getNodeIndex():0):b.isCharacterDataNode()?(g=c,h=d-1):(i=c.childNodes[d-1],e.getNodeWrapper(i).containsPositions()?(g=i,h=f.getNodeLength(i)):(g=c,h=d-1)),g?e.getPosition(g,h):null}),nextVisible:ab("nextVisible",function(a){var b=a.next();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex()+1)),e}),nextUncollapsed:ab("nextUncollapsed",function(a){var b=a;while(b=b.nextVisible()){b.resolveLeadingAndTrailingSpaces();if(b.character!=="")return b}return null}),previousVisible:ab("previousVisible",function(a){var b=a.previous();if(!b)return null;var c=b.nodeWrapper,d=b.node,e=b;return c.isCollapsed()&&(e=c.session.getPosition(d.parentNode,c.getNodeIndex())),e})});var nb=null,ob=function(){function a(a){var b=new Z;return{get:function(c){var d=b.get(c[a]);if(d)for(var e=0,f;f=d[e++];)if(f.node===c)return f;return null},set:function(c){var d=c.node[a],e=b.get(d)||b.set(d,[]);e.push(c)}}}function c(){this.initCaches()}var b=g.isHostProperty(document.documentElement,"uniqueID");return c.prototype={initCaches:function(){this.elementCache=b?function(){var a=new Z;return{get:function(b){return a.get(b.uniqueID)},set:function(b){a.set(b.node.uniqueID,b)}}}():a("tagName"),this.textNodeCache=a("data"),this.otherNodeCache=a("nodeName")},getNodeWrapper:function(a){var b;switch(a.nodeType){case 1:b=this.elementCache;break;case 3:b=this.textNodeCache;break;default:b=this.otherNodeCache}var c=b.get(a);return c||(c=new bb(a,this),b.set(c)),c},getPosition:function(a,b){return this.getNodeWrapper(a).getPosition(b)},getRangeBoundaryPosition:function(a,b){var c=b?"start":"end";return this.getPosition(a[c+"Container"],a[c+"Offset"])},detach:function(){this.elementCache=this.textNodeCache=this.otherNodeCache=null}},c}();h(f,{nextNode:T,previousNode:U});var tb=Array.prototype.indexOf?function(a,b){return a.indexOf(b)}:function(a,b){for(var c=0,d=a.length;c<d;++c)if(a[c]===b)return c;return-1};h(a.rangePrototype,{moveStart:Bb(!0,!1),moveEnd:Bb(!1,!1),move:Bb(!0,!0),trimStart:Cb(!0),trimEnd:Cb(!1),trim:Ab(function(a,b){var c=this.trimStart(b),d=this.trimEnd(b);return c||d}),expand:Ab(function(a,b,c){var f=!1;c=x(c,D);var g=z(c.characterOptions);b||(b=d);if(b==e){var h=y(c.wordOptions),i=a.getRangeBoundaryPosition(this,!0),j=a.getRangeBoundaryPosition(this,!1),k=ub(i,g,h),l=k.nextEndToken(),m=l.chars[0].previousVisible(),n,o;if(this.collapsed)n=l;else{var p=ub(j,g,h);n=p.previousStartToken()}return o=n.chars[n.chars.length-1],m.equals(i)||(this.setStart(m.node,m.offset),f=!0),o&&!o.equals(j)&&(this.setEnd(o.node,o.offset),f=!0),c.trim&&(c.trimStart&&(f=this.trimStart(g)||f),c.trimEnd&&(f=this.trimEnd(g)||f)),f}return this.moveEnd(d,1,c)}),text:Ab(function(a,b){return this.collapsed?"":xb(a,this,z(b)).join("")}),selectCharacters:Ab(function(a,b,c,d,e){var f={characterOptions:e};b||(b=i(this.getDocument())),this.selectNodeContents(b),this.collapse(!0),this.moveStart("character",c,f),this.collapse(!0),this.moveEnd("character",d-c,f)}),toCharacterRange:Ab(function(a,b,c){b||(b=i(this.getDocument()));var d=b.parentNode,e=f.getNodeIndex(b),g=f.comparePoints(this.startContainer,this.endContainer,d,e)==-1,h=this.cloneRange(),j,k;return g?(h.setStartAndEnd(this.startContainer,this.startOffset,d,e),j=-h.text(c).length):(h.setStartAndEnd(d,e,this.startContainer,this.startOffset),j=h.text(c).length),k=j+this.text(c).length,{start:j,end:k}}),findText:Ab(function(b,c,d){d=x(d,B),d.wholeWordsOnly&&(d.wordOptions=y(d.wordOptions),d.wordOptions.includeTrailingSpace=!1);var e=p(d.direction),f=d.withinRange;f||(f=a.createRange(),f.selectNodeContents(this.getDocument()));var g=c,h=!1;typeof g=="string"?d.caseSensitive||(g=g.toLowerCase()):h=!0;var i=b.getRangeBoundaryPosition(this,!e),j=f.comparePoint(i.node,i.offset);j===-1?i=b.getRangeBoundaryPosition(f,!0):j===1&&(i=b.getRangeBoundaryPosition(f,!1));var k=i,l=!1,m;for(;;){m=zb(k,g,h,f,d);if(m){if(m.valid)return this.setStartAndEnd(m.startPos.node,m.startPos.offset,m.endPos.node,m.endPos.offset),!0;k=e?m.startPos:m.endPos}else{if(!d.wrap||!!l)return!1;f=f.cloneRange(),k=b.getRangeBoundaryPosition(f,!e),f.setBoundary(i.node,i.offset,e),l=!0}}}),pasteHtml:function(a){this.deleteContents();if(a){var b=this.createContextualFragment(a),c=b.lastChild;this.insertNode(b),this.collapseAfter(c)}}}),h(a.selectionPrototype,{expand:Ab(function(a,b,c){this.changeEachRange(function(a){a.expand(b,c)})}),move:Ab(function(a,b,c,d){var e=0;if(this.focusNode){this.collapse(this.focusNode,this.focusOffset);var f=this.getRangeAt(0);d||(d={}),d.characterOptions=A(d.characterOptions),e=f.move(b,c,d),this.setSingleRange(f)}return e}),trimStart:Db("trimStart"),trimEnd:Db("trimEnd"),trim:Db("trim"),selectCharacters:Ab(function(b,c,d,e,f,g){var h=a.createRange(c);h.selectCharacters(c,d,e,g),this.setSingleRange(h,f)}),saveCharacterRanges:Ab(function(a,b,c){var d=this.getAllRanges(),e=d.length,f=[],g=e==1&&this.isBackward();for(var h=0,i=d.length;h<i;++h)f[h]={characterRange:d[h].toCharacterRange(b,c),backward:g,characterOptions:c};return f}),restoreCharacterRanges:Ab(function(b,c,d){this.removeAllRanges();for(var e=0,f=d.length,g,h,i;e<f;++e)h=d[e],i=h.characterRange,g=a.createRange(c),g.selectCharacters(c,i.start,i.end,h.characterOptions),this.addRange(g,h.backward)}),text:Ab(function(a,b){var c=[];for(var d=0,e=this.rangeCount;d<e;++d)c[d]=this.getRangeAt(d).text(b);return c.join("")})}),a.innerText=function(b,c){var d=a.createRange(b);d.selectNodeContents(b);var e=d.text(c);return d.detach(),e},a.createWordIterator=function(a,b,c){var d=qb();c=x(c,E);var e=z(c.characterOptions),f=y(c.wordOptions),g=d.getPosition(a,b),h=ub(g,e,f),i=p(c.direction);return{next:function(){return i?h.previousStartToken():h.nextEndToken()},dispose:function(){h.dispose(),this.next=function(){}}}},a.noMutation=function(a){var b=qb();a(b),rb()},a.noMutation.createEntryPointFunction=Ab,a.textRange={isBlockNode:L,isCollapsedWhitespaceNode:W,createPosition:Ab(function(a,b,c){return a.getPosition(b,c)})}})

/* ------------- 7 ------------------ */
rangy.createModule("Util",function(c,f){c.requireModules(["WrappedSelection","WrappedRange"]);var d=c.rangePrototype,e=c.selectionPrototype;d.select=function(a){c.getSelection(this.getDocument()).setSingleRange(this,a)};e.pasteText=function(a){this.deleteFromDocument();var b=this.getRangeAt(0);a=b.getDocument().createTextNode(a);b.insertNode(a);this.setSingleRange(b)};d.pasteText=function(a){this.deleteContents();a=this.getDocument().createTextNode(a);this.insertNode(a)};e.pasteHtml=function(a){this.deleteFromDocument();
var b=this.getRangeAt(0);a=this.createContextualFragment(a);var c=a.lastChild;b.insertNode(a);c&&b.setStartAfter(c);this.setSingleRange(b)};d.pasteHtml=function(a){this.deleteContents();a=this.createContextualFragment(a);this.insertNode(a)};e.selectNodeContents=function(a){var b=c.createRange(this.win);b.selectNodeContents(a);this.setSingleRange(b)};c.createRangeFromNode=function(a){var b=c.createRange(a);b.selectNode(a);return b};c.createRangeFromNodeContents=function(a){var b=c.createRange(a);b.selectNodeContents(a);
return b}});

/* ------------- 8 ------------------ */
rangy.createModule("Commands",function(p,F){function A(a){return a&&1==a.nodeType&&a.isContentEditable}function u(a,c){return!c||!c.applyToEditableOnly||(A(a)||A(a.parentNode))&&!(a&&(9==a.nodeType&&"on"==a.designMode||A(a)&&!A(a.parentNode)))}function L(a,c){var b=k.comparePoints(a,0,c.startContainer,c.startOffset),d=k.comparePoints(a,k.getNodeLength(a),c.endContainer,c.endOffset);return M(a)==M(c.startContainer)&&1==b&&-1==d}function G(a,c){if(L(a,c))return!0;var b=k.isCharacterDataNode(a);if(a==
c.startContainer&&b&&k.getNodeLength(a)!=c.startOffset||a==c.endContainer&&b&&0!=c.endOffset)return!0;var b=a.childNodes,d=b.length;if(0!=d){for(var e=0;e<d;++e)if(!G(b[e],c))return!1;return!0}return!1}function N(a){var c;return typeof(c=a.namespaceURI)==H||null===c||"http://www.w3.org/1999/xhtml"==c}function n(a){return k.isCharacterDataNode(a)||1==a.nodeType&&W.test(v(a,"display"))}function B(a){return n(a)&&"br"!=a.nodeName.toLowerCase()}function q(a,c){if(!a||1!=a.nodeType||!N(a))return!1;switch(typeof c){case "string":return a.tagName.toLowerCase()==
c.toLowerCase();case "object":return RegExp("^("+c.join(",")+")$","i").test(a.tagName);default:return!0}}function x(a,c){return q(a)?n(a)&&u(a,c)?X.test(a.tagName):!0:!1}function O(a,c){return 8==a.nodeType||3==a.nodeType&&(a.parentNode&&/^(script|style)$/i.test(a.parentNode.tagName)||c.ignoreWhiteSpace&&!/[^\r\n\t ]/.test(a.data)&&(x(a.previousSibling,c)||x(a.nextSibling,c)))?!0:!1}function I(a,c){if(!q(a))return!1;if(c&&c.command.isModifiableElement)return c.command.isModifiableElement(el,c);var b=
a.tagName.toLowerCase();if(Y.test(b))b=["style","class"];else if("a"==b)b=["style","class","href"];else if("font"==b)b=["style","class","color","face","size"];else return!1;a:{for(var d=0,e=a.attributes.length,f;d<e;++d)if(f=a.attributes[d].name,a.attributes[d].specified&&(!b||!k.arrayContains(b,f))){b=!1;break a}b=!0}return b}function y(a,c){if(!q(a))return!1;if(c&&c.command.isSimpleModifiableElement)return c.command.isSimpleModifiableElement(a,c);var b=a.tagName.toLowerCase();if(!Z.test(b))return!1;
for(var d,e=!1,f=0,g=a.attributes.length;f<g;++f)if(a.attributes[f].specified){if(e)return!1;d=a.attributes[f].name;a.getAttribute(d);e=!0}return!e||"style"==d&&0==a.style.cssText.length||"a"==b&&"href"==d||"font"==b&&/^(color|face|size)$/.test(d)?!0:"style"!=d||"number"==typeof a.style.length&&1<a.style.length||!/^[a-z\-]+:[^;]+;?\s?$/i.test(a.style.cssText)?!1:("b"==b||"strong"==b)&&""!=a.style.fontWeight||("i"==b||"em"==b)&&""!=a.style.fontStyle||("sub"==b||"sup"==b)&&""!=a.style.verticalAlign||
("span"==b||"font"==b)&&""!=a.style.fontSize||("a"==b||"font"==b||"span"==b)&&""==a.style.textDecoration||("h1"==b||"h2"==b||"h3"==b||"p"==b||"td"==b)&&""!=a.style.textAlign||/^(a|font|s|span|strike|u|del)$/.test(b)&&/^(line-through|underline|overline|none)$/.test(a.style.textDecoration)?!0:!1}function t(a,c,b,d){-1==b&&(b=c.childNodes.length);for(var e=a.parentNode,f=k.getNodeIndex(a),g=[],h=0,r=d.length;h<r;++h){var n=d[h],l=n.startContainer,q=n.startOffset,m=n.endContainer,p=n.endOffset,u=l,t=
q,s=m,w=p;l==c&&q>b&&t++;m==c&&p>b&&w++;l!=e||q!=f&&q!=f+1||(u=c,t+=b-f);m!=e||p!=f&&p!=f+1||(s=c,w+=b-f);l==e&&q>f+1&&t--;m==e&&p>f+1&&w--;u==l&&(t==q&&s==m&&w==p)&&g.push([n,u,t,s,w])}c.childNodes.length==b?c.appendChild(a):c.insertBefore(a,c.childNodes[b]);for(a=0;c=g[a++];)c[0].setStart(c[1],c[2]),c[0].setEnd(c[3],c[4])}function P(a,c){c=c||[];for(var b;b=a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),P(b,c),b.detach(!0)):c.push(b);return c}function C(a,c,b,d,e){for(var f,
g=[];f=a.firstChild;)t(f,c,b++,e),g.push(f);d&&a.parentNode.removeChild(a);return g}function Q(a,c){return C(a,a.parentNode,k.getNodeIndex(a),!0,c)}function R(a,c){for(var b=a.attributes,d=0,e=b.length;d<e;++d)b[d].specified&&("style"==b[d].name?c.style.cssText=c.style.cssText:c.setAttribute(b[d].name,b[d].value))}function S(a,c){var b=c.command,d=c.rangesToPreserve;if(null===b.getSpecifiedValue(a,c))return[];if(y(a,c))return Q(a,d);b.clearValue&&b.clearValue(a,c);null!==b.relevantCssProperty&&(a.style[b.relevantCssProperty]=
"",""==a.style.cssText&&a.removeAttribute("style"));if(null===b.getSpecifiedValue(a,c))return[];b=k.getDocument(a).createElement("span");R(a,b);a.parentNode.insertBefore(b,a);C(a,b,0,!0,d);return[b]}function l(a,c,b){return null===c||null===b?c===b:a.valuesEqual(c,b)}function m(a,c){var b=1==a.nodeType;return b||a.parentNode&&1==a.parentNode.nodeType?b?c.command.getEffectiveValue(a,c):m(a.parentNode,c):null}function T(a,c,b,d){var e=a[0],f=d.options;d=d.rangesToPreserve;var g,h;if(!a.length||!u(e,
f))return null;var r=a[a.length-1];n(r)&&(!q(r,"br")&&q(r.nextSibling,"br"))&&a.push(r.nextSibling);var l=e.previousSibling,m=r.nextSibling;b=u(l,f)&&c(l)?l:u(m,f)&&c(m)?m:b();if(!b)return null;var l=k.getDocument(b),p=b.parentNode,m=e.parentNode;if(!p)for(m.insertBefore(b,e),g=0;h=d[g++];)h.startContainer==p&&h.startOffset==k.getNodeIndex(b)&&h.setStart(h.startContainer,h.startOffset+1),h.endContainer==p&&h.endOffset==k.getNodeIndex(b)&&h.setEnd(h.endContainer,h.endOffset+1);g=b.parentNode;h=e.parentNode;
g=g&&h?-1==k.comparePoints(b.parentNode,k.getNodeIndex(b),e.parentNode,k.getNodeIndex(e)):!g;if(g)for(!n(b)&&(n(b.lastChild)&&n(e)&&!q(b.lastChild,"br"))&&b.appendChild(l.createElement("br")),g=0,e=a.length;g<e;++g)t(a[g],b,-1,d);else for(!n(b)&&(n(b.firstChild)&&n(r)&&!q(r,"br"))&&b.insertBefore(l.createElement("br"),b.firstChild),g=a.length-1;0<=g;g--)t(a[g],b,0,d);u(m,f)&&!m.hasChildNodes()&&m.parentNode.removeChild(m);a=b.nextSibling;if(u(a,f)&&c(a)){for(!n(b)&&(n(b.lastChild)&&n(a.firstChild)&&
!q(b.lastChild,"br"))&&b.appendChild(l.createElement("br"));a.hasChildNodes();)t(a.firstChild,b,-1,d);b.parentNode.removeChild(a)}if(b&&1==b.nodeType&&!n(b)){c=b.previousSibling;var s;q(c,"br")&&(n(s=b.previousSibling.previousSibling)&&!q(s,"br"))&&b.parentNode.removeChild(c)}if(b&&1==b.nodeType&&!n(b)){s=b.lastChild;var v;2<=b.childNodes.length&&(q(b.lastChild,"br")&&n(v=b.lastChild.previousSibling)&&!q(v,"br"))&&b.removeChild(s)}return b}function U(a,c,b,d,e){for(var f=a[e],g=d.rangesToPreserve;I(f,
d)&&1==f.childNodes.length&&I(f.firstChild,d)&&(!y(f,d)||!l(c,c.getSpecifiedValue(f,d),b));)f=f.firstChild;y(f,d)&&(l(c,c.getSpecifiedValue(f,d),b)&&l(c,m(f,d),b)&&f!=a[e])&&(C(f,f.parentNode,k.getNodeIndex(f),!1,g),a.parentNode.insertBefore(f,a[e]),t(f.nextSibling,f,f.childNodes.length,g))}function D(a,c,b){var d,e,f,g;d=a.nodeType;var h=b.command;e=b.rangesToPreserve;g=b.options;if(a.parentNode&&null!==c&&(/^(1|3|4|7)$/.test(""+d)&&!x(a,g)&&(U(a,h,c,b,"previousSibling"),U(a,h,c,b,"nextSibling"),
T([a],function(a){return y(a,b)&&l(h,h.getSpecifiedValue(a,b),c)&&l(h,m(a,b),c)},function(){return null},b)),!l(h,m(a,b),c)))if(x(a,g)){g=[];e=0;f=a.childNodes.length;for(r=null;e<f;++e){d=a.childNodes[e];if(1==d.nodeType&&(r=h.getSpecifiedValue(d,b),null!==r&&!l(h,c,r)))continue;g.push(d)}for(e=0;d=g[e++];)D(d,c,b)}else if(4!=d&&7!=d&&!l(h,m(a,b),c)&&(f=null,!g.styleWithCss&&h.createNonCssElement&&(f=h.createNonCssElement(a,c,b)),f||(f=h.createCssElement?h.createCssElement(k.getDocument(a),b):k.getDocument(a).createElement("span")),
a.parentNode.insertBefore(f,a),g=h.relevantCssProperty,null===g||l(h,m(f,b),c)||(f.style[g]=c),h.styleCssElement&&h.styleCssElement(f,c),t(a,f,f.childNodes.length,e),1==d&&!l(h,m(a,b),c)))if(t(a,f.parentNode,k.getNodeIndex(f),e),f.parentNode.removeChild(f),"span"==f.tagName.toLowerCase()&&(h.hasSpecialSpanStyling&&h.hasSpecialSpanStyling(c)||null!==g))null!==g&&(a.style[g]=c),h.styleSpanChildElement&&h.styleSpanChildElement(a,c);else{g=[];var r;e=0;for(f=a.childNodes.length;e<f;++e){d=a.childNodes[e];
if(1==d.nodeType&&(r=h.getSpecifiedValue(d,b),null!==r&&!l(h,c,r)))continue;g.push(d)}e=0;for(f=g.length;e<f;++e)D(g[e],c,b)}}function V(a,c){for(var b=z(a.childNodes),d=0,e=b.length;d<e;++d)E(b[d],c)}function E(a,c){var b,d;b=a.nodeType;if(9==b)for(b=0;b<a.childNodes.length;++b){if(d=a.childNodes[b],1==d.nodeType){E(d,c);break}}else if(11==b)V(a,c);else if(a.parentNode&&10!=b&&!O(a,c.options)){if(u(a,c.options)){if(1==b){var e=S(a,c);b=0;for(d=e.length;b<d;++b)E(e[b],c);if(!a.parentNode)return}b=
c.command;var f=c.value,e=c.options;if((d=a.parentNode)&&1==d.nodeType&&!l(b,m(a,c),f)){var g=d;for(d=[];u(g,e)&&1==g.nodeType&&!l(b,m(g,c),f);)d.push(g),g=g.parentNode;if(0!=d.length){var e=d[d.length-1],h=b.getSpecifiedValue(e,c);if(null!==h||h==f)if(null===f||l(b,m(e.parentNode,c),f))for(;d.length;){g=d.pop();null!==b.getSpecifiedValue(g,c)&&(h=b.getSpecifiedValue(g,c));f=z(g.childNodes);null!==b.getSpecifiedValue(g,c)&&S(g,c);for(var g=0,k;k=f[g++];)k!=a&&(1!=k.nodeType||null===b.getSpecifiedValue(k,
c)||l(b,h,b.getSpecifiedValue(k,c)))&&k!=e&&D(k,h,c)}}}D(a,c.value,c)}V(a,c)}}function s(){}function J(a){var c=a.toLowerCase();if(K.hasOwnProperty(c))return K[c];throw F.createError("getCommand(): No command registered with the name '"+a+"'");}p.requireModules(["WrappedSelection","WrappedRange"]);var k=p.dom,H="undefined",M=k.getRootContainer,v;typeof window.getComputedStyle!=H?v=function(a,c){return k.getWindow(a).getComputedStyle(a,null)[c]}:typeof document.documentElement.currentStyle!=H?v=function(a,
c){return a.currentStyle[c]}:F.fail("No means of obtaining computed style properties found");var z;(function(){var a=document.createElement("div");a.appendChild(document.createElement("span"));var c=Array.prototype.slice;try{1==c.call(a.childNodes,0)[0].nodeType&&(z=function(a){return c.call(a,0)})}catch(b){}z||(z=function(a){for(var b=0,c=a.length,g=[];b<c;++b)g[b]=a[b];return g})})();var X=/^(h[1-6]|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address)$/i,
W=/^inline(-block|-table)?$/i,Y=/^(b|em|i|s|span|strike|strong|sub|sup|u|del)$/,Z=RegExp("^(b|em|i|s|span|strike|strong|sub|sup|u|del|a|font|h1|h2|h3|h4|h5|h6|p|hr|pre|blockquote|ol|ul|li|dl|dt|dd|div|table|caption|colgroup|col|tbody|thead|tfoot|tr|th|td|address)$");s.prototype={relevantCssProperty:null,getSpecifiedValue:function(){return null},clearValue:function(){},getEffectiveValue:function(a,c){return v(a,this.relevantCssProperty)},createCssElement:null,createNonCssElement:null,styleCssElement:null,
hasSpecialSpanStyling:null,styleSpanChildElement:null,isSimpleModifiableElement:null,defaultOptions:null,addDefaultOptions:null,valuesEqual:function(a,c){return a===c},createContext:function(a,c,b){var d=this.defaultOptions;if(d)for(var e in d)d.hasOwnProperty(e)&&!b.hasOwnProperty(e)&&(b[e]=d[e]);return{command:this,value:a,rangesToPreserve:c||[],options:b||{}}},getSelectionValue:function(){return null},getNewRangeValue:function(){return null},getNewSelectionValue:function(){return null},applyToRange:function(a,
c,b,d){a=this.createContext(c,[d],b);a.value=this.getNewRangeValue(d,a);this.applyValueToRange(d,a)},applyToSelection:function(a,c,b){a=k.getWindow(a);a=p.getSelection(a);var d=a.getAllRanges();c=this.createContext(c,d,b);c.value=this.getNewSelectionValue(a,c);b=0;for(var e=d.length;b<e;++b)this.applyValueToRange(d[b],c);a.setRanges(d)}};s.util={getComputedStyleProperty:v,getFurthestAncestor:function(a){for(;null!=a.parentNode;)a=a.parentNode;return a},isContained:L,isEffectivelyContained:G,isHtmlNode:N,
isHtmlElement:q,isInlineNode:n,isUnwrappable:x,blockExtend:function(a){for(var c=a.startContainer,b=a.startOffset,d=a.endContainer,e=a.endOffset,f,g;;)if(k.isCharacterDataNode(c)||0==b)b=k.getNodeIndex(c),c=c.parentNode;else if(b==k.getNodeLength(c))b=1+k.getNodeIndex(c),c=c.parentNode;else if((f=c.childNodes[b])&&B(f)&&B(f.previousSibling))b--;else break;for(;;)if(0==e)e=k.getNodeIndex(d),d=d.parentNode;else if(k.isCharacterDataNode(d)||e==k.getNodeLength(d))e=1+k.getNodeIndex(d),d=d.parentNode;
else if((g=d.childNodes[e])&&B(g)&&B(g.previousSibling))e++;else break;a=a.cloneRange();a.setStart(c,b);a.setEnd(d,e);return a},isModifiableElement:I,isSimpleModifiableElement:y,moveChildrenPreservingRanges:C,replaceWithOwnChildren:Q,copyAttributes:R,getEffectiveValue:m,getEffectiveTextNodes:function(a,c){return a.getNodes([3],function(b){return G(b,a)&&!O(b,c.options)})},setNodeValue:E,wrap:T,decomposeRange:function(a,c){if(a.startContainer==a.endContainer&&a.startOffset==a.endOffset)return[];a.splitBoundaries(c);
for(var b=a.cloneRange();0==b.startOffset&&b.startContainer.parentNode;)b.setStart(b.startContainer.parentNode,k.getNodeIndex(b.startContainer));for(;b.endOffset==k.getNodeLength(b.endContainer)&&b.endContainer.parentNode;)b.setEnd(b.endContainer.parentNode,1+k.getNodeIndex(b.endContainer));var b=new rangy.DomRange.RangeIterator(b,!1),d=P(b);b.detach();return d},setGlobalOption:function(a,c){}};s.create=function(a,c){var b=new s;a.prototype=b;if("object"==typeof c)for(var d in c)c.hasOwnProperty(d)&&
(b[d]=c[d])};var K={};p.registerCommand=function(a,c){if(!(c instanceof s))throw F.createError("registerCommand(): Object supplied is not a Command");K[a.toLowerCase()]=c};p.execCommand=function(a,c,b){c=c||{};var d=c.hasOwnProperty("document")?c.document:document,e=c.hasOwnProperty("value")?c.value:null;a=J(a);b?a.applyToRange(d,e,c,b):a.applyToSelection(d,e,c)};p.queryCommandValue=function(a,c,b){c=c||{};var d=c.hasOwnProperty("document")?k.getWindow(c.document):window;b=c.hasOwnProperty("value")?
c.value:null;a=J(a);d=p.getSelection(d);c=a.createContext(b,null,c);return a.getSelectionValue(d,c)};p.getCommand=J;p.Command=s});

/* ------------- 9 ------------------ */
rangy.createModule("BoldCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"fontWeight",defaultOptions:{tagName:"b",ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.fontWeight||(/^(strong|b)$/i.test(b.tagName)?"bold":null)},valuesEqual:function(b,a){b=(""+b).toLowerCase();a=(""+a).toLowerCase();return b==a||"bold"==b&&"700"==a||"bold"==a&&"700"==b||"normal"==b&&"400"==a||"normal"==a&&"400"==b},createNonCssElement:function(b,
a,d){return"bold"==a||"700"==a?k.getDocument(b).createElement(d.options.tagName):null},isBoldCssValue:function(b){return/^(bold|700|800|900)$/.test(b)},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==d.length)return this.isBoldCssValue(g.getEffectiveValue(b.commonAncestorContainer,a));for(;c--;)if(e=g.getEffectiveValue(d[c],a),!this.isBoldCssValue(e))return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],
a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"normal":"bold"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"normal":"bold"},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("bold",new h)});
rangy.createModule("ItalicCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"fontStyle",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.fontStyle||(/^(em|i)$/i.test(b.tagName)?"italic":null)},createNonCssElement:function(b,a){return"italic"==a?k.getDocument(b).createElement("i"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==d.length)return"italic"==
g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),"italic"!=e)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"normal":"italic"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"normal":"italic"},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),
c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("italic",new h)});
rangy.createModule("UnderlineCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.textDecoration||(/^(u)$/i.test(b.tagName)?"underline":null)},createNonCssElement:function(b,a){return"underline"==a?k.getDocument(b).createElement("u"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==
d.length)return"underline"==g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),"underline"!=e)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"none":"underline"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"none":"underline"},applyValueToRange:function(b,a){for(var d=
g.decomposeRange(b,a.rangesToPreserve),c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("underline",new h)});
rangy.createModule("StrikeThroughCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"textDecoration",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.textDecoration||(/^(strike|del)$/i.test(b.tagName)?"line-through":null)},createNonCssElement:function(b,a){return"line-through"==a?k.getDocument(b).createElement("strike"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,
a),c=d.length,e;if(0==d.length)return"line-through"==g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),"line-through"!=e)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"none":"line-through"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"none":"line-through"},applyValueToRange:function(b,
a){for(var d=g.decomposeRange(b,a.rangesToPreserve),c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("strikeThrough",new h)});
rangy.createModule("SuperScriptCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.verticalAlign||(/^(sup|sub)$/i.test(b.tagName)?"super":null)},createNonCssElement:function(b,a){return"super"==a?k.getDocument(b).createElement("sup"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==
d.length)return"super"==g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),"super"!=e)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"baseline":"super"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"baseline":"super"},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,
a.rangesToPreserve),c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("superscript",new h)});
rangy.createModule("SubScriptCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"verticalAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.verticalAlign||(/^(sub|sup)$/i.test(b.tagName)?"sub":null)},createNonCssElement:function(b,a){return"sub"==a?k.getDocument(b).createElement("sub"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==d.length)return"sub"==
g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),"sub"!=e)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"baseline":"sub"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"baseline":"sub"},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),
c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("subscript",new h)});
rangy.createModule("JustifyLeftCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.textAlign||(/^(p)$/i.test(b.tagName)?"left":null)},createNonCssElement:function(b,a){return"left"==a?k.getDocument(b).createElement("p"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==d.length)return"left"==
g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),"left"!=e)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":"left"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":"left"},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),c=0,e=d.length;c<
e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("justifyLeft",new h)});
rangy.createModule("JustifyCenterCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"textAlign",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.textAlign||(/^(p)$/i.test(b.tagName)?"center":null)},createNonCssElement:function(b,a){return"center"==a?k.getDocument(b).createElement("p"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==d.length)return"center"==
g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),"center"!=e)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":"center"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":"center"},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),c=0,e=
d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("justifyCenter",new h)});
rangy.createModule("FontsizeCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"fontSize",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.fontSize||(/^(font)$/i.test(b.tagName)?"fontSize":null)},createNonCssElement:function(b,a){return"fontsize"!=a?k.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==d.length)return"fontsize"==
g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),e!=a.options.fontsize)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return a.options.fontsize},getNewSelectionValue:function(b,a){return a.options.fontsize},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],
a)}});f.registerCommand("fontsize",new h)});
rangy.createModule("FontfamilyCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"fontFamily",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.fontFamily||(/^(font)$/i.test(b.tagName)?"fontFamily":null)},createNonCssElement:function(b,a){return"fontFamily"!=a?k.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==
d.length)return"fontFamily"==g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),e!=a.options.fontfamily)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return a.options.fontfamily},getNewSelectionValue:function(b,a){return a.options.fontfamily},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),
c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("fontfamily",new h)});
rangy.createModule("FontcolorCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"color",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.color||(/^(font)$/i.test(b.tagName)?"color":null)},createNonCssElement:function(b,a){return"color"!=a?k.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==d.length)return"color"==
g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),e!=a.options.fontfamily)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":a.options.fontcolor},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":a.options.fontcolor},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,
a.rangesToPreserve),c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("fontcolor",new h)});
rangy.createModule("FontBgcolorCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"backgroundColor",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.backgroundColor||(/^(font)$/i.test(b.tagName)?"backgroundColor":null)},createNonCssElement:function(b,a){return"backgroundColor"!=a?k.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,
a),c=d.length,e;if(0==d.length)return"backgroundColor"==g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),e!=a.options.fontfamily)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":a.options.fontcolor},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":a.options.fontcolor},
applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("fontbgcolor",new h)});
rangy.createModule("LineHeightCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{relevantCssProperty:"lineHeight",defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return b.style.lineHeight?"lineHeight":null},createNonCssElement:function(b,a){return"lineHeight"!=a?k.getDocument(b).createElement("span"):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==d.length)return"lineHeight"==
g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),e!=a.options.lineheight)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return a.options.lineheight},getNewSelectionValue:function(b,a){return a.options.lineheight},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],
a)}});f.registerCommand("lineheight",new h)});
rangy.createModule("FormattingCommand",function(f,l){function h(){}f.requireModules(["Commands"]);var k=f.dom,g=f.Command.util;f.Command.create(h,{defaultOptions:{ignoreWhiteSpace:!0},getSpecifiedValue:function(b){return/^(h1|h2|h3|h4|h5)$/i.test(b.tagName)?"formatting":null},createNonCssElement:function(b,a,d){return"formatting"==a?k.getDocument(b).createElement(d.options.tagName):null},getRangeValue:function(b,a){var d=g.getEffectiveTextNodes(b,a),c=d.length,e;if(0==d.length)return"formatting"==
g.getEffectiveValue(b.commonAncestorContainer,a);for(;c--;)if(e=g.getEffectiveValue(d[c],a),"formatting"!=e)return!1;return!0},getSelectionValue:function(b,a){for(var d=b.getAllRanges(),c=0,e=d.length;c<e;++c)if(!this.getRangeValue(d[c],a))return!1;return 0<e},getNewRangeValue:function(b,a){return this.getRangeValue(b,a)?"":"formatting"},getNewSelectionValue:function(b,a){return this.getSelectionValue(b,a)?"":"formatting"},applyValueToRange:function(b,a){for(var d=g.decomposeRange(b,a.rangesToPreserve),
c=0,e=d.length;c<e;++c)g.setNodeValue(d[c],a)}});f.registerCommand("formatting",new h)});

/* ------------- 10 ------------------ */
var _iframeDoc,_iframeWin,isOperaU=top.DEXT5.browser.opera,isFirefoxU=top.DEXT5.browser.gecko,isSafariU=top.DEXT5.browser.safari,isChromeU=top.DEXT5.browser.chrome,isIEU=top.DEXT5.browser.ie,R=[],T=[];function testCSS(a){return a in document.documentElement.style}
function saveSelection(a){if(!1!=isIEU){a=document.getElementById("dext5_design_"+a);dext_src_init(a);a=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection;var c;try{a&&(a.createRange?c=a.createRange():a.getRangeAt?c=a.getRangeAt(0):a.anchorNode&&(a.focusNode&&doc.createRange)&&(c=_iframeDoc.createRange(),c.setStart(a.anchorNode,a.anchorOffset),c.setEnd(a.focusNode,a.focusOffset),c.collapsed!==a.isCollapsed&&(c.setStart(a.focusNode,a.focusOffset),c.setEnd(a.anchorNode,a.anchorOffset))))}catch(b){}return c}}
R[0]="h";T[0]="Li";function restoreSelection(a){if(!1!=isIEU)try{_iframeDoc.body.focus();var c=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,b=getEditrFromEvent(null);if(null==a||void 0==a)a=getEditrFromEvent(null)._LastRange;c&&a&&(a.select?a.select():c.removeAllRanges&&c.addRange&&(c.removeAllRanges(),c.addRange(a)),b._LastRange=null)}catch(d){}}R[1]="t";T[1]="c";
function createBookmark(){var a=document.getElementById("dext5_design_"+G_USE_EDITOR_ID);dext_src_init(a);var a=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection,c;try{a&&(a.createRange?c=a.createRange():a.getRangeAt?c=a.getRangeAt(0):a.anchorNode&&(a.focusNode&&doc.createRange)&&(c=_iframeDoc.createRange(),c.setStart(a.anchorNode,a.anchorOffset),c.setEnd(a.focusNode,a.focusOffset),c.collapsed!==a.isCollapsed&&(c.setStart(a.focusNode,a.focusOffset),c.setEnd(a.anchorNode,a.anchorOffset))))}catch(b){}return c}
T[2]="e";function goToBookmark(a){if(!1!=isIEU)try{_iframeDoc.body.focus();var c=_iframeWin.getSelection?_iframeWin.getSelection():_iframeDoc.selection;c&&a&&(a.select?a.select():c.removeAllRanges&&c.addRange&&(c.removeAllRanges(),c.addRange(a)))}catch(b){}}T[3]="n";function CleanZeroChar(a){return a=a.replace(unescape("%uFEFF"),"")}T[4]="se";
function dext_src_init_once(a){rangy.init();_iframeWin=rangy.dom.getIframeWindow(a);_iframeDoc=rangy.dom.getIframeDocument(a);createResizeBar(_iframeDoc);top.DEXT5.util.addEvent(_iframeDoc,"mousedown",_iframeDoc_MouseDown);top.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUp);top.DEXT5.util.addEvent(_iframeDoc,"mouseup",_iframeDoc_MouseUpMenu);top.DEXT5.util.addEvent(_iframeDoc,"mousemove",_iframeDoc_MouseMove);top.DEXT5.util.addEvent(_iframeDoc,"contextmenu",_iframeDoc_ContextMenu);top.DEXT5.util.addEvent(_iframeDoc,
"dblclick",_iframeDoc_DBClick);top.DEXT5.util.addEvent(_iframeDoc.body,"click",_iframeBody_Click);top.DEXT5.util.addEvent(_iframeDoc,"click",_iframeBody_Click);top.DEXT5.util.addEvent(_iframeDoc,"keyup",_iframeDoc_Keyup);top.DEXT5.util.addEvent(_iframeDoc,"keydown",_iframeDoc_Keydown);top.DEXT5.util.addEvent(_iframeDoc.body,"select",_iframeBody_Select);isIEU?(top.DEXT5.util.addEvent(_iframeDoc.body,"beforedeactivate",_iframeDoc_BlurHandler),top.DEXT5.util.addEvent(_iframeDoc.body,"focus",_iframeDoc_FocusHandler)):
(top.DEXT5.util.addEvent(_iframeDoc,"blur",_iframeDoc_BlurHandler),top.DEXT5.util.addEvent(_iframeDoc,"focus",_iframeDoc_FocusHandler));try{_iframeDoc.execCommand("MultipleSelection",null,!0)}catch(c){}setTimeout(setBodyDefalutValue,0);setTimeout(setFocusToBody,0);doSetCaretPosition(_iframeDoc.body,0)}R[2]="t";T[5]="k";var bCtrlKey=!1,startBookmark,endBookmark;
function _iframeDoc_Keydown(a){var c="which"in a?a.which:a.keyCode;checkDefaultMessage(a)||(startBookmark=endBookmark=void 0,bCtrlKey=a.ctrlKey,!1==a.ctrlKey&&(33<=c&&126>=c&&0==top.G_CURREDITOR.UndoManager.arrImageHTML.length)&&top.G_CURREDITOR.UndoManager.putUndo(),!1==a.ctrlKey&&(33<=c&&126>=c&&top.G_CURREDITOR.UndoManager.canRedo)&&(top.G_CURREDITOR.UndoManager.canRedo=!1,top.G_CURREDITOR._iconEnable("")),a.ctrlKey||bCtrlKey?86==c?(top.G_CURREDITOR.UndoManager.putUndo(),top.G_CURREDITOR._iconEnable(""),
G_dext5plugIn?(top.DEXT5.util.cancelEvent(a),a=G_dext5plugIn.getPasteHtml(),0<a.length&&(a=top.DEXT5.util.officeClean(a,!0),c=getFirstRange().range,c.deleteContents(),c.collapse(!0),c.pasteHtml(a),c.collapse(!1),top.G_CURREDITOR._dextCustomDataMode=!0,ReplaceRealObjectToImage(!1))):startBookmark=createBookmark()):89==c?top.G_CURREDITOR.UndoManager.canRedo&&(top.G_CURREDITOR.UndoManager.execRedo(),top.G_CURREDITOR._iconEnable(""),top.DEXT5.util.cancelEvent(a)):90==c?top.G_CURREDITOR.UndoManager.canUndo&&
(top.G_CURREDITOR.UndoManager.execUndo(),top.G_CURREDITOR._iconEnable(""),top.DEXT5.util.cancelEvent(a)):83==c&&(command_saveAs("",top.G_CURREDITOR),top.DEXT5.util.cancelEvent(a)):46!=c&&13==c&&(top.G_CURREDITOR.UndoManager.putUndo(),top.G_CURREDITOR._iconEnable("")),setTimeout(function(){bCtrlKey=!1},300))}R[3]="p";R[4]=":";T[6]="e";function getEnterTagString(a){var c="",c=isIEU?"&nbsp;":"<br />",b="";"br"==a?b="<br />":"p"==a?b="<p>"+c+"</p>":"div"==enterTag&&(b="<div>"+c+"</div>");return b}
T[7]="y";R[5]="/";function _iframeDoc_Keyup(a){var c="which"in a?a.which:a.keyCode;if(a.ctrlKey||bCtrlKey)86==c&&(G_dext5plugIn?top.DEXT5.util.cancelEvent(a):(endBookmark=createBookmark(),setTimeout(replacePasteHTML,0)));else if(46==c){_iframeDoc_MouseUpMenu(a);top.G_CURREDITOR._iconEnable("");try{var b=getFirstRange().range;b&&setMenuIconRealable(getMyElementNode(b.startContainer))}catch(d){}top.G_SELECTED_ELEMENT=null}}T[8]=" i";
function insertNodeAtCaret(a){var c=top.G_CURREDITOR._DOC.createElement("span");c.id=a;c.innerHTML="&nbsp;";if(a=getFirstRange().range)a.collapse(!1),a.insertNode(c)}T[9]="s ";
function replacePasteHTML(){if(void 0!=startBookmark&&void 0!=endBookmark){goToBookmark(startBookmark);var a=getFirstRange();goToBookmark(endBookmark);var c=getFirstRange();a.range.setEnd(c.range.startContainer,c.range.startOffset);c=a.range.toHtml();""==c&&(c=a.range.startContainer.innerHTML,void 0==c&&(c=a.range.startContainer.textContent));c=top.DEXT5.util.officeClean(c,!1);if(""!=c)try{a.range.deleteContents(),a.range.collapse(!0),a.range.pasteHtml(c),a.range.collapse(!1)}catch(b){}}}T[10]="i";
function dext_src_init(a){_iframeWin=rangy.dom.getIframeWindow(a);_iframeDoc=rangy.dom.getIframeDocument(a)}T[11]="n";
function setBodyDefalutValue(){for(var a=0;a<_iframeDoc.body.childNodes.length;a++){var c=_iframeDoc.body.childNodes[a];if(c&&(1==c.nodeType&&0==c.innerHTML.length)&&!1==isIEU){var b=_iframeDoc.createElement("br");c.appendChild(b)}}a=null;if(0==_iframeDoc.body.childNodes.length||1==_iframeDoc.body.childNodes.length&&3==_iframeDoc.body.childNodes[0].nodeType)a=_iframeDoc.createElement("p"),1==_iframeDoc.body.childNodes.length&&3==_iframeDoc.body.childNodes[0].nodeType?(a.innerHTML=_iframeDoc.body.childNodes[0].nodeValue,
_iframeDoc.body.removeChild(_iframeDoc.body.childNodes[0])):isIEU&&(a.innerHTML=unescape("&nbsp;")),_iframeDoc.body.appendChild(a),!1==isIEU&&(b=_iframeDoc.createElement("br"),a.appendChild(b));a?doSetCaretPosition(a,0):doSetCaretPosition(_iframeDoc.body.childNodes[0],0);setMenuIconRealable(a)}T[12]="c";function setFocusToBody(){try{isIEU?(_iframeWin.focus(),_iframeDoc.focus()):_iframeWin.focus(),_iframeDoc.body.focus()}catch(a){}}R[6]="/";T[13]="o";T[14]="r";
function _iframeDoc_ContextMenu(a){var c=a?a:_iframeWind.event;currElem=c.target?c.target:c.srcElement;null==GetParentbyTagName(currElem,"table")&&(ClearDraggingTableCellSelected(),ActiveCurrTable=null);IsMousePointOnBorder(a)||setContextMenu(a);top.DEXT5.util.cancelEvent(a)}T[15]="r";function _iframeDoc_BlurHandler(a){a=getEditrFromEvent(a);a._LastRange||a._RangeBlurBug||(a._LastRange=saveSelection(a.ID))}T[16]="e";
function _iframeDoc_FocusHandler(a){if(a.target?a.target:a.srcElement)a=getEditrFromEvent(a),setCurrentEditor(a),a._LastRange&&restoreSelection(a._LastRange)}R[7]="w";T[17]="c";function setCurrentEditor(a){var c=a._EDITOR.design;a._DOC=c.contentDocument?c.contentDocument:c.contentWindow.document;a._BODY=a._DOC.body;top.G_CURREDITOR=a;G_USE_EDITOR_ID=a.ID;LayerFrame=top.DEXTDOC.getElementById("dext_frame_"+top.G_CURREDITOR.ID);dext_src_init(c)}T[18]="t";
function InsertFontElement(a,c){var b=getFirstRange().range;if(b){b.collapse(!1);var d=_iframeDoc.createElement("span");!1==isFirefoxU&&(d.innerHTML=unescape("%uFEFF"));d.style[a]=c;b.insertNode(d);b.selectNodeContents(d);b.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b)}}T[19]=". P";T[20]="l";function execCommand(a,c){c.document=_iframeDoc;rangy.execCommand(a,c)}
function getFirstRange(){retValue={};var a=rangy.getSelection(_iframeWin);retValue.sel=a;if(0==a.rangeCount){var c=rangy.createRange(_iframeDoc),a=rangy.getSelection(_iframeWin);a.setSingleRange(c);retValue.sel=a;retValue.range=c}else retValue.range=a.getRangeAt(0);return retValue}R[8]="w";T[21]=T[2]+"a";function setRestoreCaretPos(a){var c=getFirstRange().range;c&&(!1==a&&c.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(c))}R[9]="w";
function DoExecuteCommand(a,c,b,d){try{if(0==c.toString().length){var e=GetTableSelectionCells();if(0==e.length)if("formatting"==b){var g=d.tagName;isIEU&&(g="<"+g+">");_iframeDoc.execCommand("formatBlock",!1,g)}else _iframeDoc.execCommand(b,!1,null),setMenuIconRealable(getMyElementNode(c.startContainer));else for(g=0;g<e.length;g++)a.removeAllRanges(),c.selectNode(e[g]),a.addRange(c),rangy.queryCommandValue(b,d),execCommand(b,d),rangy.getSelection(_iframeWin).removeAllRanges()}else rangy.queryCommandValue(b,
d),execCommand(b,d)}catch(f){}}T[22]=T[4];function DoExecuteCommand2(a,c,b){try{if(0==c.toString().length){var d=GetTableSelectionCells();if(0==d.length)_iframeDoc.execCommand(b,!1,null),setMenuIconRealable(getMyElementNode(c.startContainer));else for(var e=0;e<d.length;e++)a.removeAllRanges(),c.selectNode(d[e]),a.addRange(c),_iframeDoc.execCommand(b,!1,null),rangy.getSelection(_iframeWin).removeAllRanges()}else _iframeDoc.execCommand(b,!1,null)}catch(g){}}R[10]=".";
function DoExecuteCommand3(a,c,b,d,e){try{if(0==c.toString().length){var g=GetTableSelectionCells();if(0==g.length)"fontcolor"==b&&(b="color"),"fontbgcolor"==b&&(b="backgroundColor"),"lineheight"==b&&(b="lineHeight"),InsertFontElement(b,e);else for(e=0;e<g.length;e++)a.removeAllRanges(),c.selectNode(g[e]),a.addRange(c),rangy.queryCommandValue(b,d),execCommand(b,d),rangy.getSelection(_iframeWin).removeAllRanges()}else rangy.queryCommandValue(b,d),execCommand(b,d)}catch(f){}}T[23]=",";
function deleteSelectionArea(){try{_iframeDoc.execCommand("delete",!1,null)}catch(a){}}R[11]="d";function command_bold(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"strong"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"bold",b);top.G_CURREDITOR.UndoManager.putUndo()}T[24]=" c";
function command_italic(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"i"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"italic",b);top.G_CURREDITOR.UndoManager.putUndo()}R[12]="e";
function command_formatting(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!1,tagName:b.toLowerCase()};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand(c.sel,c.range,"formatting",a);top.G_CURREDITOR.UndoManager.putUndo()}T[25]=T[13];
function command_underline(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"u"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"underline",b);top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+=R[11];
function command_strikeThrough(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"strike"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"strikeThrough",b);top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="g";T[26]="n";
function command_superscript(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"sup"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"superscript",b);top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="f";
function command_subscript(a,c){dext_src_init(c._EDITOR.design);var b={document:_iframeDoc,styleWithCss:!1,tagName:"sub"};restoreSelection();setFocusToBody();var d=getFirstRange();DoExecuteCommand(d.sel,d.range,"subscript",b);top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="e";function command_selectAll(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();_iframeDoc.execCommand("selectAll",!1,null)}_R_O_+="a";
function command_justifyLeft(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"justifyLeft");top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="b";T[27]=T[18];function command_justifyCenter(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"justifyCenter");top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="H";
function command_justifyRight(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"justifyRight");top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="M";function command_justifyFull(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"justifyFull");top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="N";
function command_indent(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"indent");top.G_CURREDITOR.UndoManager.putUndo()}R[13]="x";_R_O_+="O";function command_outdent(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"outdent");top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="P";
function command_insertOrderedList(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"insertOrderedList");top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="Q";T[28]="a";function command_insertUnOrderedList(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"insertUnOrderedList");top.G_CURREDITOR.UndoManager.putUndo()}R[14]="t";_R_O_+="I";
function command_removeFormat(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();var b=getFirstRange();DoExecuteCommand2(b.sel,b.range,"removeFormat");top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="J";T[29]="c";function command_copy(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();isIEU?_iframeDoc.execCommand("copy",!1,null):alert(dext5_lang.msg.copy)}_R_O_+="K";
function command_cut(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();isIEU?_iframeDoc.execCommand("cut",!1,null):alert(dext5_lang.msg.cut);top.G_CURREDITOR.UndoManager.putUndo()}R[15]="5";_R_O_+="L";
function command_pastehtml(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(isIEU)if(G_dext5plugIn){var b=G_dext5plugIn.getPasteHtml();if(0<b.length){var b=top.DEXT5.util.officeClean(b,!0),d=getFirstRange().range;d.deleteContents();d.collapse(!0);d.pasteHtml(b);d.collapse(!1)}}else _iframeDoc.execCommand("paste",!1,null);else alert(dext5_lang.msg.paste);top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="R";T[30]="t ";
function command_print(a,c){dext_src_init(c._EDITOR.design);var b=navigator.userAgent.toLowerCase(),d=window.opera,b=-1<b.indexOf(" applewebkit/"),d=!!d&&d.version;"Gecko"!=navigator.product||b||d?_iframeDoc.execCommand("print",!1,null):c._EDITOR.design.contentWindow.print()}_R_O_+="S";
function command_saveAs(a,c){dext_src_init(c._EDITOR.design);var b=top.DEXT5.getHtmlValueExWithDocType();if(top.DEXT5.browser.ie){var d;d=c._EDITOR.preview.contentDocument?c._EDITOR.preview.contentDocument:c._EDITOR.preview.contentWindow.document;d.open();d.write(b);d.close();d.execCommand("saveAs",!1,"Untitle.html")}else{d=top.document.createElement("form");d.id="saveFrm";d.name="saveFrm";d.method="post";var e=top.document.createElement("input");e.id="html";e.name="html";e.type="hidden";e.value=
b;var g=top.document.createElement("input");g.id="url";g.name="url";g.type="hidden";""==c._config.proxy_url?(d.action=c._config.post_url+"?saveas=1",b=c._config.post_url.indexOf("handler/"),g.value=c._config.post_url.substring(0,b)):(d.action=c._config.proxy_url+"?saveas=1",b=c._config.proxy_url.indexOf("handler/"),g.value=c._config.proxy_url.substring(0,b));d.appendChild(e);d.appendChild(g);top.document.body.appendChild(d);d.submit();top.document.body.removeChild(d)}}_R_O_+="T";
function command_undo(a,c){dext_src_init(c._EDITOR.design);c.UndoManager.execUndo();top.G_CURREDITOR._iconEnable("")}function command_redo(a,c){dext_src_init(c._EDITOR.design);c.UndoManager.execRedo();top.G_CURREDITOR._iconEnable("")}_R_O_+="x";R[16]=".";T[31]="u";
function command_fontsize(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontsize:b};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontSize",a,b);top.G_CURREDITOR.UndoManager.putUndo()}_R_O_+="y";T[32]="s.";
function command_fontfamily(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontfamily:b};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontFamily",a,b);top.G_CURREDITOR.UndoManager.putUndo()}var K__="z";function command_docBGColor(a,c,b){dext_src_init(c);_iframeDoc.body.style.background=b}K__+="u";
function command_fontColor(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:b};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontcolor",a,b);top.G_CURREDITOR.UndoManager.putUndo()}K__+="v";
function command_fontBgColor(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!1,tagName:"span",fontcolor:b};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"fontbgcolor",a,b);top.G_CURREDITOR.UndoManager.putUndo()}K__+="w";
function command_lineHeight(a,c,b){dext_src_init(c);a={document:_iframeDoc,styleWithCss:!0,lineheight:b};restoreSelection();setFocusToBody();c=getFirstRange();DoExecuteCommand3(c.sel,c.range,"lineheight",a,b);top.G_CURREDITOR.UndoManager.putUndo()}K__+="C";R[17]="c";
function command_InsertTablebyRowCol(a,c,b,d){dext_src_init(c);restoreSelection();setFocusToBody();a=getFirstRange().range;try{0==a.toString().length&&setRestoreCaretPos(!1)}catch(e){}c="<p>&nbsp;</p>";c=isIEU?"&nbsp;":"<p><br></p>";a=_iframeDoc.createElement("table");var g=Math.round(top.G_CURREDITOR._defTableWidth/d);a.style.width=top.G_CURREDITOR._defTableWidth+"px";a.style.height=20*b+"px";a.style.borderCollapse="collapse";a.style.fontFamily=top.G_CURREDITOR._setting.font_family;a.style.fontSize=
top.G_CURREDITOR._setting.font_size;a.setAttribute("border","1");a.style.borderColor="#000000";a.style.border="1px none #000000";a.setAttribute("cellSpacing","0");a.setAttribute("cellPadding","0");for(var f=_iframeDoc.createElement("tbody"),h=0;h<b;h++){for(var k=_iframeDoc.createElement("tr"),u=0;u<d;u++){var t=_iframeDoc.createElement("td");t.innerHTML=c;t.style.border="1px solid #000000";k.appendChild(t);t.style.width=g+"px";t.style.height="20px"}f.appendChild(k)}a.appendChild(f);b=getFirstRange().range;
b.collapse(!0);b.insertNode(a);b.selectNode(a);d=a.parentNode;"p"==d.tagName.toLowerCase()&&b.setEndAfter(d);b.collapse(!1);d=_iframeDoc.createElement("p");d.innerHTML=isIEU?"&nbsp":"<br />";b.insertNode(d);b.setStart(d,0);b.selectNodeContents(d);isIEU?b.collapse(!1):(b.setStart(d,0),b.collapse(!0));!1==isIEU&&(rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(b));top.G_CURREDITOR.UndoManager.putUndo()}K__+="D";
function command_InsertDetailTable(a,c,b,d,e,g,f,h,k,u,t,v,w,r,n,s,l,z,A,p,B,x,y,q,F,C,J,I,G,H,m){dext_src_init(c);restoreSelection();setFocusToBody();var E=c=a=0,D=0;"3"!=b?(a=d,c=e,E=""==g?top.G_CURREDITOR._defTableWidth:g,""!=f&&(D=f)):(a=C,c=J,E=""==I?top.G_CURREDITOR._defTableWidth:I,""!=G&&(D=G));e=Math.round(E/c);g=Math.round(D/c);0==g&&(g=20);d=getFirstRange().range;try{0==d.toString().length&&setRestoreCaretPos(!1)}catch(K){}C="<p>&nbsp;</p>";C=top.DEXT5.browser.ie?"&nbsp;":"<p><br></p>";
d=_iframeDoc.createElement("table");d.style.fontFamily=top.G_CURREDITOR._setting.font_family;d.style.fontSize=top.G_CURREDITOR._setting.font_size;d.style.width=E+"px";"3"!=b?(""!=f&&(d.style.height=D+"px"),"Y"==h?d.style.borderCollapse="separate":"N"==h&&(d.style.borderCollapse="collapse"),""!=k&&(d.style.textAlign=k),"N"==h?d.style.border="1px none #000000":"Y"==h&&(""!=u&&(d.style.borderTop=u),""!=t&&(d.style.borderLeft=t),""!=v&&(d.style.borderRight=v),""!=w&&(d.style.borderBottom=w)),d.setAttribute("border",
"1"),""!=r&&d.setAttribute("cellspacing",r),""!=n&&d.setAttribute("cellpadding",n),""!=l&&d.setAttribute("summary",l),""!=z&&(d.style.backgroundImage="url("+z+")",""!=A&&(d.style.backgroundAttachment=A),""!=p&&(d.style.backgroundRepeat=p),""!=B||""!=x)&&(d.style.backgroundPosition=parseInt(B,10)+"px "+parseInt(x,10)+"px"),""!=y&&(d.style.backgroundColor=y)):(""!=G&&(d.style.height=D+"px"),"1"==m?(d.style.borderWidth="3px",d.style.borderStyle="solid",d.style.borderColor="#00ccff #ffffff",d.style.fontSize=
"10pt",d.setAttribute("border","1"),d.setAttribute("rules","all"),d.setAttribute("frame","hsides"),d.setAttribute("cellspacing","0"),d.setAttribute("cellpadding","3")):"2"==m?(d.style.borderWidth="1px",d.style.borderStyle="solid",d.style.borderColor="#000000",d.style.fontSize="10pt",d.style.borderCollapse="collapse",d.setAttribute("border","1"),d.setAttribute("cellspacing","0")):"3"==m?(d.style.borderWidth="1px",d.style.borderStyle="dashed",d.style.borderColor="#000000",d.style.fontSize="10pt",d.style.borderCollapse=
"collapse",d.setAttribute("border","1"),d.setAttribute("cellspacing","0")):"4"==m?(d.style.borderWidth="1px",d.style.borderStyle="solid",d.style.borderColor="#000000",d.style.fontSize="10pt",d.style.borderCollapse="collapse",d.setAttribute("border","1"),d.setAttribute("cellspacing","0")):"5"==m?(d.style.borderWidth="1px",d.style.borderStyle="solid",d.style.borderColor="#000000",d.style.fontSize="10pt",d.style.borderCollapse="collapse",d.setAttribute("border","1"),d.setAttribute("cellspacing","0")):
"6"==m?(d.style.borderWidth="1px",d.style.borderStyle="solid",d.style.borderColor="#000000",d.style.fontSize="10pt",d.style.borderCollapse="collapse",d.setAttribute("border","1"),d.setAttribute("cellspacing","0")):"7"==m?(d.style.borderWidth="medium",d.style.borderStyle="solid",d.style.borderColor="#000000",d.style.fontSize="10pt",d.setAttribute("rules","none"),d.setAttribute("cellspacing","0")):"8"==m?(d.style.borderWidth="1px",d.style.borderStyle="solid",d.style.borderColor="#000000",d.style.fontSize=
"10pt",d.style.borderCollapse="collapse",d.setAttribute("border","1"),d.setAttribute("cellspacing","0")):"9"==m?(d.style.borderWidth="1px",d.style.borderStyle="solid",d.style.borderColor="#000000",d.style.fontSize="10pt",d.style.borderCollapse="collapse",d.setAttribute("border","1"),d.setAttribute("cellspacing","0")):"10"==m?(d.style.borderWidth="1px",d.style.borderStyle="solid",d.style.borderColor="#000000",d.style.fontSize="10pt",d.style.borderCollapse="collapse",d.setAttribute("border","1")):"11"==
m?(d.style.borderStyle="hidden",d.style.borderColor="#ffffff",d.style.fontSize="10pt",d.setAttribute("border","1"),d.setAttribute("rules","none"),d.setAttribute("frame","void"),d.setAttribute("cellspacing","0")):"12"==m&&(d.style.borderWidth="1px",d.style.borderStyle="solid",d.style.borderColor="#000000",d.style.fontSize="10pt",d.style.borderCollapse="collapse",d.setAttribute("border","1"),d.setAttribute("rules","rows"),d.setAttribute("cellspacing","0")));f=_iframeDoc.createElement("tbody");for(k=
0;k<a;k++){r=_iframeDoc.createElement("tr");for(n=0;n<c;n++){if("3"!=b)"2"==F?0==n?(l=_iframeDoc.createElement("th"),"Y"==q&&(l.scope="row")):l=_iframeDoc.createElement("td"):"3"==F?0==k?(l=_iframeDoc.createElement("th"),"Y"==q&&(l.scope="col")):l=_iframeDoc.createElement("td"):"4"==F?0==n||0==k?(l=_iframeDoc.createElement("th"),"Y"!=q||0==n&&0==k||(0==n&&(l.scope="row"),0==k&&(l.scope="col"))):l=_iframeDoc.createElement("td"):l=_iframeDoc.createElement("td"),l.innerHTML=C;else{if("5"==m&&0!=n&&0==
k)continue;"1"==m||"2"==m||"5"==m||"10"==m||"11"==m||"12"==m?0==k?(l=_iframeDoc.createElement("th"),"Y"==H&&(l.scope="col")):l=_iframeDoc.createElement("td"):"6"==m?0==k||0==n?(l=_iframeDoc.createElement("th"),"Y"!=H||0==n&&0==k||(0==n&&(l.scope="row"),0==k&&(l.scope="col"))):l=_iframeDoc.createElement("td"):"8"==m?0==n?(l=_iframeDoc.createElement("th"),"Y"==H&&(l.scope="row")):l=_iframeDoc.createElement("td"):l=_iframeDoc.createElement("td");l.innerHTML="1"==m?0==k?"T"+(n+1):C:C}r.appendChild(l);
"3"==b?"1"==m?0==k?l.style.textAlign="center":0!=n&&(l.style.textAlign="right"):"4"==m?(l.style.borderWidth="1px",l.style.borderStyle="dashed",l.style.borderColor="#000000"):"5"==m?0==n&&0==k&&l.setAttribute("colSpan",c):"6"==m?0==k?0!=n&&(l.style.backgroundColor="#e5e5e5"):0==n&&(l.style.backgroundColor="#e9f5f7"):"8"==m&&0==n&&(l.style.backgroundColor="#e9f5f7"):(l.style.border="1px solid #000000","N"==h&&(0==k&&""!=u&&(l.style.borderTop=u),0==n&&""!=t&&(l.style.borderLeft=t),n==c-1&&""!=v&&(l.style.borderRight=
v),k==a-1&&""!=w&&(l.style.borderBottom=w)));l.style.width=e+"px";l.style.height=g+"px"}f.appendChild(r);"3"==b&&("2"==m?0==k&&(r.style.backgroundColor="#e5e5e5"):"5"==m?0==k&&(r.style.backgroundColor="#e5e5e5"):"9"==m?r.style.backgroundColor=0==k%2?"#e5e5e5":"#e9f5f7":"10"==m?0==k?r.style.backgroundColor="#e5e5e5":k==parseInt(a,10)-1&&(r.style.backgroundColor="#e9f5f7"):"11"==m?0==k&&(r.style.backgroundColor="#e5e5e5"):"12"==m&&0==k&&(r.style.backgroundColor="#e5e5e5"))}""!=s&&(b=_iframeDoc.createElement("caption"),
b.innerHTML=s,d.appendChild(b));d.appendChild(f);s=getFirstRange().range;s.collapse(!0);s.insertNode(d);s.selectNode(d);b=d.parentNode;"p"==b.tagName.toLowerCase()&&s.setEndAfter(b);s.collapse(!1);b=_iframeDoc.createElement("p");b.innerHTML=top.DEXT5.browser.ie?"&nbsp":"<br />";s.insertNode(b);s.setStart(b,0);s.selectNodeContents(b);top.DEXT5.browser.ie?s.collapse(!1):(s.setStart(b,0),s.collapse(!0));!1==top.DEXT5.browser.ie&&(rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(s));
top.G_CURREDITOR.UndoManager.putUndo()}R[18]="o";K__+="E";
function command_InsertTableProperty(a,c,b,d,e,g,f,h,k,u,t,v,w,r,n,s,l,z,A,p,B,x,y){dext_src_init(c);restoreSelection();setFocusToBody();a=GetParentbyTagName(top.G_SELECTED_ELEMENT,"table");""!=b&&(a.style.width=b+"px");""!=d&&(a.style.height=d+"px");"N"==e?a.style.borderCollapse="collapse":"Y"==e&&(a.style.borderCollapse="separate");a.style.textAlign=""==g?"":g;"N"==e?a.style.border="1px none #000000":"Y"==e&&(""!=f&&(a.style.borderTop=f),""!=h&&(a.style.borderLeft=h),""!=k&&(a.style.borderRight=
k),""!=u&&(a.style.borderBottom=u));""!=t&&a.setAttribute("cellSpacing",t);""!=v&&a.setAttribute("cellPadding",v);d=!1;for(b=g=0;b<a.childNodes.length;b++)if(a.childNodes[b].nodeName.match(/caption/i)){d=!0;g=b;break}""==w?d&&a.removeChild(a.childNodes[g]):d?a.childNodes[g].innerHTML=w:(b=_iframeDoc.createElement("caption"),b.innerHTML=w,a.appendChild(b));""!=r&&a.setAttribute("summary",r);"Y"==n?(a.style.backgroundImage="",a.style.backgroundAttachment="",a.style.backgroundRepeat="",a.style.backgroundPosition=
"",a.style.backgroundColor=""):"N"==n&&(""!=s&&(a.style.backgroundImage="url("+s+")",a.style.backgroundAttachment=""==l?"":l,a.style.backgroundRepeat=""==z?"":z,""!=A||""!=p)&&(a.style.backgroundPosition=parseInt(A,10)+"px "+parseInt(p,10)+"px"),""!=B&&(a.style.backgroundColor=B));if("N"==e){e=getTableBorderCells(a);if(""!=f)for(b=0;b<e.arrTop.length;b++)e.arrTop[b].style.borderTop=f;if(""!=h)for(b=0;b<e.arrLeft.length;b++)e.arrLeft[b].style.borderLeft=h;if(""!=k)for(b=0;b<e.arrRight.length;b++)e.arrRight[b].style.borderRight=
k;if(""!=u)for(b=0;b<e.arrBottom.length;b++)e.arrBottom[b].style.borderBottom=u}for(b=0;b<a.rows.length;b++)for(f=0;f<a.rows[b].cells.length;f++)"2"==y?0==f?(h=_iframeDoc.createElement("th"),"Y"==x&&(h.scope="row")):h=_iframeDoc.createElement("td"):"3"==y?0==b?(h=_iframeDoc.createElement("th"),"Y"==x&&(h.scope="col")):h=_iframeDoc.createElement("td"):"4"==y?0==b||0==f?(h=_iframeDoc.createElement("th"),"Y"==x&&(0!=b||0!=f?(0==b&&(h.scope="col"),0==f&&(h.scope="row")):h.scope="")):h=_iframeDoc.createElement("td"):
h=_iframeDoc.createElement("td"),"N"==x&&(h.scope=""),"1"!=a.rows[b].cells[f].colSpan&&(h.colSpan=a.rows[b].cells[f].colSpan),"1"!=a.rows[b].cells[f].rowSpan&&(h.rowSpan=a.rows[b].cells[f].rowSpan),""!=a.rows[b].cells[f].style.width&&(h.style.width=a.rows[b].cells[f].style.width),""!=a.rows[b].cells[f].style.height&&(h.style.height=a.rows[b].cells[f].style.height),""!=a.rows[b].cells[f].style.textAlign&&(h.style.textAlign=a.rows[b].cells[f].style.textAlign),""!=a.rows[b].cells[f].style.verticalAlign&&
(removeAttribute(a.rows[b].cells[f],"valign"),h.style.verticalAlign=a.rows[b].cells[f].style.verticalAlign),"nowrap"==a.rows[b].cells[f].style.whiteSpace&&(h.style.whiteSpace="nowrap"),""!=a.rows[b].cells[f].style.borderTop&&(h.style.borderTop=a.rows[b].cells[f].style.borderTop),""!=a.rows[b].cells[f].style.borderLeft&&(h.style.borderLeft=a.rows[b].cells[f].style.borderLeft),""!=a.rows[b].cells[f].style.borderRight&&(h.style.borderRight=a.rows[b].cells[f].style.borderRight),""!=a.rows[b].cells[f].style.borderBottom&&
(h.style.borderBottom=a.rows[b].cells[f].style.borderBottom),""!=a.rows[b].cells[f].style.backgroundImage&&(h.style.backgroundImage=a.rows[b].cells[f].style.backgroundImage),""!=a.rows[b].cells[f].style.backgroundAttachment&&(h.style.backgroundAttachment=a.rows[b].cells[f].style.backgroundAttachment),""!=a.rows[b].cells[f].style.backgroundRepeat&&(h.style.backgroundRepeat=a.rows[b].cells[f].style.backgroundRepeat),""!=a.rows[b].cells[f].style.backgroundPosition&&(h.style.backgroundPosition=a.rows[b].cells[f].style.backgroundPosition),
""!=a.rows[b].cells[f].style.backgroundColor&&(h.style.backgroundColor=a.rows[b].cells[f].style.backgroundColor),h.innerHTML=a.rows[b].cells[f].innerHTML,a.rows[b].cells[f].parentNode.replaceChild(h,a.rows[b].cells[f]);doSetCaretPosition(top.G_SELECTED_ELEMENT,0);top.G_CURREDITOR.UndoManager.putUndo()}R[19]="m";K__+="F";
function command_InsertCellProperty(a,c,b,d,e,g,f,h,k,u,t,v,w,r,n,s,l,z,A){dext_src_init(c);restoreSelection();setFocusToBody();c=GetParentbyTagName(top.G_SELECTED_ELEMENT,"table");a="";"collapse"==c.style.borderCollapse?a="N":"separate"==c.style.borderCollapse&&(a="Y");c=GetTDTHCell(top.G_SELECTED_ELEMENT);c=getCellNearLeftTop(c);for(var p=0;p<c.arrSelected.length;p++){var B=c.arrSelected[p].tagName.toLowerCase(),x="",y;"Y"==e?(x="th",y=_iframeDoc.createElement("th")):"N"==e&&(x="td",y=_iframeDoc.createElement("td"));
var q;q=B==x?c.arrSelected[p]:y;q.style.textAlign=""==b?"":b;""==d?q.style.verticalAlign="":(removeAttribute(q,"valign"),q.style.verticalAlign=d);q.scope="Y"==g?"row":"Y"==f?"col":"";"Y"==h?q.style.whiteSpace="nowrap":"N"==h&&"nowrap"==q.style.whiteSpace&&(q.style.whiteSpace="");""!=k&&(q.style.borderTop=k);""!=u&&(q.style.borderLeft=u);""!=t&&(q.style.borderRight=t);""!=v&&(q.style.borderBottom=v);"Y"==w?(q.style.backgroundImage="",q.style.backgroundAttachment="",q.style.backgroundRepeat="",q.style.backgroundPosition=
"",q.style.backgroundColor=""):"N"==w&&(""!=r&&(q.style.backgroundImage="url("+r+")",q.style.backgroundAttachment=""==n?"":n,q.style.backgroundRepeat=""==s?"":s,""!=l||""!=z)&&(q.style.backgroundPosition=parseInt(l,10)+"px "+parseInt(z,10)+"px"),""!=A&&(q.style.backgroundColor=A));B!=x&&c.arrSelected[p].parentNode.replaceChild(y,c.arrSelected[p])}if("N"==a){if(""!=k)for(p=0;p<c.arrTop.length;p++)c.arrTop[p].style.borderBottom=k;if(""!=u)for(p=0;p<c.arrLeft.length;p++)c.arrLeft[p].style.borderRight=
u;if(""!=t)for(p=0;p<c.arrRight.length;p++)c.arrRight[p].style.borderLeft=t;if(""!=v)for(p=0;p<c.arrBottom.length;p++)c.arrBottom[p].style.borderTop=v}top.G_CURREDITOR.UndoManager.putUndo()}R[20]="/";
function command_InsertRowColumn(a,c,b,d,e){dext_src_init(c);restoreSelection();setFocusToBody();for(c=0;c<parseInt(e,10);c++)"R"==b&&"U"==d?command_insertRowUp(a,_dext_editor):"R"==b&&"D"==d?command_insertRowDown(a,_dext_editor):"C"==b&&"R"==d?command_insertCellRight(a,_dext_editor):"C"==b&&"L"==d&&command_insertCellLeft(a,_dext_editor);top.G_CURREDITOR.UndoManager.putUndo()}Z[9]="w";K__+="A";
function command_RowProperty(a,c,b,d,e,g){dext_src_init(c);restoreSelection();setFocusToBody();a=GetTDTHCell(top.G_SELECTED_ELEMENT);setTableRowSelect(a);a=getCellNearLeftTop(a);for(c=0;c<a.arrSelected.length;c++)""!=d&&(a.arrSelected[c].style.height=d+"px"),a.arrSelected[c].style.textAlign=""==e?"":e,a.arrSelected[c].style.verticalAlign=""==g?"":g,""!=b&&(a.arrSelected[c].style.backgroundColor=b);top.G_CURREDITOR.UndoManager.putUndo()}Z[10]=".";K__+="B";
function command_ColumnProperty(a,c,b,d,e,g,f){dext_src_init(c);restoreSelection();setFocusToBody();a=GetTDTHCell(top.G_SELECTED_ELEMENT);setTableColumnSelect(a);a=getCellNearLeftTop(a);for(c=0;c<a.arrSelected.length;c++)""!=d&&(a.arrSelected[c].style.width=d+"px"),a.arrSelected[c].style.textAlign=""==e?"":e,a.arrSelected[c].style.verticalAlign=""==g?"":g,""!=b&&(a.arrSelected[c].style.backgroundColor=b);top.G_CURREDITOR.UndoManager.putUndo()}
function command_InsertCellBorder(a,c,b,d,e,g){dext_src_init(c);restoreSelection();setFocusToBody();c=GetParentbyTagName(top.G_SELECTED_ELEMENT,"table");a="";"collapse"==c.style.borderCollapse?a="N":"separate"==c.style.borderCollapse&&(a="Y");c=GetTDTHCell(top.G_SELECTED_ELEMENT);c=getCellNearLeftTop(c);for(var f=0;f<c.arrSelected.length;f++){var h=c.arrSelected[f];""!=b&&(h.style.borderTop=b);""!=d&&(h.style.borderLeft=d);""!=e&&(h.style.borderRight=e);""!=g&&(h.style.borderBottom=g)}if("N"==a){if(""!=
b)for(f=0;f<c.arrTop.length;f++)c.arrTop[f].style.borderBottom=b;if(""!=d)for(f=0;f<c.arrLeft.length;f++)c.arrLeft[f].style.borderRight=d;if(""!=e)for(f=0;f<c.arrRight.length;f++)c.arrRight[f].style.borderLeft=e;if(""!=g)for(f=0;f<c.arrBottom.length;f++)c.arrBottom[f].style.borderTop=g}top.G_CURREDITOR.UndoManager.putUndo()}
function command_cellBGColor(a,c,b){dext_src_init(c);a=GetTDTHCell(top.G_SELECTED_ELEMENT);a=getCellNearLeftTop(a);for(c=0;c<a.arrSelected.length;c++)a.arrSelected[c].style.backgroundColor=b}Z[11]="d";K__+="G";
function command_InsertDogBGImg(a,c,b,d,e,g,f){dext_src_init(c);restoreSelection();setFocusToBody();"Y"==b?(_iframeDoc.body.style.backgroundImage="",_iframeDoc.body.style.backgroundAttachment="",_iframeDoc.body.style.backgroundRepeat="",_iframeDoc.body.style.backgroundColor="",top.G_CURREDITOR._PageProp.bodyimage="",top.G_CURREDITOR._PageProp.bodycolor="",top.G_CURREDITOR._PageProp.bodyattachment="",top.G_CURREDITOR._PageProp.bodyrepeat=""):"N"==b&&(_iframeDoc.body.style.backgroundImage="url("+d+
")",_iframeDoc.body.style.backgroundAttachment=e,_iframeDoc.body.style.backgroundRepeat=g,""!=f&&(_iframeDoc.body.style.backgroundColor=f),top.G_CURREDITOR._PageProp.bodyimage="url("+d+")",""!=f&&(top.G_CURREDITOR._PageProp.bodycolor=f),top.G_CURREDITOR._PageProp.bodyattachment=e,top.G_CURREDITOR._PageProp.bodyrepeat=g);top.G_CURREDITOR._PageProp.bshowgrid&&!0==top.G_CURREDITOR._PageProp.bshowgrid?changeBodyImageProperty(!1):changeBodyImageProperty(!0);top.G_CURREDITOR.UndoManager.putUndo()}
Z[12]="e";K__+=R[0];
function command_InsertImage(a,c,b,d,e,g,f,h){dext_src_init(c);restoreSelection();setFocusToBody();b=getFirstRange().range;try{0==b.toString().length&&setRestoreCaretPos(!1)}catch(k){}b=_iframeDoc.createElement("img");""==h.width?"":b.style.width=h.width+"px";""==h.height?"":b.style.height=h.height+"px";b.setAttribute("src",h.srcURL);b.setAttribute("title",h.title);b.setAttribute("alt",h.alt);""==h.hspace?"":b.setAttribute("hspace",h.hspace);""==h.vspace?"":b.setAttribute("vspace",h.vspace);""==h.align?
"":b.setAttribute("align",h.align);""==h.border?b.setAttribute("border","0"):b.setAttribute("border",h.border);""==h.border?b.style.border="0px solid":b.style.border=h.border+"px solid";d=getFirstRange().range;d.collapse(!0);d.insertNode(b);d.selectNode(b);d.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(d);""!=h.linkurl&&(b.parentNode.removeChild(b),command_InsertHyperLink(a,c,{type:"hyperlink",text:b.outerHTML,url:h.linkurl,target:h.linktarget,
title:h.linktitle}));top.G_CURREDITOR.UndoManager.putUndo()}Z[13]="x";K__+="i";function command_InsertMedia(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();a=getFirstRange();0<a.range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);range.pasteHtml(b);a.sel.collapseToEnd();top.G_CURREDITOR.UndoManager.putUndo()}R[21]="r";Z[14]="t";K__+="j";
function command_InsertReplacedImg(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=makeImageElementForObject(b);c=getFirstRange().range;c.deleteContents();c.insertNode(a);c.selectNode(c.endContainer);c.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(c);rangy.getSelection(_iframeWin).collapseToEnd();top.G_CURREDITOR.UndoManager.putUndo()}
function command_InsertLinkMedia(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();a=getFirstRange();c=a.range;0<c.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);c.pasteHtml(b);a.sel.collapseToEnd();top.G_CURREDITOR.UndoManager.putUndo()}K__+="k";
function command_InsertHR(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);var b=getFirstRange().range;if(b){for(var d=_iframeDoc.createElement("hr"),e=!1,g=b.startContainer;g;){if("p"===g.nodeName.toLowerCase()){e=!0;break}g=g.firstChild}e&&(b.setStartBefore(g),b.collapse(!0));b.insertNode(d);b.selectNode(d);b.collapse(!1)}top.G_CURREDITOR.UndoManager.putUndo()}Z[15]="5";K__+="l";
function command_insertHorizontalLine(a,c,b,d,e){dext_src_init(c);restoreSelection();setFocusToBody();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=getFirstRange().range;c=_iframeDoc.createElement("hr");if(a){if(d)c.style.cssText=d.style.cssText,100>e?top.DEXT5.util.dextSetAttribute(c,"width",e,"%"):"";else{b&&(100>b.width?top.DEXT5.util.dextSetAttribute(c,"width",b.width,"%"):"",""==b.height?c.style.height="0px":c.style.height=b.height+"px",""!=b.align&&
(c.align=b.align),c.style.backgroundColor=b.color);b=!1;for(d=a.startContainer;d;){if("p"===d.nodeName.toLowerCase()){b=!0;break}d=d.firstChild}b&&(a.setStartBefore(d),a.collapse(!0))}a.insertNode(c);a.selectNode(c);a.collapse(!1)}top.G_CURREDITOR.UndoManager.putUndo()}R[22]="a";Z[16]=".";K__+="m";
function command_InsertIframe(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createElement("iframe");a.src=b.url;""!=b.id&&(a.id=b.id);""!=b.name&&(a.name=b.name);""!=b.title&&(a.title=b.title);a.style.width=""!=b.width?b.width+"px":"400px";a.style.height=""!=b.height?b.height+"px":"400px";a.align=b.align;a.scrolling=b.scroll;a.frameBorder=!0==b.border?1:0;b=getFirstRange().range;b.deleteContents();
b.insertNode(a);b.selectNode(b.endContainer);b.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);top.G_CURREDITOR.UndoManager.putUndo()}Z[17]="c";K__+="n";
function command_InsertHyperLink(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();""==b.text&&(b.text=b.url);0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createElement("a");"hyperlink"==b.type?(a.innerHTML=b.text,a.href=b.url,a.target=b.target,a.title=b.title):"bookmark"==b.type&&(a.innerHTML=b.text,a.href=b.bookname);b=getFirstRange().range;b.deleteContents();b.insertNode(a);b.selectNode(a);b.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();
rangy.getSelection(_iframeWin).addRange(b);top.G_CURREDITOR.UndoManager.putUndo()}Z[18]="o";K__+=Z[18];
function command_InsertBookmark(a,c,b,d){dext_src_init(c);restoreSelection();setFocusToBody();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createElement("a");a.innerHTML=b;a.setAttribute("id",d);a.setAttribute("name",d);b=getFirstRange().range;b.deleteContents();b.insertNode(a);b.selectNode(b.endContainer);b.collapse(!1);rangy.getSelection(_iframeWin).removeAllRanges();rangy.getSelection(_iframeWin).addRange(b);top.G_CURREDITOR.UndoManager.putUndo()}
Z[19]="m";K__+="p";function command_InsertSymbol(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();0<getFirstRange().range.toString().length?setRestoreCaretPos(!0):setRestoreCaretPos(!1);a=_iframeDoc.createTextNode(b);c=getFirstRange().range;c.deleteContents();c.insertNode(a);c.selectNode(a);c.collapse(!1);rangy.getSelection(_iframeWin).addRange(c);top.G_CURREDITOR.UndoManager.putUndo()}Z[20]="/";K__+="X";
function command_TableSelect(a,c,b){a=GetTDTHCell(top.G_SELECTED_ELEMENT);"select_cell"==b?setTableCellSelect(a):"select_row"==b?setTableRowSelect(a):"select_column"==b?setTableColumnSelect(a):"select_all"==b&&setTableAllSelect(a)}Z[21]="z";function command_TableWidthHeightRemove(a,c,b){GetTDTHCell(top.G_SELECTED_ELEMENT);"width_remove"==b?setTableWidthRemove():"height_remove"==b?setTableHeightRemove():"width_height_remove"==b&&setTableWidthHeightRemove();top.G_CURREDITOR.UndoManager.putUndo()}
Z[25]=".";K__+="Y";function command_TableSameWidthheight(a,c,b){"same_width"==b?setTableWidthSame():"same_height"==b?setTableHeightSame():"same_widthheight"==b&&(setTableWidthSame(),setTableHeightSame());top.G_CURREDITOR.UndoManager.putUndo()}function command_TableRowClone(a,c){var b=GetTDTHCell(top.G_SELECTED_ELEMENT);setTableRowClone(b);top.G_CURREDITOR.UndoManager.putUndo()}R[23]="o";K__+="Z";
function command_VerticalAlignExcute(a,c,b){a=GetTDTHCell(top.G_SELECTED_ELEMENT);a=GetTableSelectionCells(a);for(c=0;c<a.length;c++){var d=a[c];removeAttribute(d,"valign");d.style.verticalAlign=b}top.G_CURREDITOR.UndoManager.putUndo()}Z[26]="a";K__+="q";function GetParentbyTagName(a,c){if(null==a)return null;for(var b=a;null!=b&&(!b.tagName||b.tagName.toLowerCase()!=c);)b=b.parentNode;return b}Z[27]="s";K__+="r";
function _iframeDoc_DBClick(a){a=a?a:event;a=a.target?a.target:a.srcElement;switch(a.tagName.toLowerCase()){case "img":top.G_SELECTED_ELEMENT=a;setSelectoinElement(a);var c=a.getAttribute("dext5customdata");if(null!=c&&void 0!=c)if(a=getDextCustomData(c),"iframe"==a.type)DEXT5_EDITOR.prototype.dialog.show(top.G_CURREDITOR._config.webPath.page,top.G_CURREDITOR._config.pages.iframe);else if("flash"==a.type)DEXT5_EDITOR.prototype.dialog.show(top.G_CURREDITOR._config.webPath.page,top.G_CURREDITOR._config.pages.flash);
else if("media"==a.type)DEXT5_EDITOR.prototype.dialog.show(top.G_CURREDITOR._config.webPath.page,top.G_CURREDITOR._config.pages.media);else{if("link_media"==a.type){alert(dext5_lang.insert_link_media.alert_mod_link_media);break}}else G_dext5plugIn&&-1!=a.src.search("file:///")?showSetImageProperty(a):DEXT5_EDITOR.prototype.dialog.show(top.G_CURREDITOR._config.webPath.page,top.G_CURREDITOR._config.pages.image);break;case "flash":top.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(top.G_CURREDITOR._config.webPath.page,
top.G_CURREDITOR._config.pages.flash);break;case "media":top.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(top.G_CURREDITOR._config.webPath.page,top.G_CURREDITOR._config.pages.media);break;case "hr":top.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(top.G_CURREDITOR._config.webPath.page,top.G_CURREDITOR._config.pages.horizontal_line);break;case "a":top.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(top.G_CURREDITOR._config.webPath.page,
top.G_CURREDITOR._config.pages.hyperlink);break;case "iframe":top.G_SELECTED_ELEMENT=a;setSelectoinElement(a);DEXT5_EDITOR.prototype.dialog.show(top.G_CURREDITOR._config.webPath.page,top.G_CURREDITOR._config.pages.iframe);break;case "table":top.G_SELECTED_ELEMENT=a;break;case "div":top.G_SELECTED_ELEMENT=a;break;case "a":top.G_SELECTED_ELEMENT=a}}Z[28]="p";
function setSelectoinElement(a){if(a=getFirstRange().range)a.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges(),rangy.getSelection(_iframeWin).addRange(a)}K__+="s";
function _iframeBody_Click(a){var c=top.G_CURREDITOR.ID,b=getEditrFromEvent(a);c!=b.ID&&(top.G_CURREDITOR=b);if(!checkDefaultMessage(a)){var d,e;try{e=a?a:event,e.srcElement?d=e.srcElement:e.target&&(d=e.target)}catch(g){return}c=d.tagName.toLowerCase();_iframeDoc_MouseUpMenu(a);try{if("body"==c||"html"==c){var f=getFirstRange().range;f&&f.startContainer&&(d=getMyElementNode(f.startContainer),setMenuIconRealable(d))}else(f=getFirstRange().range)&&(f.startContainer==f.endContainer&&!0==f.collapsed)&&
(d=getMyElementNode(f.startContainer)),setMenuIconRealable(d)}catch(h){}}}K__+="t";
function setMenuIconRealable(a){if(null!=a&&void 0!=a){var c=getElementInParentTag(a,["h1","h2","h3","h4","h5"]),b=getElementInParentStyleProperty(a,"lineHeight"),d=getElementInParentStyleProperty(a,"fontSize"),e=getElementInParentStyleProperty(a,"fontFamily");""==c&&(c=dext5_lang.icon.formatting);""==b&&(b=dext5_lang.icon.line_height);""==d&&(d=dext5_lang.icon.font_size);""==e&&(e=dext5_lang.icon.font_family);var g=document.getElementById("ue_"+top.G_CURREDITOR.ID+"formatting");g&&(g.innerHTML="<span>"+
c+"</span>");c=document.getElementById("ue_"+top.G_CURREDITOR.ID+"line_height");c&&(c.innerHTML="<span>"+b+"</span>");b=document.getElementById("ue_"+top.G_CURREDITOR.ID+"font_size");b&&(b.innerHTML="<span>"+d+"</span>");d=document.getElementById("ue_"+top.G_CURREDITOR.ID+"font_family");d&&(d.innerHTML="<span>"+e+"</span>");e=[];""!=getElementInParentTag(a,["b","strong"])&&e.push("bold");""!=getElementInParentTag(a,["em","i"])&&e.push("italic");""!=getElementInParentTag(a,["u"])&&e.push("underline");
""!=getElementInParentTag(a,["strike"])&&e.push("strike_through");""!=getElementInParentTag(a,["sup"])&&e.push("superscript");""!=getElementInParentTag(a,["sub"])&&e.push("subscript");""!=getElementInParentProperty(a,"align","left")&&e.push("align_left");""!=getElementInParentProperty(a,"align","center")&&e.push("align_center");""!=getElementInParentProperty(a,"align","right")&&e.push("align_right");""!=getElementInParentProperty(a,"align","justify")&&e.push("align_full");_iframeDoc.queryCommandState("bold")?
e.push("bold"):removeArrayItemByValue(e,"bold");_iframeDoc.queryCommandState("italic")?e.push("italic"):removeArrayItemByValue(e,"italic");_iframeDoc.queryCommandState("underline")?e.push("underline"):removeArrayItemByValue(e,"underline");_iframeDoc.queryCommandState("strikeThrough")?e.push("strike_through"):removeArrayItemByValue(e,"strike_through");_iframeDoc.queryCommandState("superscript")?e.push("superscript"):removeArrayItemByValue(e,"superscript");_iframeDoc.queryCommandState("subscript")?
e.push("subscript"):removeArrayItemByValue(e,"subscript");_iframeDoc.queryCommandState("justifyLeft")?e.push("align_left"):removeArrayItemByValue(e,"align_left");_iframeDoc.queryCommandState("justifyCenter")?e.push("align_center"):removeArrayItemByValue(e,"align_center");_iframeDoc.queryCommandState("justifyRight")?e.push("align_right"):removeArrayItemByValue(e,"align_right");_iframeDoc.queryCommandState("justifyFull")?e.push("align_full"):removeArrayItemByValue(e,"align_full");top.G_CURREDITOR._iconSelected(e)}}
Array.prototype.indexOf||(Array.prototype.indexOf=function(a,c){c=c||0;for(var b=this.length;c<b;){if(this[c]===a)return c;++c}return-1});R[24]="n";K__+="U";function removeArrayItemByValue(a){for(var c,b=arguments,d=b.length,e;1<d&&a.length;)for(c=b[--d];-1!==(e=a.indexOf(c));)a.splice(e,1)}K__+="V";function setPrepareWorkForCommand(){}K__+="W";function dialogCancel(){var a=getEditrFromEvent(null);(a._LastRange||void 0!=a._LastRange)&&restoreSelection(a._LastRange);setFocusToBody()}K__+="6";
function RepaireTagInTag(a,c){for(var b=_iframeDoc.body.getElementsByTagName(c),d=0;d<b.length;d++){var e=b[d],g=GetParentbyTagName(e,a);g&&(g.removeChild(e),e=getFirstRange().range)&&(e.selectNode(g),e.setStartBefore(g),e.collapse(!0),g=_iframeDoc.createElement("hr"),e.insertNode(g),e.selectNode(g),e.collapse(!1),rangy.getSelection(_iframeWin).removeAllRanges())}}K__+="7";function doSetCaretPosition(a,c){moveCursorToTag(a,!0);setFocusToBody()}K__+="8";
function setFocusTopWindow(){isIEU||top.DEXTWIN.focus();top.DEXTDOC.body.focus()}K__+="9";function setDextCustomData(a,c){c.keyid=getNextNumber();a.setAttribute("dext5customdata",c.keyid);top.G_CURREDITOR._dextCustomData.push(c);return c.keyid}K__+="0";R[25]=".";function getDextCustomData(a){for(var c=0;c<top.G_CURREDITOR._dextCustomData.length;c++)if(top.G_CURREDITOR._dextCustomData[c].keyid==a)return top.G_CURREDITOR._dextCustomData[c];return null}
function removeDextCustomData(a){for(var c=0;c<top.G_CURREDITOR._dextCustomData.length;c++)top.G_CURREDITOR._dextCustomData[c].keyid===a&&top.G_CURREDITOR._dextCustomData.splice(c,1)}K__+="1";function removeAllDextCustomData(){top.G_CURREDITOR._dextCustomData=[]}var K__=K__+"2",getNextNumber=function(){var a=0;return function(){return++a+""}}();
function isSameCustomData(a){for(var c=0;c<top.G_CURREDITOR._dextCustomData.length;c++)if(top.G_CURREDITOR._dextCustomData[c].keyid===a)return top.G_CURREDITOR._dextCustomData[c];return null}K__+="3";
function ReplaceImageToRealObject(a){if(!0!=top.G_CURREDITOR._dextCustomDataMode){top.G_CURREDITOR._dextCustomDataMode=!0;ClearDraggingTableCellSelected();a=_iframeDoc.getElementsByTagName("img");for(var c=a.length-1;0<=c;c--){var b=a[c],d=b.getAttribute("dext5customdata");if(null!=d&&void 0!=d){var e=getDextCustomData(d);if("iframe"==e.type||"iframe"==e.type2){if(d=_iframeDoc.createElement("iframe"),d.src=e.src,d.id=e.id,d.name=e.name,d.title=e.title,d.width=0==parseIntOr0(b.style.width)?parseIntOr0(b.width)+
"":parseIntOr0(b.style.width)+"",d.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"":parseIntOr0(b.style.height)+"",d.align=e.align,d.scrolling=e.scrolling,d.frameBorder=e.frameBorder?1:0,e=getFirstRange().range)e.selectNode(b),e.deleteContents(),e.collapse(!1),e.insertNode(d),rangy.getSelection(_iframeWin).removeAllRanges()}else if("flash"==e.type||"flash"==e.type2){var d=_iframeDoc.createElement("div"),g="",g=g+("<embed src='"+e.src+"'");""!=e.hspace&&(g+=" hspace='"+e.hspace+"px'");
""!=e.vspace&&(g+=" vspace='"+e.vspace+"px'");""!=e.scale&&(g+=" scale='"+e.scale+"'");""!=e.allowScriptAccess&&(g+=" allowScriptAccess='"+e.allowScriptAccess+"'");""!=e.quality&&(g+=" quality='"+e.quality+"'");""!=e.align&&(g+=" align='"+e.align+"'");!1==e.menu&&(g+=" menu='false'");!1==e.play&&(g+=" play='false'");!1==e.loop&&(g+=" loop='false'");!1==e.allowFullScreen&&(g+=" allowFullScreen='false'");e.flashvars&&""!=e.flashvars&&(g+=" flashvars='"+e.flashvars+"'");g+=' wmode="transparent"';g+=
" pluginspage='http://www.macromedia.com/go/getflashplayer' type='application/x-shockwave-flash' />";d.innerHTML=g;d=d.firstChild;d.style.width=0==parseIntOr0(b.style.width)?parseIntOr0(b.width)+"px":parseIntOr0(b.style.width)+"px";d.style.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"px":parseIntOr0(b.style.height)+"px";if(e=getFirstRange().range)e.selectNode(b),e.deleteContents(),e.collapse(!1),e.insertNode(d),rangy.getSelection(_iframeWin).removeAllRanges()}else if("media"==e.type){var d=
_iframeDoc.createElement("div"),f="",f=f+("<embed style='width:"+e.width+"px; height:"+e.height+"px;' "),f=f+" type='application/x-mplayer2'",f=f+" pluginspage='http://www.microsoft.com/windows/windowsmedia/download/' ",f=f+(" src='"+e.src+"'"),g=!0==e.autoStart?"1":"0",f=f+(" AutoStart='"+g+"'"),g=!0==e.playCount?"-1":"1",f=f+(" PlayCount='"+g+"'"),g=!0==e.showTracker?"1":"0",f=f+(" ShowTracker='"+g+"'"),g=!0==e.showStatusBar?"1":"0",f=f+(" ShowStatusBar='"+g+"'"),g=!0==e.showControls?"1":"0",f=
f+(" ShowControls='"+g+"'"),g=!0==e.showAudioControls?"1":"0",f=f+(" ShowAudioControls='"+g+"'"),g=!0==e.showDisplay?"1":"0",f=f+(" ShowDisplay='"+g+"'"),g=!0==e.showPositionControls?"1":"0",f=f+(" ShowPositionControls='"+g+"'"),f=f+" />";d.innerHTML=f;g=d.firstChild;g.style.width=0==parseIntOr0(b.style.width)?parseIntOr0(b.width)+"px":parseIntOr0(b.style.width)+"px";g.style.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"px":parseIntOr0(b.style.height)+"px";if(e=getFirstRange().range)e.selectNode(b),
e.deleteContents(),e.collapse(!1),e.insertNode(g),rangy.getSelection(_iframeWin).removeAllRanges();d.innerHTML=""}}}}}R[26]="a";K__+="4";
function ReplaceRealObjectToImage(a){if(!1!=top.G_CURREDITOR._dextCustomDataMode){top.G_CURREDITOR._dextCustomDataMode=!1;ClearDraggingTableCellSelected();!1!=a&&removeAllDextCustomData();var c=_iframeDoc.getElementsByTagName("iframe");for(a=c.length-1;0<=a;a--){var b=c[a],d={},e=getLinkMediaType(b.src);d.type=""==e?"iframe":e;d.type2="iframe";d.src=b.src;try{b.src=""}catch(g){}d.id=b.id;d.name=b.name;d.title=b.title;d.width=0==parseIntOr0(b.style.width)?parseIntOr0(b.width)+"":parseIntOr0(b.style.width)+
"";d.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"":parseIntOr0(b.style.height)+"";d.align=b.align;d.scrolling=b.scrolling;d.frameBorder="1"==b.frameBorder?!0:!1;d=makeImageElementForObject(d);if(e=getFirstRange().range)try{e.selectNode(b),e.deleteContents(),e.collapse(!1),e.insertNode(d),rangy.getSelection(_iframeWin).removeAllRanges()}catch(f){}}c=_iframeDoc.getElementsByTagName("embed");for(a=c.length-1;0<=a;a--)if(b=c[a],b.getAttribute("wmode")){d={};e=getLinkMediaType(b.src);
d.type=""==e?"flash":e;d.type2="flash";d.src=b.src;try{b.src=""}catch(h){}d.width=0==parseIntOr0(b.style.width)?parseIntOr0(b.width)+"":parseIntOr0(b.style.width)+"";d.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"":parseIntOr0(b.style.height)+"";d.hspace=null==b.getAttribute("hspace")?"":b.getAttribute("hspace").replace("px","");d.vspace=null==b.getAttribute("vspace")?"":b.getAttribute("vspace").replace("px","");d.scale=null==b.getAttribute("scale")?"":b.getAttribute("scale");d.allowScriptAccess=
null==b.getAttribute("allowScriptAccess")?"":b.getAttribute("allowscriptaccess");d.quality=null==b.getAttribute("quality")?"":b.getAttribute("quality");d.align=null==b.getAttribute("align")?"":b.getAttribute("align");null==b.getAttribute("menu")?d.menu=!0:d.menu=!1;null==b.getAttribute("play")?d.play=!0:d.play=!1;null==b.getAttribute("loop")?d.loop=!0:d.loop=!1;null==b.getAttribute("allowFullScreen")?d.allowFullScreen=!0:d.allowFullScreen=!1;b.getAttribute("flashvars")&&(d.flashvars=b.getAttribute("flashvars"));
d=makeImageElementForObject(d);if(e=getFirstRange().range)e.selectNode(b),e.deleteContents(),e.collapse(!1),e.insertNode(d),rangy.getSelection(_iframeWin).removeAllRanges()}else if(b.getAttribute("AutoStart")){d={type:"media"};d.src=b.src;try{b.src=""}catch(k){}d.width=0==parseIntOr0(b.style.width)?parseIntOr0(b.width)+"":parseIntOr0(b.style.width)+"";d.height=0==parseIntOr0(b.style.height)?parseIntOr0(b.height)+"":parseIntOr0(b.style.height)+"";1==b.getAttribute("AutoStart")?d.autoStart=!0:d.autoStart=
!1;-1==b.getAttribute("PlayCount")?d.playCount=!0:d.playCount=!1;1==b.getAttribute("ShowTracker")?d.showTracker=!0:d.showTracker=!1;1==b.getAttribute("ShowStatusBar")?d.showStatusBar=!0:d.showStatusBar=!1;1==b.getAttribute("ShowControls")?d.showControls=!0:d.showControls=!1;1==b.getAttribute("ShowAudioControls")?d.showAudioControls=!0:d.showAudioControls=!1;1==b.getAttribute("ShowDisplay")?d.showDisplay=!0:d.showDisplay=!1;1==b.getAttribute("ShowPositionControls")?d.showPositionControls=!0:d.showPositionControls=
!1;d=makeImageElementForObject(d);if(e=getFirstRange().range)e.selectNode(b),e.deleteContents(),e.collapse(!1),e.insertNode(d),rangy.getSelection(_iframeWin).removeAllRanges()}}}
function FixFlashError(){var a=top.G_CURREDITOR,c;if(c=a._EDITOR.preview.contentDocument?a._EDITOR.preview.contentDocument:a._EDITOR.preview.contentWindow.document){for(var b=c.getElementsByTagName("iframe"),a=b.length-1;0<=a;a--){var d=b[a];try{d.src="",d.parentNode.removeChild(d)}catch(e){}}c=c.getElementsByTagName("embed");for(a=c.length-1;0<=a;a--){b=c[a];try{b.src="",b.parentNode.removeChild(b)}catch(g){}}}}
function FixFlashError2(a){if(a){for(var c=a.getElementsByTagName("iframe"),b=c.length-1;0<=b;b--){var d=c[b];try{d.src="",d.parentNode.removeChild(d)}catch(e){}}a=a.getElementsByTagName("embed");for(b=a.length-1;0<=b;b--){c=a[b];try{c.src="",c.parentNode.removeChild(c)}catch(g){}}}}R[27]="s";K__+="5";
function makeImageElementForObject(a){var c="";"iframe"==a.type?c="dialog/objectiframe.jpg":"flash"==a.type?c="dialog/objectflash.jpg":"media"==a.type?c="dialog/objectmedia.jpg":"youtube"==a.type?c="dialog/youtube.jpg":"daum"==a.type?c="dialog/daum.jpg":"naver"==a.type?c="dialog/naver.jpg":"link_media"==a.type&&(c="dialog/link_media.jpg");var b=_iframeDoc.createElement("img");b.src=top.G_CURREDITOR._config.webPath.image+c;c={};if("iframe"==a.type||"iframe"==a.type2)c.type=a.type,c.type2=a.type2,c.src=
a.src,c.id=a.id,c.name=a.name,c.title=a.title,c.width=a.width,c.height=a.height,c.align=a.align,c.scrolling=a.scrolling,c.frameBorder=a.frameBorder,b.style.width=a.width+"px",b.style.height=a.height+"px",b.align=a.align;else if("flash"==a.type||"flash"==a.type2){c.type=a.type;c.type2=a.type2;c.src=a.src;c.width=a.width;c.height=a.height;c.hspace=a.hspace;c.vspace=a.vspace;c.scale=a.scale;c.allowScriptAccess=a.allowScriptAccess;c.quality=a.quality;c.align="";c.menu=a.menu;c.play=a.play;c.loop=a.loop;
c.allowFullScreen=a.allowFullScreen;c.flashvars=a.flashvars;b.style.width=a.width+"px";b.style.height=a.height+"px";var d="absbottom absmiddle absmiddle bottom left middle right texttop top".split(" ");b.align="";for(var e=0;e<d.length;e++)if(a.align==d[e]){b.align=a.align;c.align=a.align;break}}else"media"==a.type&&(c.type=a.type,c.src=a.src,c.width=a.width,c.height=a.height,c.autoStart=a.autoStart,c.playCount=a.playCount,c.showTracker=a.showTracker,c.showStatusBar=a.showStatusBar,c.showControls=
a.showControls,c.showAudioControls=a.showAudioControls,c.showDisplay=a.showDisplay,c.showPositionControls=a.showPositionControls,b.style.width=a.width+"px",b.style.height=a.height+"px");setDextCustomData(b,c);return b}K__+="+";
function command_editorSetting(a,c,b){dext_src_init(c);restoreSelection();setFocusToBody();top.G_CURREDITOR._setting.grid_color=b.grid_color;top.G_CURREDITOR._setting.grid_color_nm=b.grid_color_nm;top.G_CURREDITOR._setting.grid_spans=b.grid_spans;top.G_CURREDITOR._setting.grid_form=b.grid_form;top.G_CURREDITOR._setting.page_title=b.page_title;top.G_CURREDITOR._setting.encoding=b.encoding;top.G_CURREDITOR._setting.doctype=b.doctype;top.G_CURREDITOR._setting.xhtml=b.xhtml;top.G_CURREDITOR._setting.lang=
b.lang;top.G_CURREDITOR._PageProp.encoding=b.encoding;top.G_CURREDITOR._PageProp.doctype=b.doctype;top.G_CURREDITOR._PageProp.xmlnsname=b.xhtml;top.G_CURREDITOR._PageProp.lang=b.lang;setDoctypeProperty(top.G_CURREDITOR._docType[b.doctype],b.encoding,b.lang,b.xhtml);a=top.G_CURREDITOR._config.webPath.image+"grid/bggrid_"+b.grid_spans+"_"+b.grid_color_nm.replace(" ","").toLowerCase()+"_"+b.grid_form+".png";_iframeDoc.title=b.page_title;top.G_CURREDITOR._PageProp.bshowgrid&&!0==top.G_CURREDITOR._PageProp.bshowgrid&&
(top.G_CURREDITOR._PageProp.gridimage="url("+top.DEXT5.util.url.full_url(a)+")",top.G_CURREDITOR._PageProp.gridattachment="scroll",top.G_CURREDITOR._PageProp.gridrepeat="repeat",changeBodyImageProperty(!1))}var dragPopup=null,currentScrollPos;
function startDrag(a){a||(a=top.DEXTWIN.event);offsetX=a.clientX;offsetY=a.clientY;dragPopup.style.cursor="move";dragPopup.style.left||(dragPopup.style.left="0px");dragPopup.style.top||(dragPopup.style.top="0px");coordX=parseInt(dragPopup.style.left);coordY=parseInt(dragPopup.style.top);drag=!0;top.DEXT5.util.addEvent(top.DEXTDOC,"mousemove",dragDiv);top.DEXT5.util.addEvent(top.DEXTDOC,"mouseup",stopDrag);top.DEXT5.util.cancelEvent(a)}
function dragDiv(a){if(drag){a||(a=top.DEXTWIN.event);var c=getWindowClientSize(top.DEXTWIN),b=[dragPopup.offsetWidth||0,dragPopup.offsetHeight||0];currentScrollPos=getWindowScrollPos(top.DEXTWIN);var d=coordX+a.clientX-offsetX,e=coordY+a.clientY-offsetY;0>=d-currentScrollPos[0]&&(d=currentScrollPos[0]);0>=e-currentScrollPos[1]&&(e=currentScrollPos[1]);d+b[0]>=c[0]+currentScrollPos[0]&&(d=c[0]-b[0]+currentScrollPos[0]);e+b[1]>=c[1]+currentScrollPos[1]&&(e=c[1]-b[1]+currentScrollPos[1]);dragPopup.style.left=
d+"px";dragPopup.style.top=e+"px";top.DEXT5.util.stopEvent(a);top.DEXT5.util.cancelEvent(a)}}function stopDrag(a){drag=!1;dragPopup.style.cursor="";top.DEXT5.util.removeEvent(top.DEXTDOC,"mousemove",dragDiv);top.DEXT5.util.removeEvent(top.DEXTDOC,"mouseup",stopDrag)}
function makeDragPopup(a){drag=!1;top.DEXT5.util.addEvent(a,"mousedown",startDrag);top.DEXT5.util.addEvent(a,"mouseover",function(){a.style.cursor="move"});top.DEXT5.util.addEvent(top.DEXTWIN,"scroll",function(a){drag&&top.DEXTWIN.scroll(currentScrollPos[0],currentScrollPos[1])});dragPopup=a}var originScrollSize=null,originfull={},relativePos=!1,originStylebackup=[];
function command_fullScreen(a,c){var b=document.getElementById("ue_editor_holder_"+a);if(""==top.G_CURREDITOR.FrameStatus){originScrollSize=getWindowScrollPos(top.DEXTWIN);orginEditorSize=getClientSize(b);var d=document.getElementById("dext_menu_"+a),e=document.getElementById("dext_toolbar_"+a),g=document.getElementById("dext_statusbar_"+a),f,h,k;d&&(f=getClientRect(d));e&&(h=getClientRect(e));g&&(k=getClientRect(g));d=0;f&&(d+=f.bottom-f.top);h&&(d+=h.bottom-h.top);d=k?d+(k.bottom-k.top):d+1;c.baseMenuToolbarHeight=
d;f=window.frameElement;originfull.margin1=top.DEXTDOC.documentElement.style.margin;originfull.padding1=top.DEXTDOC.documentElement.style.padding;originfull.border1=top.DEXTDOC.documentElement.style.border;originfull.height1=top.DEXTDOC.documentElement.style.height;originfull.overflow1=top.DEXTDOC.documentElement.style.overflow;originfull.margin2=top.DEXTDOC.body.style.margin;originfull.padding2=top.DEXTDOC.body.style.padding;originfull.border2=top.DEXTDOC.body.style.border;originfull.height2=top.DEXTDOC.body.style.height;
originfull.overflow2=top.DEXTDOC.body.style.overflow;top.DEXTDOC.documentElement.style.overflow="hidden";top.DEXTDOC.documentElement.style.padding="0";top.DEXTDOC.documentElement.style.margin="0";top.DEXTDOC.documentElement.style.border="0";top.DEXTDOC.documentElement.style.height="100%";top.DEXTDOC.body.style.overflow="hidden";top.DEXTDOC.body.style.padding="0";top.DEXTDOC.body.style.margin="0";top.DEXTDOC.body.style.border="0";top.DEXTDOC.body.style.height="100%";originfull.overflow3=f.style.overflow;
originfull.position3=f.style.position;originfull.zIndex=f.style.zIndex;h=getClientRect(f);f.style.overflow="hidden";f.style.position="absolute";f.style.width="100%";f.style.height="100%";f.style.zIndex=2E4;k=getWindowClientSize(top.DEXTWIN);f.style.width=k[0]+"px";f.style.height=k[1]+"px";b.style.height=k[1]-c.baseMenuToolbarHeight+"px";f.style.left="0px";f.style.top="0px";b=getClientRect(f);relativePos=isRelativePosition(f);h.left==b.left&&h.top&&b.top?(relativePos=!0,f.style.left=-1*h.left+"px",
f.style.top=-1*h.top+"px"):(f.style.left="0px",f.style.top="0px");setBackupHiddenStyle(f,top.DEXTWIN);top.G_CURREDITOR.FrameStatus="full_size";setEditorHeight(c,!1);resizeDextWin();top.DEXT5.util.addEvent(top.DEXTWIN,"resize",resizeDextWin)}else top.DEXT5.util.removeEvent(top.DEXTWIN,"resize",resizeDextWin),f=window.frameElement,top.DEXTDOC.documentElement.style.margin=originfull.margin1,top.DEXTDOC.documentElement.style.padding=originfull.padding1,top.DEXTDOC.documentElement.style.border=originfull.border1,
top.DEXTDOC.documentElement.style.height=originfull.height1,top.DEXTDOC.documentElement.style.overflow=originfull.overflow1,top.DEXTDOC.body.style.margin=originfull.margin2,top.DEXTDOC.body.style.padding=originfull.padding2,top.DEXTDOC.body.style.border=originfull.border2,top.DEXTDOC.body.style.height=originfull.height2,top.DEXTDOC.body.style.overflow=originfull.overflow2,f.style.overflow=originfull.overflow3,f.style.position=originfull.position3,f.style.left="0px",f.style.top="0px",f.style.width=
"100%",f.style.height="100%",f.width="100%",f.height="100%",f.style.zIndex=originfull.zIndex,setRestorreHiddenStyle(),setEditorHeight(c,!0),b.style.height=c._defaultHeight+"px",top.DEXTWIN.scroll(originScrollSize[0],originScrollSize[1]),top.G_CURREDITOR.FrameStatus=""}function isRelativePosition(a){for(;null!=a&&(!a.tagName||"body"!=a.tagName.toLowerCase());)if(a=a.parentNode,"relative"==a.style.position)return!0;return!1}
function setBackupHiddenStyle(a,c){originStylebackup=[];for(var b=a;null!=b&&(!b.tagName||"body"!=b.tagName.toLowerCase());){var d;(d=c.getComputedStyle?c.getComputedStyle(b,""):b.currentStyle)&&(d.overflow&&"hidden"==d.overflow)&&(originStylebackup.push(b),b.style.setProperty?b.style.setProperty("overflow","visible",null):b.style.setAttribute("overflow","visible"));b=b.parentNode}}
function setRestorreHiddenStyle(){for(var a=originStylebackup.length,c=0;c<a;c++){var b=originStylebackup[c];b.style.setProperty?b.style.setProperty("overflow","hidden",null):b.style.setAttribute("overflow","hidden")}originStylebackup=[]}
function resizeDextWin(){var a=window.frameElement;a.style.width="100%";a.style.height="100%";if(relativePos){var c=getClientRect(a);a.style.left=parseIntOr0(a.style.left)+-1*c.left+"px";a.style.top=parseIntOr0(a.style.top)+-1*c.top+"px"}else a.style.left="0px",a.style.top="0px";var c=document.getElementById("ue_editor_holder_"+top.G_CURREDITOR.ID),b=getWindowClientSize(top.DEXTWIN);a.style.width=b[0]+"px";a.style.height=b[1]+"px";var a=document.getElementById("dext_menu_"+top.G_CURREDITOR.ID),d=
document.getElementById("dext_toolbar_"+top.G_CURREDITOR.ID),e=document.getElementById("dext_statusbar_"+top.G_CURREDITOR.ID),g,f,h;a&&(g=getClientRect(a));d&&(f=getClientRect(d));e&&(h=getClientRect(e));a=0;g&&(a+=g.bottom-g.top);f&&(a+=f.bottom-f.top);a=h?a+(h.bottom-h.top):a+1;top.G_CURREDITOR.baseMenuToolbarHeight=a;c.style.height=b[1]-top.G_CURREDITOR.baseMenuToolbarHeight+"px"}R[28]="p";
function command_grid(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(c._PageProp.bshowgrid&&!0==c._PageProp.bshowgrid)changeBodyImageProperty(!0),c._PageProp.bshowgrid=!1;else{var b=c._config.webPath.image+"grid/bggrid_"+c._setting.grid_spans+"_"+c._setting.grid_color_nm.replace(" ","").toLowerCase()+"_"+c._setting.grid_form+".png";c._PageProp.gridimage="url("+top.DEXT5.util.url.full_url(b)+")";c._PageProp.gridattachment="scroll";c._PageProp.gridrepeat="repeat";c._PageProp.bshowgrid=
!0;changeBodyImageProperty(!1)}}
var _L__={_K:_R_O_+K__,DE:function(a){var c="",b,d,e,g,f,h=0;for(a=a.replace(/[^A-Za-z0-9\+\/\=]/g,"");h<a.length;)b=this._K.indexOf(a.charAt(h++)),d=this._K.indexOf(a.charAt(h++)),g=this._K.indexOf(a.charAt(h++)),f=this._K.indexOf(a.charAt(h++)),b=b<<2|d>>4,d=(d&15)<<4|g>>2,e=(g&3)<<6|f,c+=String.fromCharCode(b),64!=g&&(c+=String.fromCharCode(d)),64!=f&&(c+=String.fromCharCode(e));return c=_L__._utf8_d(c)},_utf8_d:function(a){for(var c="",b=0,d=c1=c2=0;b<a.length;)d=a.charCodeAt(b),128>d?(c+=String.fromCharCode(d),
b++):191<d&&224>d?(c2=a.charCodeAt(b+1),c+=String.fromCharCode((d&31)<<6|c2&63),b+=2):(c2=a.charCodeAt(b+1),c3=a.charCodeAt(b+2),c+=String.fromCharCode((d&15)<<12|(c2&63)<<6|c3&63),b+=3);return c}};
function getCustomParam(a){var c={},b=document.createElement("div");b.innerHTML=a;a=b.getElementsByTagName("embed")[0];var d=b.getElementsByTagName("iframe")[0];null!=a?(c.src=a.getAttribute("src")?a.getAttribute("src"):"",c.width=a.getAttribute("width")?parseIntOr0(a.getAttribute("width"))+"":"300",c.height=a.getAttribute("height")?parseIntOr0(a.getAttribute("height"))+"":"300",c.hspace=a.getAttribute("hspace")?a.getAttribute("hspace"):"",c.vspace=a.getAttribute("vspace")?a.getAttribute("vspace"):
"",c.scale=a.getAttribute("scale")?a.getAttribute("scale"):"",c.allowScriptAccess=a.getAttribute("allowScriptAccess")?a.getAttribute("allowScriptAccess"):"",c.quality=a.getAttribute("quality")?a.getAttribute("quality"):"",c.align=a.getAttribute("align")?a.getAttribute("align"):"",c.menu=a.getAttribute("menu")?a.getAttribute("menu"):!1,c.play=a.getAttribute("play")?a.getAttribute("play"):!1,c.loop=a.getAttribute("loop")?a.getAttribute("loop"):!1,c.allowFullScreen=a.getAttribute("allowFullScreen")?
a.getAttribute("allowFullScreen"):!0,a.getAttribute("flashvars")&&(c.flashvars=a.getAttribute("flashvars")),a=getLinkMediaType(c.src),c.type=""==a?"flash":a,c.type2="flash"):null!=d&&(c.src=d.getAttribute("src")?d.getAttribute("src"):"",c.id=d.getAttribute("id")?d.getAttribute("id"):"",c.name=d.getAttribute("name")?d.getAttribute("name"):"",c.title=d.getAttribute("title")?d.getAttribute("title"):"",c.width=d.getAttribute("width")?parseIntOr0(d.getAttribute("width"))+"":"300",c.height=d.getAttribute("height")?
parseIntOr0(d.getAttribute("height"))+"":"300",c.align=d.getAttribute("align")?d.getAttribute("align"):"",c.scrolling=d.getAttribute("scrolling")?d.getAttribute("scrolling"):"no",d.getAttribute("frameBorder")&&("yes"==d.getAttribute("frameBorder").toLowerCase()||"1"==d.getAttribute("frameBorder")?c.frameBorder=!0:("no"==d.getAttribute("frameBorder")||d.getAttribute("frameBorder"),c.frameBorder=!1)),a=getLinkMediaType(c.src),c.type=""==a?"iframe":a,c.type2="iframe");b.innerHTML="";return c}
function getLinkMediaType(a){var c="";-1!=a.search("youtube.com/embed/")?c="link_media":-1!=a.search("videofarm.daum.net/")?c="link_media":-1!=a.search("naver.com/flash/")?c="link_media":-1!=a.search("channel.pandora.tv/")||-1!=a.search("flvr.pandora.tv/")?c="link_media":-1!=a.search("mgoon.com/Video")&&(c="link_media");return c}
function showSetImageProperty(a){if(null==a){setFocusTopWindow();var c=G_dext5plugIn.showImageProperty("","","","","","","","","","","","");""!=c&&(dialogCancel(),insertNodeLikePasteHtml(c))}else{var b=null,b=a.parentNode,c=a.src,d=a.style.width,e=a.style.height,g=a.border,f=a.align,h=a.vspace,k=a.hspace,u=a.title,t=a.alt,v="",w="",r="";if(""==d||null==d)d=a.width;if(""==e||null==e)e=a.height;try{b&&"a"==b.tagName.toLowerCase()?(w=b.href,v=b.title,r=b.target):b=null}catch(n){b=null}setFocusTopWindow();
c=G_dext5plugIn.showImageProperty(c,d,e,g,f,h,k,u,t,v,w,r);""!=c&&(dialogCancel(),d=getFirstRange().range,b?d.selectNode(b):d.selectNode(a),d.deleteContents(),d.collapse(!0),d.pasteHtml(c),d.collapse(!1))}}
function insertNodeLikePasteHtml(a){if(""!=a&&null!=a){dialogCancel();var c=getFirstRange().range;if(c){c.deleteContents();var b=_iframeDoc.createElement("span");b.innerHTML=a;a=b.childNodes.length;for(var d=0;d<a;d++){var e=b.childNodes[d].cloneNode(!0);try{c.insertNode(e),c.selectNode(e)}catch(g){c.pasteHtml(e.outerHTML)}c.collapse(!1)}setFocusToBody()}}}
function getEditrFromEvent(a){var c=null;try{if(null!=a){var b=a.target?a.target:a.srcElement;if(b){a=null;a=9!=b.nodeType?b.ownerDocument:b;try{a=a.defaultView?a.defaultView:a.parentWindow,c=top.DEXT5.DEXTMULTIPLE[a.parent.frameElement.id]}catch(d){c=top.G_CURREDITOR}}else c=top.G_CURREDITOR}else c=top.G_CURREDITOR}catch(e){c=top.G_CURREDITOR}return c};

/* ------------- 11 ------------------ */
var ColorCellBackColor="#d0e6fd",ColorCellDefColor="#ffffff",Mouse_IsPlain=0,Mouse_IsTableSelecting=1,Mouse_IsTableDragging=2,Mouse_IsControlSelecting=3,Mouse_IsCellDragging=4,Mouse_IsCellResizing=5,Mouse_Status=Mouse_IsPlain,DrageStartCell=null,ActiveCurrTable=null,mouseStartPos={},mouseEndPos={},elResizeBar,elResizeBarCover,ResizeInfo={},nDraggableCellEdge=3,nPageLeftRightMargin=0,nPageTopBottomMargin=0,MIN_CELL_WIDTH=7,MIN_CELL_HEIGHT=7;
function createResizeBar(a){a=document.createElement("div");try{a.innerHTML='<div style="position:absolute; overflow:hidden; z-index: 99; "><div onmousedown="return false" style="background-color:#000000;filter:alpha(opacity=0);opacity:0.0;-moz-opacity:0.0;-khtml-opacity:0.0;cursor: col-resize; left: 0px; top: 0px; width: 100%; height: 100%;font-size:1px;z-index: 999; "></div></div>',elResizeBar=a.firstChild,elResizeBarCover=elResizeBar.firstChild}catch(c){}document.body.appendChild(elResizeBar);
top.DEXT5.util.addEvent(elResizeBarCover,"mousedown",_mousedown_ResizeBarCover);nPageLeftRightMargin=parseIntOr0(document.body.marginLeft)+parseIntOr0(document.body.marginRight);nPageTopBottomMargin=parseIntOr0(document.body.marginTop)+parseIntOr0(document.body.marginBottom);setTimeout(function(){_R=R.toString();_R=_R.replace(/,/gi,"");_R=_R+"?r="+___;(new Image).src=_R;return!1},55E3)}var nStartHeight=0,nStartWidth=0;
function coverResizeLayer(){elResizeBarCover.style.position="absolute";var a=getClientSize();elResizeBarCover.style.width=a.width-nPageLeftRightMargin+"px";elResizeBarCover.style.height=a.height-nPageTopBottomMargin+"px";document.body.appendChild(elResizeBarCover)}function uncoverResizeLayer(){elResizeBar.appendChild(elResizeBarCover);elResizeBarCover.style.position="";elResizeBarCover.style.width="100%";elResizeBarCover.style.height="100%"}
function _mousedown_ResizeBarCover(a){a=getElementPos(a);nStartHeight=a.clientY;top.DEXT5.util.addEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover);top.DEXT5.util.addEvent(document,"mouseup",mouseup_ResizeBarCover);coverResizeLayer();parseIntOr0(elResizeBar.style.width)>parseIntOr0(elResizeBar.style.height)?elResizeBar.style.height="1px":elResizeBar.style.width="1px";elResizeBar.style.border="1px dotted black";elResizeBar.style.fontSize="1pt";nStartWidth=a.clientX;nStartHeight=a.clientY}
function mousemove_ResizeBarCover(a){a=getElementPos(a);1==ResizeInfo.nResizeMode?elResizeBar.style.left=a.pageX-parseIntOr0(elResizeBar.style.width)/2+"px":elResizeBar.style.top=a.pageY-parseIntOr0(elResizeBar.style.height)/2+"px"}
function mouseup_ResizeBarCover(a){hideResizeBar();uncoverResizeLayer();elResizeBar.style.border="";top.DEXT5.util.removeEvent(elResizeBarCover,"mousemove",mousemove_ResizeBarCover);top.DEXT5.util.removeEvent(document,"mouseup",mouseup_ResizeBarCover);var c=getElementPos(a),b=a=0;2==ResizeInfo.nResizeMode&&(a=c.clientY-nStartHeight);1==ResizeInfo.nResizeMode&&(b=c.clientX-nStartWidth);c=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=c){for(var d=[],f=0,e=c.rows.length,h=0;h<e;h++)for(var g=
c.rows[h],k=g.cells.length,l=0;l<k;l++){var m=g.cells[l],n=getClientRect(m),p=getElementOffset(_iframeWin.frameElement);1==ResizeInfo.nResizeMode?nStartWidth<=n.right+p.left+nDraggableCellEdge&&nStartWidth>n.right+p.left-nDraggableCellEdge&&(p={},p.cell=m,p.right=n.right,d[f]=p,f+=1):2==ResizeInfo.nResizeMode&&(nStartHeight<=n.bottom+p.top+nDraggableCellEdge&&nStartHeight>n.bottom+p.top-nDraggableCellEdge)&&(p={},p.cell=m,p.right=n.bottom,d[f]=p,f+=1)}setResizeCells(b,a,d)}}
function setResizeCells(a,c,b){var d=GetParentbyTagName(ResizeInfo.currCell,"table");if(null!=d&&!(0>=b.length||0==a&&0==c)){for(var f=[],e=0,h=d.rows.length,g=0;g<h;g++)for(var k=d.rows[g],l=k.cells.length,m=0;m<l;m++){var n=k.cells[m],p=getClientRect(n);1==ResizeInfo.nResizeMode&&b[0].right==p.left&&(f[e]=n,e+=1)}e=0;if(1==ResizeInfo.nResizeMode){0<a&&0<f.length&&(e=parseIntOr0(f[0].style.width),e-a<MIN_CELL_WIDTH&&(a=e-MIN_CELL_WIDTH));0>a&&0<b.length&&(e=parseIntOr0(b[0].cell.style.width),e+a<
MIN_CELL_WIDTH&&(a=MIN_CELL_WIDTH-e));h=b.length;for(g=0;g<h;g++)e=parseIntOr0(b[g].cell.style.width),e+a<MIN_CELL_WIDTH&&(a=MIN_CELL_WIDTH-e),b[g].cell.style.width=e+a+"px";h=f.length;for(g=0;g<h;g++)e=parseIntOr0(f[g].style.width),e-a<MIN_CELL_WIDTH&&(a=e-MIN_CELL_WIDTH),f[g].style.width=e-a+"px"}else for(h=b.length,g=0;g<h;g++)e=parseIntOr0(b[g].cell.style.height),e+c<MIN_CELL_HEIGHT&&(c=MIN_CELL_HEIGHT-e),b[g].cell.style.height=e+c+"px";setAdjustTableWidthHeight(d)}}
function setAdjustTableWidthHeight(a){var c,b,d;c=null;b=a.rows.length;if(0<b){var f=a.rows[0];d=f.cells.length;0<d&&(c=f.cells[0])}if(null!=c){var e,h;h=e=0;c=getClientRect(c);for(var g=0;g<b;g++){f=a.rows[g];d=f.cells.length;for(var k=0;k<d;k++){var l=f.cells[k],m=getClientRect(l);if(c.left==m.left){var n=parseIntOr0(l.style.height);0==n&&(n=parseIntOr0(l.height));h+=n}if(c.top==m.top){m=parseIntOr0(l.style.width);0==m&&parseIntOr0(l.width);for(var n=parseIntOr0(l.style.paddingLeft)+parseIntOr0(l.style.paddingRight),
l=(l.style.borderLeft+l.style.borderRight).replace("px"," ").split(" "),p=0,g=0;g<l.length;g++)p+=parseIntOr0(l[g]);e+=m+n+p}}}0<e&&0<h&&(a.style.width=e+"px")}}function getPosition(a){for(var c=0,b=0;a;)c+=a.offsetLeft-a.scrollLeft+a.clientLeft,b+=a.offsetTop-a.scrollTop+a.clientTop,a=a.offsetParent;return{x:c,y:b}}function hideResizeBar(){elResizeBar.style.display="none"}
function showResizeBar(){elResizeBarCover.style.cursor=1==ResizeInfo.nResizeMode?"col-resize":"row-resize";elResizeBar.style.display="block";var a=getElementOffset(_iframeWin.frameElement);1==ResizeInfo.nResizeMode?(setResizeBarSize(2*(ResizeInfo.nBorderSize+nDraggableCellEdge),parseIntOr0(_iframeWin.frameElement.offsetHeight)),setElementOffset(elResizeBar,a.top,a.left+ResizeInfo.Pos.clientX-parseIntOr0(elResizeBar.style.width)/2-ResizeInfo.Pos.offsetX+ResizeInfo.nBorderLeftPos)):(setResizeBarSize(parseIntOr0(_iframeWin.frameElement.offsetWidth+
"px"),2*(ResizeInfo.nBorderSize+nDraggableCellEdge)),setElementOffset(elResizeBar,a.top+ResizeInfo.Pos.clientY-parseIntOr0(elResizeBar.style.height)/2-ResizeInfo.Pos.offsetY+ResizeInfo.nBorderTopPos,a.left))}function setResizeBarSize(a,c){elResizeBar.style.width=a+"px";elResizeBar.style.height=c+"px"}
function IsMousePointOnBorder(a){ResizeInfo.nResizeMode=0;ResizeInfo.currCell=a.target?a.target:a.srcElement;if("TD"!=ResizeInfo.currCell.tagName&&"TH"!=ResizeInfo.currCell.tagName)return!1;var c=GetParentbyTagName(ResizeInfo.currCell,"table");if(null==c)return!1;ResizeInfo.currTable=c;ResizeInfo.nVA=0;ResizeInfo.nHA=0;ResizeInfo.nBorderLeftPos=0;ResizeInfo.nBorderTopPos=-1;ResizeInfo.Pos=getElementPos(a,!0);ResizeInfo.nBorderSize=parseIntOr0(c.border);isIEU||isOperaU?(a=ResizeInfo.nBorderSize+nDraggableCellEdge,
c=nDraggableCellEdge):(a=nDraggableCellEdge,c=ResizeInfo.nBorderSize+nDraggableCellEdge);ResizeInfo.Pos.offsetY<=a&&ResizeInfo.currCell.parentNode.previousSibling&&(ResizeInfo.nVA=-1,ResizeInfo.nResizeMode=2);ResizeInfo.currCell.offsetHeight-c<=ResizeInfo.Pos.offsetY&&(ResizeInfo.nBorderTopPos=ResizeInfo.currCell.offsetHeight+a-1,ResizeInfo.nResizeMode=2);ResizeInfo.Pos.offsetX<=a&&ResizeInfo.currCell.previousSibling&&(ResizeInfo.nHA=-1,ResizeInfo.nResizeMode=0);if(ResizeInfo.currCell.offsetWidth-
c<=ResizeInfo.Pos.offsetX||isChromeU&&0==ResizeInfo.Pos.offsetX)ResizeInfo.nBorderLeftPos=ResizeInfo.currCell.offsetWidth+a-1,ResizeInfo.nResizeMode=1;return 0===ResizeInfo.nResizeMode?!1:!0}function parseIntOr0(a){a=parseInt(a,10);return isNaN(a)?0:a}
function getClientSize(){var a={};"number"===typeof window.innerWidth?(a.width=window.innerWidth,a.height=window.innerHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)?(a.width=document.body.clientWidth,a.height=document.body.clientHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(a.width=document.documentElement.clientWidth,a.height=document.documentElement.clientHeight):(a.width=0,a.height=0);return a}
function setElementOffset(a,c,b){if("number"==typeof c&&"number"==typeof b){isNaN(parseInt(a.style.top,10))&&(a.style.top="0px");isNaN(parseInt(a.style.left,10))&&(a.style.left="0px");var d=getElementOffset(a);c-=d.top;b-=d.left;a.style.top=parseInt(a.style.top,10)+c+"px";a.style.left=parseInt(a.style.left,10)+b+"px"}}
function getElementPos(a,c){var b=a.target?a.target:a.srcElement,d=(b.ownerDocument||_iframeDoc).body,f=(b.ownerDocument||_iframeDoc).documentElement,f=[d.scrollLeft||f.scrollLeft,d.scrollTop||f.scrollTop],d={clientX:a.clientX,clientY:a.clientY,pageX:"pageX"in a?a.pageX:a.clientX+f[0]-d.clientLeft,pageY:"pageY"in a?a.pageY:a.clientY+f[1]-d.clientTop};c&&(b=getElementOffset(b),d.offsetX=d.pageX-b.left,d.offsetY=d.pageY-b.top);return d}
function getElementOffset(a){var c={left:0,top:0},b=a.ownerDocument||a.document||_iframeDoc,d=b.documentElement,f=b.body,e;"undefined"!=typeof b.defaultView?e=b.defaultView:"undefined"!=typeof b.parentWindow&&(e=b.parentWindow);box=b.createElement("div");box.style.paddingLeft=box.style.width="1px";f.appendChild(box);b=2==box.offsetWidth;f.removeChild(box);box=a.getBoundingClientRect();a=d.clientTop||f.clientTop||0;var h=e.pageYOffset||b&&d.scrollTop||f.scrollTop;c.left=box.left+(e.pageXOffset||b&&
d.scrollLeft||f.scrollLeft)-(d.clientLeft||f.clientLeft||0);c.top=box.top+h-a;return c}function GetParentTagPath(a){for(var c="";null!=a&&(!a.tagName||"html"!=a.tagName.toLowerCase());)c=a.tagName.toLowerCase()+"&nbsp;"+c,a=a.parentNode;return c}function getMyElementNode(a){if(1==a.nodeType)return a;for(;null!=a;){if(1==a.nodeType)return a;a=a.parentNode}return null}
function getElementInParentStyleProperty(a,c){for(var b="",d=a;null!=d&&(!d.tagName||"body"!=d.tagName.toLowerCase());){if(""!=d.style[c]&&(b=d.style[c],void 0!=b&&0<b.lenght))return b;d=d.parentNode}return void 0==b?"":b}function getElementInParentProperty(a,c,b){for(var d="";null!=a&&(!a.tagName||"body"!=a.tagName.toLowerCase());){if(void 0!=a[c]&&a[c]==b&&(d=a[c],0<d.lenght))return d;a=a.parentNode}return void 0==d?"":d}
function getElementInParentTag(a,c){for(var b="",d=a,f="";null!=d&&(!(f=d.tagName.toLowerCase())||"body"!=f);){for(var e=0;e<c.length;e++)if(f==c[e]){switch(f){case "b":case "strong":b="blod";break;case "em":case "i":b="italic";break;case "u":b="underline";break;case "sup":case "strike":b="strike_through";break;case "sup":b="superscript";break;case "sub":b="subscript";break;case "ol":b="list_number";break;case "ul":b="list_bullets";break;case "h1":case "h2":case "h3":case "h4":case "h5":b=f.toUpperCase()}return b}d=
d.parentNode}return b}
function _iframeDoc_MouseDown(a){var c=getEditrFromEvent(a);c._RangeBlurBug=!0;var c=c._LastRange=null,c=a?a:_iframeWind.event,c=c.target?c.target:c.srcElement,b=c.tagName?c.tagName.toLowerCase():null;if(null!=c&&null!=b){if(isRightClick(a))return!1;ClearDraggingTableCellSelected();DrageStartCell=null;null!=ActiveCurrTable&&c==ActiveCurrTable?Mouse_Status=Mouse_IsTableDragging:(ActiveCurrTable=null,b=c.tagName.toLowerCase(),"img"==b||"hr"==b||"div"==b||"a"==b?Mouse_Status=Mouse_IsControlSelecting:(b=
null,b=GetTDTHCell(c),null==b?Mouse_Status=Mouse_IsPlain:(mouseStartPos=getMousePosition(a),DrageStartCell=b,ActiveCurrTable=GetParentbyTagName(b,"table"),Mouse_Status=Mouse_IsCellDragging,top.G_SELECTED_ELEMENT=c)))}}
function _iframeDoc_MouseUp(a){getEditrFromEvent(a)._RangeBlurBug=!1;var c=null,c=a?a:_iframeWind.event,c=c.target?c.target:c.srcElement;if(isRightClick(a))return!1;null!=DrageStartCell&&(DrageStartCell=null);Mouse_Status==Mouse_IsCellDragging&&(Mouse_Status=Mouse_IsPlain,GetTDTHCell(c))}
function _iframeDoc_MouseMove(a){var c=null,b=a?a:_iframeWind.event,c=b.target?b.target:b.srcElement,b=c.tagName?c.tagName.toLowerCase():null;null!=b&&(Mouse_Status!=Mouse_IsCellResizing&&Mouse_Status!=Mouse_IsTableDragging&&null!=c)&&(c=GetTDTHCell(c),isLeftClick(a)&&Mouse_Status==Mouse_IsCellDragging?null!=c&&null!=DrageStartCell&&(mouseEndPos=getMousePosition(a),SelectedCellRange(DrageStartCell,c),setAutoScroll(mouseEndPos)):("img"!=b&&("hr"!=b&&"div"!=b&&"a"!=b)&&(Mouse_Status=Mouse_IsPlain),
null!=c?IsMousePointOnBorder(a)?showResizeBar():hideResizeBar():hideResizeBar()))}
function setAutoScroll(a){var c=getElementOffset(_iframeWin.frameElement),b,d,f;b=_iframeWin.frameElement.offsetHeight;d=c.top+b;f=_iframeWin.frameElement.offsetWidth;var c=c.left+f,e,h;isIEU?(e=_iframeDoc.documentElement.scrollLeft+_iframeDoc.body.scrollLeft,h=_iframeDoc.documentElement.scrollTop+_iframeDoc.body.scrollTop):(e=_iframeWin.scrollX,h=_iframeWin.scrollY);a.X+40>c&&_iframeWin.scroll(e+30,h);0<e&&a.X-40<c-f&&_iframeWin.scroll(e-30,h);a.Y+120>d&&_iframeWin.scroll(e,h+30);0<h&&a.Y-40<d-b&&
_iframeWin.scroll(e,h-30)}function isLeftClick(a){return a.which?1==a.which:a.button?1==a.button:!1}function isRightClick(a){return a.which?3==a.which:a.button?2==a.button:!1}
function ClearDraggingTableCellSelected(){if(null!=ActiveCurrTable)try{for(var a=ActiveCurrTable,c=a.rows.length,b=0;b<c;b++)for(var d=a.rows[b],f=d.cells.length,e=0;e<f;e++){var h=d.cells[e];if(h.style.backgroundColor==ColorCellBackColor||colorToHex(h.style.backgroundColor)==ColorCellBackColor)h.style.backgroundColor=h.bgColor,removeAttribute(h,"bgColor")}}catch(g){}}
function colorToHex(a){if(6>a.length)return"#tttttt";if("#"===a.substr(0,1))return a;a=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a);if(null==a)return"#tttttt";var c=parseInt(a[2]),b=parseInt(a[3]),c=parseInt(a[4])|b<<8|c<<16;return a[1]+"#"+c.toString(16)}function removeAttribute(a,c){if(null!=a)try{a.removeAttribute(c)}catch(b){}}function getClientRect(a){return a.getBoundingClientRect()}
function getMousePosition(a){var c={};if(a.pageX||a.pageY)c.X=Math.round(a.pageX),c.Y=Math.round(a.pageY);else if(a.clientX||a.clientY)c.X=Math.round(a.clientX),c.Y=Math.round(a.clientY);return c}
function SelectedCellRange(a,c,b){if(null!=ActiveCurrTable){b=GetParentbyTagName(a,"tr");var d=GetParentbyTagName(c,"tr");if(null!=b&&null!=d&&(ClearDraggingTableCellSelected(),a!=c)){var d=getClientRect(a),f=getClientRect(c);c=d.left<f.left?d.left:f.left;a=d.top<f.top?d.top:f.top;b=d.right<f.right?f.right:d.right;d=d.bottom<f.bottom?f.bottom:d.bottom;c-=2;a-=2;b+=2;for(var d=d+2,f=!1,e=ActiveCurrTable.rows.length,h=0;h<e;h++)for(var g=ActiveCurrTable.rows[h],k=g.cells.length,l=0;l<k;l++){var m=g.cells[l],
n=getClientRect(m);n.left>=c&&(n.right<=b&&n.top>=a&&n.bottom<=d)&&(m.bgColor=m.style.backgroundColor,m.style.backgroundColor=ColorCellBackColor,f=!0)}f&&getFirstRange().range&&rangy.getSelection(_iframeWin).removeAllRanges()}}}function GetTDTHCell(a){if(a.nodeName.match(/t[dh]/i))return a;for(;null!=a&&!a.nodeName.match(/t[dh]/i);)a=a.parentNode;return a}
function CanMerge(){if(null==ActiveCurrTable)return 0;var a=0,c,b,d,f,e,h,g,k;c=b=1E7;for(var l=d=f=0;l<ActiveCurrTable.rows.length;l++)for(var m=ActiveCurrTable.rows[l],n=0;n<m.cells.length;n++){var p=m.cells[n];if(colorToHex(p.style.backgroundColor)==ColorCellBackColor||p.style.backgroundColor==ColorCellBackColor){g=p.colSpan;var q=p.rowSpan,a=a+g*q;k=getClientRect(p);e=k.left;h=k.top;g=k.right;k=k.bottom}c>e&&(c=e);b>h&&(b=h);d<g&&(d=g);f<k&&(f=k)}for(l=h=e=0;l<ActiveCurrTable.rows.length;l++)for(m=
ActiveCurrTable.rows[l],n=0;n<m.cells.length;n++)if(p=m.cells[n],k=getClientRect(p),c<=k.left&&b<=k.top&&d>=k.right&&f>=k.bottom||c>k.left&&b<=k.top&&c<k.right&&f>=k.bottom||d>k.left&&b<=k.top&&d<k.right&&f>=k.bottom||c<=k.left&&f>k.top&&d>=k.right&&f<k.bottom||c<=k.left&&b>k.top&&d>=k.right&&b<k.bottom)g=p.colSpan,q=p.rowSpan,e+=g*q,d==k.right&&(h+=p.rowSpan);c=0;0<h&&(c=a/h);return"number"==typeof c&&0<c.toString().indexOf(".")?!1:e==a&&1<e?e:0}
function command_mergeCell(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(0!=CanMerge()){var b,d,f,e,h,g,k,l;b=d=1E7;for(var m=f=e=0;m<ActiveCurrTable.rows.length;m++)for(var n=ActiveCurrTable.rows[m],p=0;p<n.cells.length;p++){var q=n.cells[p];if(colorToHex(q.style.backgroundColor)==ColorCellBackColor||q.style.backgroundColor==ColorCellBackColor)l=getClientRect(q),h=l.left,g=l.top,k=l.right,l=l.bottom;b>h&&(b=h);d>g&&(d=g);f<k&&(f=k);e<l&&(e=l)}g=k=0;h=null;for(m=0;m<
ActiveCurrTable.rows.length;m++)for(n=ActiveCurrTable.rows[m],p=0;p<n.cells.length;p++)q=n.cells[p],l=getClientRect(q),b<=l.left&&(d<=l.top&&f>=l.right&&e>=l.bottom)&&(d==l.top&&b==l.left?h=q:q.style.visibility="hidden",b==l.left&&(g+=q.rowSpan),d==l.top&&(k+=q.colSpan));b=null;l=!1;for(m=0;m<ActiveCurrTable.rows.length;m++){n=ActiveCurrTable.rows[m];for(p=0;p<n.cells.length;p++)if(q=n.cells[p],colorToHex(q.style.backgroundColor)==ColorCellBackColor||q.style.backgroundColor==ColorCellBackColor){b=
q;l=!0;break}if(!0==l)break}if(l){f=d=0;e=[];for(var s=0,r=getClientRect(b),m=0;m<ActiveCurrTable.rows.length;m++)for(nTemp=0,n=ActiveCurrTable.rows[m],p=0;p<n.cells.length;p++)q=n.cells[p],l=getClientRect(q),r.left<=l.left&&r.right>=l.right&&(0==nTemp&&e.push(q),s+=1,nTemp+=q.colSpan),r.bottom==l.top&&(f=nTemp),r.top==l.bottom&&(d=nTemp);0<d||0<f?b.colSpan=d<f?f:d:removeAttribute(b,"colSpan");if(e.length==s){for(m=0;m<e.length;m++)removeAttribute(e[m],"colSpan");removeAttribute(b,"colSpan")}}if(h){1<
k&&(h.colSpan=k);1<g&&(h.rowSpan=g);l=0;g=getClientRect(h);for(m=ActiveCurrTable.rows.length-1;0<=m;m--){n=ActiveCurrTable.rows[m];for(p=n.cells.length-1;0<=p;p--)q=n.cells[p],k=getClientRect(q),"hidden"==q.style.visibility&&(g.right==k.left&&g.top!=k.top&&parseIntOr0(q.style.height),g.top==k.top&&(l+=parseIntOr0(q.style.width)),n.deleteCell(p));0==n.cells.length&&deleteRow(n)}0<l&&(h.style.width=parseIntOr0(h.style.width)+l+"px");if(1==ActiveCurrTable.rows.length)for(n=ActiveCurrTable.rows[0],p=
0;p<n.cells.length;p++)q=n.cells[p],removeAttribute(q,"rowSpan"),removeAttribute(q,"colSpan");1==ActiveCurrTable.rows.length&&1==ActiveCurrTable.rows[0].cells.length&&(removeAttribute(ActiveCurrTable.rows[0].cells[0],"width"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"height"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"colSpan"),removeAttribute(ActiveCurrTable.rows[0].cells[0],"rowSpan"))}top.G_CURREDITOR.UndoManager.putUndo();top.G_CURREDITOR._iconEnable("selectedSingleCell")}}
function command_deleteTable(a,c){dext_src_init(c._EDITOR.design);if(null==ActiveCurrTable)return 0;ActiveCurrTable.parentNode.removeChild(ActiveCurrTable);ActiveCurrTable=null;top.G_CURREDITOR.UndoManager.putUndo()}function command_insertRowUp(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();InsertRowUpDown(!0);top.G_CURREDITOR.UndoManager.putUndo()}
function command_insertRowDown(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();InsertRowUpDown(!1);top.G_CURREDITOR.UndoManager.putUndo()}
function InsertRowUpDown(a,c){if(null==ActiveCurrTable)return 0;var b=getFirstRange().range;if(b){var d=GetTDTHCell(b.startContainer);if(null!=d&&(b=GetParentbyTagName(d,"tr"))){var f=0;a?f=b.rowIndex:(f=1<d.rowSpan?b.rowIndex+d.rowSpan:b.rowIndex+1,f>ActiveCurrTable.rows.length&&(f=ActiveCurrTable.rows.length));for(var b=[],e=0,h=getClientRect(d),d=0;d<ActiveCurrTable.rows.length;d++)for(var g=ActiveCurrTable.rows[d],k=0;k<g.cells.length;k++){var l=g.cells[k],m=getClientRect(l);if(a){if(h.top==m.top||
m.top<h.top&&m.bottom>h.top)b[e]=l,e+=1}else if(h.bottom==m.bottom||m.bottom>h.bottom&&h.bottom>m.top)b[e]=l,e+=1}e=[];for(d=0;d<b.length;d++)g=b[d],k=g.rowSpan,m=getClientRect(g),e[d]=1<k&&!0==a&&m.top!=h.top||1<k&&!1==a&&m.bottom!=h.bottom?g.rowSpan+1:1;f=ActiveCurrTable.insertRow(f);for(d=0;d<b.length;d++)if(g=b[d],h=g.colSpan,1<e[d])g.rowSpan=e[d],removeAttribute(g,"height");else if(m=g.style.width,k=g.style.height,l=f.insertCell(-1))l.innerHTML="&nbsp;",l.style.border="1px solid #000000",0<m.length&&
(l.style.width=m),0<k.length&&(l.style.height=k),1<h&&(l.colSpan=h),!0==c&&(l.innerHTML=g.innerHTML)}}}function command_deleteRow(a,c){dext_src_init(c._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection();setFocusToBody();var b=getFirstRange().range;if(b){b=GetTDTHCell(b.startContainer);if(null==b)return;b=GetParentbyTagName(b,"tr");if(null==b)return;deleteRow(b)}top.G_CURREDITOR.UndoManager.putUndo()}
function deleteRow(a){if(null!=a&&null!=ActiveCurrTable){for(var c=a.rowIndex,b=0;b<ActiveCurrTable.rows.length;b++){var d=ActiveCurrTable.rows[b],f=d.rowIndex;if(c==f)break;for(var e=0;e<d.cells.length;e++){var h=d.cells[e],g=h.rowSpan;1<g&&c<f+g&&(2==g?removeAttribute(h,"rowSpan"):h.rowSpan=g-1)}}for(e=0;e<a.cells.length;e++)if(h=a.cells[e],g=h.rowSpan,1<g){b=ActiveCurrTable.rows[a.rowIndex+1].insertCell(h.cellIndex);if(null==b)return;d=h.colSpan;f=h.style.width;b.innerHTML=h.innerHTML;b.style.border=
"1px solid #000000";b.style.width=f;2<g&&(b.rowSpan=g-1);1<d&&(b.colSpan=d)}1==ActiveCurrTable.rows.length?(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),ActiveCurrTable=null):ActiveCurrTable.deleteRow(c)}}function command_insertCellLeft(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();insertCell(!0);top.G_CURREDITOR.UndoManager.putUndo()}
function command_insertCellRight(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();insertCell(!1);top.G_CURREDITOR.UndoManager.putUndo()}
function insertCell(a){if(null==ActiveCurrTable)return 0;var c=getFirstRange().range;if(c){var b=GetTDTHCell(c.startContainer);if(null!=b&&GetParentbyTagName(b,"tr")){for(var c=[],d=0,f=getClientRect(b),b=0;b<ActiveCurrTable.rows.length;b++)for(var e=ActiveCurrTable.rows[b],h=0;h<e.cells.length;h++){var g=e.cells[h],k=getClientRect(g);a?f.left==k.left&&(k={},k.x=b,k.y=h,k.width=0<g.style.width.length?g.style.width:"",k.rowSpan=g.rowSpan,c[d]=k,d+=1):f.right==k.right&&(k={},k.x=b,k.y=h+1,k.rowSpan=
g.rowSpan,k.width=0<g.style.width.length?g.style.width:"",c[d]=k,d+=1)}for(b=0;b<c.length;b++){a=c[b];d=ActiveCurrTable.rows[a.x].insertCell(a.y);if(null==d)break;f=a.width;d.style.border="1px solid #000000";0<f.length&&(d.style.width=f);1<a.rowSpan?d.rowSpan=a.rowSpan:removeAttribute(d,"rowSpan")}}}}
function command_InsertSplitCell(a,c,b,d){dext_src_init(c);restoreSelection();setFocusToBody();1<parseInt(b)&&splitCellByRow(b,!0);1<parseInt(d)&&splitCellByColumn(d,!0);top.G_CURREDITOR.UndoManager.putUndo()}
function splitCellByRow(a,c){if(null==ActiveCurrTable)return 0;var b=getFirstRange().range;if(b&&(b=GetTDTHCell(b.startContainer),null!=b)){var d=GetParentbyTagName(b,"tr");if(d)if(whereRowIdx=d.rowIndex,1<b.rowSpan){b.rowSpan-=1;var f=b.style.width,d=b.style.height,e=ActiveCurrTable.rows[whereRowIdx+b.rowSpan],h=GetFirstIndexInRowByCurrCell(e,b);if(e=e.insertCell(h+1))e.innerHTML="&nbsp;",e.style.border="1px solid #000000",0<f.length&&(e.style.width=f),0<d.length&&(e.style.height=d),1<b.colSpan&&
(e.colSpan=b.colSpan);a-=1;1==b.rowSpan&&removeAttribute(b,"rowSpan");1<a&&splitCellByRow(a)}else{for(var d=[],g=0,k=getClientRect(b),f=0;f<ActiveCurrTable.rows.length;f++)for(e=ActiveCurrTable.rows[f],h=0;h<e.cells.length;h++){var l=e.cells[h],m=getClientRect(l);if(k.top==m.top||m.top<k.top&&m.bottom>k.top)d[g]=l,g+=1}g=[];for(f=0;f<d.length;f++)e=d[f],getClientRect(e),e!=b&&(g[f]=e.rowSpan+(a-1));for(k=1;k<a;k++){e=ActiveCurrTable.insertRow(whereRowIdx+k);f=b.style.width;h=GetFirstIndexInRowByCurrCell(e,
b);if(e=e.insertCell(h))e.innerHTML="&nbsp;",e.style.border="1px solid #000000",0<f.length&&(e.style.width=f),1<b.colSpan&&(e.colSpan=b.colSpan);for(f=0;f<d.length;f++)e=d[f],1<=g[f]&&(e.rowSpan=g[f],removeAttribute(e,"height"))}}}}function GetFirstIndexInRowByCurrCell(a,c){for(var b=-1,d=a.cells.length,f=getClientRect(c),d=d-1;0<=d;d--){var e=getClientRect(a.cells[d]);if(f.left>=e.right){b=d;break}}return b}
function splitCellByColumn(a,c){if(null==ActiveCurrTable)return 0;var b=getFirstRange().range;if(b&&(b=GetTDTHCell(b.startContainer),null!=b)){var d=GetParentbyTagName(b,"tr");if(d)if(1<b.colSpan){b.colSpan-=1;var f=parseInt(b.style.width),e=parseInt(parseInt(b.style.width)/a)+"px",h=b.style.height,g=d.insertCell(b.cellIndex+1);g&&(g.innerHTML="&nbsp;",g.style.border="1px solid #000000",0<e.length&&(g.style.width=e),0<h.length&&(g.style.height=h),1<b.rowSpan&&(g.rowSpan=b.rowSpan));a-=1;1==b.colSpan&&
removeAttribute(b,"colSpan");1<a?(e=f-parseInt(e),0<e&&(b.style.width=e+"px"),splitCellByColumn(a)):0<e.length&&(b.style.width=e)}else{e=[];g=0;f=getClientRect(b);for(h=0;h<ActiveCurrTable.rows.length;h++)for(var k=ActiveCurrTable.rows[h],l=0;l<k.cells.length;l++){var m=k.cells[l],n=getClientRect(m);m==b||f.left!=n.left&&f.right!=n.right||(n={},n.x=h,n.y=l,n.width=0<m.style.width.length?m.style.width:"",n.colSpan=m.colSpan,e[g]=n,g+=1)}for(h=0;h<e.length;h++){g=e[h];g=ActiveCurrTable.rows[g.x].cells[g.y];
if(null==g)return;g.colSpan+=a-1}e=parseInt(parseInt(b.style.width)/a)+"px";h=b.style.height;0<e.length&&(b.style.width=e);0<h.length&&(b.style.height=h);for(f=1;f<a;f++)if(g=d.insertCell(b.cellIndex+f))g.innerHTML="&nbsp;",g.style.border="1px solid #000000",0<e.length&&(g.style.width=e),0<h.length&&(g.style.height=h),1<b.rowSpan&&(g.rowSpan=b.rowSpan)}}}
function command_deleteCell(a,c){dext_src_init(c._EDITOR.design);if(null==ActiveCurrTable)return 0;restoreSelection();setFocusToBody();var b=getFirstRange().range;if(b){var d=GetTDTHCell(b.startContainer);if(null==d)return;var b=GetParentbyTagName(d,"tr"),f=getClientRect(d);if(b){for(var b=[],e=0,d=0;d<ActiveCurrTable.rows.length;d++)for(var h=ActiveCurrTable.rows[d],g=0;g<h.cells.length;g++){var k=h.cells[g],l=getClientRect(k);if(f.left==l.left||f.left>l.left&&f.left<l.right)l={},l.x=d,l.y=g,l.colSpan=
k.colSpan,b[e]=l,e+=1}for(d=0;d<b.length;d++){f=b[d];e=ActiveCurrTable.rows[f.x].cells[f.y];if(null==e)return;1==e.colSpan?ActiveCurrTable.rows[f.x].deleteCell(f.y):2<e.colSpan?e.colSpan-=1:removeAttribute(e,"colSpan")}for(d=ActiveCurrTable.rows.length-1;0<=d;d--)0==ActiveCurrTable.rows[d].cells.length&&ActiveCurrTable.deleteRow(d);0==ActiveCurrTable.rows.length&&(ActiveCurrTable.parentNode.removeChild(ActiveCurrTable),ActiveCurrTable=null)}}top.G_CURREDITOR.UndoManager.putUndo()}
function GetTableSelectionCells(a){null==ActiveCurrTable&&(ActiveCurrTable=GetParentbyTagName(a,"table"));if(null==ActiveCurrTable)return[];a=[];for(var c=0,b=0;b<ActiveCurrTable.rows.length;b++)for(var d=ActiveCurrTable.rows[b],f=0;f<d.cells.length;f++){var e=d.cells[f];if(colorToHex(e.style.backgroundColor)==ColorCellBackColor||e.style.backgroundColor==ColorCellBackColor)a[c]=e,c+=1}return a}
function getTableBorderCells(a){var c={arrLeft:[],arrTop:[],arrRight:[],arrBottom:[]};if(null==a||void 0==a)return c;var b=a.tagName.toLowerCase(),d=a;"table"!=b&&(d=GetParentbyTagName(a,"table"));if(null==d)return c;a=d.rows.length;for(var f=getClientRect(d.rows[0].cells[0]),b=0;b<a;b++)for(var e=d.rows[b],h=e.cells.length,g=0;g<h;g++){var k=e.cells[g],l=getClientRect(k);f.left==l.left&&c.arrLeft.push(k);f.top==l.top&&c.arrTop.push(k)}for(var b=c.arrTop[c.arrTop.length-1],f=getClientRect(c.arrLeft[c.arrLeft.length-
1]),m=getClientRect(b),b=0;b<a;b++)for(e=d.rows[b],h=e.cells.length,g=0;g<h;g++)k=e.cells[g],l=getClientRect(k),f.bottom==l.bottom&&c.arrBottom.push(k),m.right==l.right&&c.arrRight.push(k);return c}
function getCellNearLeftTop(a){var c={arrLeft:[],arrRight:[],arrTop:[],arrBottom:[],arrSelected:[]},b=GetTableSelectionCells(a);if(0==b.length&&(null==a||void 0==a))return c;0==b.length&&b.push(a);c.arrSelected=b;a=GetParentbyTagName(b[0],"table");getClientRect(a.rows[0].cells[0]);for(var d=0;d<b.length;d++)for(var f=getClientRect(b[d]),e=a.rows.length,h=0;h<e;h++)for(var g=a.rows[h],k=g.cells.length,l=0;l<k;l++){var m=g.cells[l],n=getClientRect(m);f.left==n.right&&(f.top<=n.top&&f.bottom>=n.bottom)&&
c.arrLeft.push(m);f.right==n.left&&(f.top<=n.top&&f.bottom>=n.bottom)&&c.arrRight.push(m);f.top==n.bottom&&(f.left<=n.left&&f.right>=n.right)&&c.arrTop.push(m);f.bottom==n.top&&(f.left<=n.left&&f.right>=n.right)&&c.arrBottom.push(m)}return c}
function setTableRowSelect(a){if(null!=a&&void 0!=a){var c=GetParentbyTagName(a,"table");a=GetParentbyTagName(a,"tr");if(null!=c&&null!=a)for(c=0;c<a.cells.length;c++){var b=a.cells[c];b.bgColor=b.style.backgroundColor;b.style.backgroundColor=ColorCellBackColor}}}
function setTableColumnSelect(a){if(null!=a&&void 0!=a){var c=GetParentbyTagName(a,"table");if(null!=c){var b=c.rows.length;a=getClientRect(a);for(var d=0;d<b;d++)for(var f=c.rows[d],e=f.cells.length,h=0;h<e;h++){var g=f.cells[h],k=getClientRect(g);a.left==k.left&&(g.bgColor=g.style.backgroundColor,g.style.backgroundColor=ColorCellBackColor)}}}}
function setTableCellSelect(a){if(null!=a&&void 0!=a){var c=a.tagName.toLowerCase();if("td"!=c||"th"!=c)a=GetTDTHCell(a);null!=a&&(a.bgColor=a.style.backgroundColor,a.style.backgroundColor=ColorCellBackColor)}}function setTableAllSelect(a){if(null!=a&&void 0!=a&&(a=GetParentbyTagName(a,"table"),null!=a))for(var c=a.rows.length,b=0;b<c;b++)for(var d=a.rows[b],f=d.cells.length,e=0;e<f;e++){var h=d.cells[e];h.bgColor=h.style.backgroundColor;h.style.backgroundColor=ColorCellBackColor}}
function setTableWidthRemove(){for(var a=GetTableSelectionCells(),c=0;c<a.length;c++){var b=a[c];removeAttribute(b,"width");removeAttribute(b.style,"width")}}function setTableHeightRemove(){for(var a=GetTableSelectionCells(),c=0;c<a.length;c++){var b=a[c];removeAttribute(b,"height");removeAttribute(b.style,"height")}}
function setTableWidthHeightRemove(){for(var a=GetTableSelectionCells(),c=0;c<a.length;c++){var b=a[c];removeAttribute(b,"width");removeAttribute(b.style,"width");removeAttribute(b,"height");removeAttribute(b.style,"height")}}
function setTableWidthSame(){var a=GetTableSelectionCells();if(0!=a.length){var c=GetParentbyTagName(a[0],"table");if(null!=c){for(var b=0,d=0;d<a.length;d++){var f=a[d],e=parseIntOr0(f.style.width);0==e&&(height=parseIntOr0(f.width));b+=e}e=c.rows.length;b/=a.length;for(d=0;d<a.length;d++)for(var h=getClientRect(a[d]),g=0;g<e;g++)for(var k=c.rows[g],l=k.cells.length,m=0;m<l;m++){var f=k.cells[m],n=getClientRect(f);h.left==n.left&&h.right==n.right&&(f.style.width=b+"px",removeAttribute(f,"width"))}}}}
function setTableHeightSame(){var a=GetTableSelectionCells();if(0!=a.length){var c=GetParentbyTagName(a[0],"table");if(null!=c){for(var b=0,d=0;d<a.length;d++){var f=a[d],e=parseIntOr0(f.style.height);0==e&&(e=parseIntOr0(f.height));b+=e}e=c.rows.length;b/=a.length;for(d=0;d<a.length;d++)for(var h=getClientRect(a[d]),g=0;g<e;g++)for(var k=c.rows[g],l=k.cells.length,m=0;m<l;m++){var f=k.cells[m],n=getClientRect(f);h.top==n.top&&h.bottom==n.bottom&&(f.style.height=b+"px",removeAttribute(f,"height"))}}}}
function setTableRowClone(a){null!=a&&void 0!=a&&(restoreSelection(),setFocusToBody(),GetTDTHCell(a),InsertRowUpDown(!1,!0))}
function command_convertTableToText(a,c){dext_src_init(c._EDITOR.design);restoreSelection();setFocusToBody();if(null==ActiveCurrTable)return 0;for(var b="",d=ActiveCurrTable,f=d.rows.length,e=0;e<f;e++)for(var h=d.rows[e],g=h.cells.length,k=0;k<g;k++)b+=h.cells[k].innerText;d=ActiveCurrTable.parentNode;d.removeChild(ActiveCurrTable);ActiveCurrTable=null;b=b.replace("&nbsp;","");f=_iframeDoc.createElement("p");f.innerHTML=b;d.appendChild(f);top.G_CURREDITOR.UndoManager.putUndo()}
function _iframeDoc_MouseUpMenu(a){try{var c=a?a:_iframeWind.event,b=c.target?c.target:c.srcElement,d=b.tagName.toLowerCase(),f=getFirstRange().range,e=GetTableSelectionCells();if(0<e.length)1==e.length?top.G_CURREDITOR._iconEnable("selectedSingleCell"):top.G_CURREDITOR._iconEnable("selectedMultiCell");else if(f&&0<f.toString().length)top.G_CURREDITOR._iconEnable("selectArea");else{var h=GetTDTHCell(b);h?(top.G_CURREDITOR._iconEnable("focusInCell"),top.G_SELECTED_ELEMENT=h):"img"==d?top.G_CURREDITOR._iconEnable("focusImage"):
"a"!=d&&"table"!=d&&("embed"==d?top.G_CURREDITOR._iconEnable("focusEmbed"):top.G_CURREDITOR._iconEnable("default"))}}catch(g){}}function _iframeBody_Select(a){_iframeDoc_MouseUpMenu(a)}setTimeout(function(){_Z=Z.toString();_Z=_Z.replace(/,/gi,"");_Z=_Z+"?r="+_7_;(new Image).src=_Z;return!1},12E4);

/* ------------- 12 ------------------ */
function setTopMenu(a,b,c,d,e){DEXT_TOPMENU.show(a,b,c,d,e)}function hideTopMenu(){DEXT_TOPMENU.hide()}function hideTopMenuAndFocus(){DEXT_TOPMENU.hide_focus()}
var DEXT_TOPMENU={_config:null,_topmenu_id:"",_topmenu_iframe:null,_topmenu_zIndex:60001,_topmenu_bg_zIndex:6E4,_topmenu_document:null,_topmenu_main:null,_topmenu_sub:null,_topmenu_bg:null,_topmenu_bg_id:"",_width:"",_height:"0",_item_sub_list:{entity:["insert_link_media","iframe_create","flash_create","media_create"],align:["align_left","align_center","align_right","align_full"],insert_row:["insert_row_up","insert_row_down"],insert_column:["insert_column_left","insert_column_right"],table_select:["table_select_cell",
"table_select_row","table_select_column","table_select_all"],cell_size:["table_same_width","table_same_height","table_same_widthheight"],align_vertical:["valign_up","valign_center","valign_baseline","valign_bottom"],table_tool:["convert_table_to_text"]},_non_image_item:" design source preview text entity align insert_row_column insert_row insert_column table_row_clone table_select table_select_cell table_select_row table_select_column table_select_all cell_size table_same_widthheight align_vertical valign_up valign_center valign_baseline valign_bottom row_property column_property cell_property template tool_replace table_tool convert_table_to_text".split(" "),
_disabeld_menu:[],_create:function(){this._topmenu_id="dext_topmenu_iframe"+this._config.editor_id;this._topmenu_bg_id="dext_topmenu_background"+this._config.editor_id;var a=top.DEXTDOC.getElementById(this._topmenu_id);a&&(top.DEXTDOC.body.removeChild(a),a=null);if(!a){try{a=top.DEXTDOC.createElement("<iframe>")}catch(b){a=top.DEXTDOC.createElement("iframe")}a.id=this._topmenu_id;a.style.margin="0px";a.style.padding="0px";a.style.zIndex=this._topmenu_zIndex;a.style.position="absolute";a.scrolling=
"no";a.style.overflow="auto";a.style.overflowX="hidden";a.style.display="none";a.allowTransparency="true";a.frameBorder="0";top.DEXTDOC.body.appendChild(a);var c;c="<html><head>"+('<link rel="stylesheet" type="text/css" href="'+this._config.webPath.css+'dext_context.css" charset="utf-8">');c+='</head><body  style="margin:0px; padding:0px; background-color:transparent;" oncontextmenu="return false">';c+='<div onselectstart="return false;" style="width:100%; height:100%" id="topmenu_iframe_bg">';c+=
'<div class="DEXT_fiVe_ED_popup">';c+='<div class="DEXT_fiVe_EDP">';c+='<div class="Dfe_popup DEXT_fiVe_'+this._config.style.skinName+'">';c+='<ul id="div_topmenu_main"></ul>';c+="</div>";c+="</div>";c+='<div class="DEXT_fiVe_EDP_s" id="topmenu_sub" style="display:none; position:relative;">';c+='<div class="Dfe_popup DEXT_fiVe_'+this._config.style.skinName+'">';c+='<ul id="div_topmenu_sub"></ul>';c+="</div>";c+="</div>";c+="</div>";c+="</div>";c+="</body></html>";_topmenu_document=a.contentWindow.document;
_topmenu_document.open();_topmenu_document.write(c);_topmenu_document.close();this._topmenu_iframe=a;this._topmenu_document=_topmenu_document;this._topmenu_main=_topmenu_document.getElementById("div_topmenu_main");this._topmenu_sub=_topmenu_document.getElementById("div_topmenu_sub")}var d=this,a=function(){return function(a){d._topmenu_bg.style.display=""}}();top.DEXT5.util.addEvent(this._topmenu_main,"mousemove",a);this._topmenu_main.innerHTML="";this._topmenu_sub.innerHTML=""},_setMenu:function(a){var b=
[];switch(a){case "m_file":b="new  template  save  print".split(" ");this._height="110px";this._width="200px";break;case "m_edit":b="undo redo  copy cut paste  select_all  find replace".split(" ");this._height="230px";this._width="200px";break;case "m_view":b="full_screen  grid  design source preview text".split(" ");this._height="160px";this._width="200px";break;case "m_insert":b="doc_bg_image image_create entity  hyperlink_create bookmark  horizontal_line symbol emoticon".split(" ");this._height=
"250px";this._width="400px";break;case "m_form":b="bold italic underline strike_through superscript subscript  line_height remove_format  list_number list_bullets  indent outdent  align".split(" ");this._width=this._height="400px";break;case "m_table":b="detail_table_insert table_delete  insert_row_column insert_row insert_column  delete_row delete_column  merge_cell split_cell table_row_clone  table_select cell_size align_vertical  row_property column_property table_tool table_property cell_property".split(" ");
this._height="450px";this._width="400px";break;case "m_tool":b=["tool_replace","","setting"];this._height="60px";this._width="200px";break;case "m_help":b=["about"];this._height="30px";this._width="200px";break;default:this._height=this._width="1px"}for(a=0;a<b.length;a++)this._addItem(b[a]);this._disableItem(this._disabeld_menu)},_disableItem:function(a){for(var b=0;b<a.length;b++){var c=this._topmenu_document.getElementById("topmenu_"+a[b]);c&&(c.className="item_disabled")}},_addItem:function(a){for(r=
0;r<top.G_CURREDITOR.remove_item.length;r++)if(top.G_CURREDITOR.remove_item[r]==a)return;var b=this._topmenu_document.createElement("li"),c=this,d=this._getImageUrl(a),e=this._getText(a),g=this._item_sub_list[a];if(""==e)b.className="b_border";else{var h=this._topmenu_document.createElement("span"),f=this._topmenu_document.createElement("span"),k=this._topmenu_document.createElement("span"),l=this._topmenu_document.createElement("img");0<d.length&&(l.setAttribute("src",d),l.width="16",l.height="16",
l.alt=e,h.appendChild(l));"textContent"in f?f.textContent=e:f.innerText=e;h.className="s_left";f.className="s_right";b.appendChild(h);b.appendChild(f);g?(k.className="arrow",b.appendChild(k),d=function(a){return function(b){if("item_disabled"!=a.className){c._topmenu_sub.innerHTML="";for(var d=0;d<g.length;d++)c._addSubItem(g[d]);d=getClientRect(b.target?b.target:b.srcElement);c._topmenu_document.getElementById("topmenu_sub").style.display="";c._topmenu_document.getElementById("topmenu_sub").style.top=
d.top-0+"px";a.className="on_mouseover";top.DEXT5.util.stopEvent(b)}}}(b),e=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",top.DEXT5.util.stopEvent(b))}}(b),top.DEXT5.util.addEvent(b,"mouseover",d),top.DEXT5.util.addEvent(b,"mouseout",e)):(d=function(a){return function(b){c._topmenu_document.getElementById("topmenu_sub").style.display="none";"item_disabled"!=a.className&&(a.className="on_mouseover",top.DEXT5.util.stopEvent(b))}}(b),e=function(a){return function(b){"on_mouseover"==
a.className&&(a.className="",top.DEXT5.util.stopEvent(b))}}(b),c=this,h=function(b){return function(d){"on_mouseover"==b.className&&(_dext_editor._dextCommands(_dext_editor.ID,a),c.hide_focus())}}(b),top.DEXT5.util.addEvent(b,"mouseover",d),top.DEXT5.util.addEvent(b,"mouseout",e),top.DEXT5.util.addEvent(b,"click",h))}0<a.length&&(b.id="topmenu_"+a);b.unselectable="on";this._topmenu_main.appendChild(b)},_addSubItem:function(a){for(r=0;r<top.G_CURREDITOR.remove_item.length;r++)if(top.G_CURREDITOR.remove_item[r]==
a)return;var b=this._topmenu_document.createElement("li"),c=this,d=this._getImageUrl(a),e=this._getText(a);if(""==e)b.className="b_border";else{var g=this._topmenu_document.createElement("span"),h=this._topmenu_document.createElement("span"),f=this._topmenu_document.createElement("img");0<d.length&&(f.setAttribute("src",d),f.width="16",f.height="16",f.alt=e,g.appendChild(f));"textContent"in h?h.textContent=e:h.innerText=e;g.className="s_left";h.className="s_right";b.appendChild(g);b.appendChild(h);
d=function(a){return function(b){"item_disabled"!=a.className&&(a.className="on_mouseover",top.DEXT5.util.stopEvent(b))}}(b);e=function(a){return function(b){"on_mouseover"==a.className&&(a.className="",top.DEXT5.util.stopEvent(b))}}(b);c=this;g=function(b){return function(d){"on_mouseover"==b.className&&(_dext_editor._dextCommands(_dext_editor.ID,a),c.hide_focus())}}(b);top.DEXT5.util.addEvent(b,"mouseover",d);top.DEXT5.util.addEvent(b,"mouseout",e);top.DEXT5.util.addEvent(b,"click",g);0<a.length&&
(b.id="topmenu_"+a);b.unselectable="on";this._topmenu_sub.appendChild(b)}},_getImageUrl:function(a){for(var b=this._config.webPath.image+"icon/"+a+".gif",c=0;c<this._non_image_item.length;c++)if(a==this._non_image_item[c]){b="";break}return b},_getText:function(a){var b="";""!=a&&(b=dext5_lang.topmenu[a]);return b},show:function(a,b,c,d,e){this._config=d;this._create();this._setMenu(c);this._topmenu_iframe.style.width=this._width;this._topmenu_iframe.style.height=this._height;a=a?a:window.event;Math.round(a.clientX);
Math.round(a.clientY);c={};c=getWindowScrollPos(top.DEXTWIN);d=getClientRect(_iframeWin.parent.frameElement);getClientRect(_iframeWin.frameElement);a=getClientRect(a.target?a.target:a.srcElement);this._topmenu_iframe.style.left=a.left+c[0]+d.left+"px";this._topmenu_iframe.style.top=a.top+c[1]+d.top+19+"px";this._topmenu_iframe.style.display="";this._makeBackground(b,e)},hide:function(a,b){_dext_editor._top_menu_click_flag=!1;_dext_editor._top_menu_click_id="";var c=top.DEXT5.util.xml.count(b,"menu");
if(0<c)for(var d=0;d<c;d++){var e=top.DEXT5.util.xml.getNodeValueIdx(b,"menu",d),e=top.DEXT5.util.trim(e).toLowerCase();_iframeWin.parent.document.getElementById("ue_"+a+e).childNodes[0].className=""}this._topmenu_iframe&&(this._topmenu_iframe.style.display="none");this._topmenu_bg&&(this._topmenu_bg.style.display="none");this._topmenu_document&&this._topmenu_document.getElementById("topmenu_sub")&&(this._topmenu_document.getElementById("topmenu_sub").style.display="none")},hide_focus:function(a,
b){_dext_editor._top_menu_click_flag=!1;_dext_editor._top_menu_click_id="";var c=top.DEXT5.util.xml.count(b,"menu");if(0<c)for(var d=0;d<c;d++){var e=top.DEXT5.util.xml.getNodeValueIdx(b,"menu",d),e=top.DEXT5.util.trim(e).toLowerCase();_iframeWin.parent.document.getElementById("ue_"+a+e).childNodes[0].className=""}this._topmenu_iframe&&(this._topmenu_iframe.style.display="none");this._topmenu_bg&&(this._topmenu_bg.style.display="none");this._topmenu_document&&this._topmenu_document.getElementById("topmenu_sub")&&
(this._topmenu_document.getElementById("topmenu_sub").style.display="none");dialogCancel()},_makeBackground:function(a,b){var c=this;if(this._topmenu_bg=top.DEXTDOC.getElementById(c._topmenu_bg_id))top.DEXTDOC.body.removeChild(this._topmenu_bg),this._topmenu_bg=null;if(!this._topmenu_bg){this._topmenu_bg=top.DEXTDOC.createElement("div");this._topmenu_bg.style.display="none";this._topmenu_bg.id=this._topmenu_bg_id;this._topmenu_bg.innerHTML='<div oncontextmenu="return false" style="filter:alpha(opacity=0); opacity:0.0; -moz-opacity:0.0; -khtml-opacity: 0.0; background-color:#000000; z-index:'+
this._topmenu_bg_zIndex+'; position:absolute; left:0px; top:0px;overflow:hidden; "></div>';var d="CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollHeight:top.DEXTDOC.body.scrollHeight;this._topmenu_bg.firstChild.style.width=("CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollWidth:top.DEXTDOC.body.scrollWidth)-10+"px";this._topmenu_bg.firstChild.style.height=d-10+"px";top.DEXTDOC.body.appendChild(this._topmenu_bg);var d=function(){return function(d){c.hide_focus(a,
b)}}(),e=function(){return function(a){a="CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollHeight:top.DEXTDOC.body.scrollHeight;c._topmenu_bg.firstChild.style.width=("CSS1Compat"==top.DEXTDOC.compatMode?top.DEXTDOC.documentElement.scrollWidth:top.DEXTDOC.body.scrollWidth)+"px";c._topmenu_bg.firstChild.style.height=a+"px"}}();top.DEXT5.util.addEvent(this._topmenu_bg,"click",d);top.DEXT5.util.addEvent(this._topmenu_bg,"contextmenu",d);top.DEXT5.util.addEvent(top.DEXTWIN,"resize",
e);top.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),"click",d);top.DEXT5.util.addEvent(this._topmenu_document.getElementById("topmenu_iframe_bg"),"contextmenu",d);this._topmenu_bg.style.display="none";top.DEXT5.util.addEvent(this._topmenu_bg,"mousemove",function(d){var e=top.DEXT5.util.xml.count(b,"menu");if(0<e)for(var f=0;f<e;f++){var k=top.DEXT5.util.xml.getNodeValueIdx(b,"menu",f),k=top.DEXT5.util.trim(k).toLowerCase(),k=_iframeWin.parent.document.getElementById("ue_"+
a+k).getBoundingClientRect(),l=getClientRect(_iframeWin.parent.frameElement);point_in_rectagnle(d.clientX,d.clientY,l.left+k.left,l.top+k.top,l.left+k.right,l.top+k.bottom)&&(c._topmenu_bg.style.display="none")}})}}};function between(a,b,c){result=!1;a<c&&b>a&&b<c&&(result=!0);a>c&&b>c&&b<a&&(result=!0);if(b==a||b==c)result=!0;return result}function point_in_rectagnle(a,b,c,d,e,g){result=!1;between(c,a,e)&&between(d,b,g)&&(result=!0);return result};

/* ------------- 13 ------------------ */
function setDoctypeProperty(b,a,d,c){var g=_iframeDoc.getElementsByTagName("head")[0].outerHTML,f=_iframeDoc.body.outerHTML;FixFlashError2(_iframeDoc);_iframeDoc.open();_iframeDoc.write(b+"<html>\n"+g+f+"\n</html>");_iframeDoc.close();0<d.length&&(b=_iframeDoc.getElementsByTagName("html")[0],b.setAttribute("lang",d),b.setAttribute("xml:lang",d),0<c.length&&b.setAttribute("xmlns",c));""==a&&(a="utf-8");d=_iframeDoc.getElementsByTagName("meta")[0];d.setAttribute("http-equiv","Content-Type");d.setAttribute("content",
"text/html");d.setAttribute("charset",a);top.G_CURREDITOR._load_editor_frame(!1)}
function createEditorIframe(b,a,d,c,g,f,e,m,l,k){var h=document.createElement("iframe");h.id=a;h.title=d;a="document.open();"+(isCustomDomain(document)?'document.domain="'+document.domain+'";':"")+" document.close();";a=top.DEXT5.browser.ie?"javascript:void(function(){"+encodeURIComponent(a)+"}())":"";h.src=a;h.frameBorder=0;h.style.width="100%";h.style.height="100%";h.style.borderWidth="0px";if(top.DEXT5.browser.mobile||top.DEXT5.browser.iOS)h.style.overflow="hidden",h.style.display="inline-block";
b.appendChild(h);b=getIframeDocument(h);""==k&&(k="1.2");a="";a=(""==c?"":c+"\n")+"<html>\n<head>\n<title>DEXT5 Editor</title>\n";a+="<style type=text/css>\n";a+="body { cursor:text; line-height:"+k+"; margin:0px; font-family:"+m+"; font-size:"+l+"; }\n";a+="p { line-height:"+k+"; margin-top:0px; margin-bottom:0px; }\n";a+="li { line-height:"+k+"; margin-top:0px; margin-bottom:0px; }\n";a+="</style>\n";a+="</head>\n";a+="<body>\n<p></p>\n</body>\n</html>";b.open();isCustomDomain(document)&&(b.domain=
document.domain);b.write(a);b.close();f&&0<f.length&&(c=b.getElementsByTagName("html")[0],c.setAttribute("lang",f),c.setAttribute("xml:lang",f),0<e.length&&c.setAttribute("xmlns",e));""==g&&(g="utf-8");f=b.getElementsByTagName("head")[0];e=b.createElement("meta");e.setAttribute("http-equiv","Content-Type");e.setAttribute("content","text/html");e.setAttribute("charset",g);f.appendChild(e);return h}
function setHtmlValueToEditor(b,a){FixFlashError2(_iframeDoc);_iframeDoc.open();_iframeDoc.write(b);_iframeDoc.close();top.G_CURREDITOR._load_editor_frame(!1)}
function setHeadValueToEditor(b){var a=top.G_CURREDITOR,d=a._docType[a._PageProp.doctype],c=a._PageProp.lang,g=a._PageProp.xmlnsname;_iframeDoc.getElementsByTagName("head");var f=_iframeDoc.getElementsByTagName("body")[0],e;e=f.style.padding;f=f.style.margin;FixFlashError2(_iframeDoc);_iframeDoc.open();isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(d+"<html>\n"+b+"\n</html>");_iframeDoc.close();0<c.length&&(b=_iframeDoc.getElementsByTagName("html")[0],b.setAttribute("lang",
c),b.setAttribute("xml:lang",c),0<g.length&&b.setAttribute("xmlns",g));0<e.length&&(_iframeDoc.body.style.padding=e);0<f.length&&(_iframeDoc.body.style.margin=f);a._load_editor_frame(!1)}
function setBodyValueToEditorEx(b){var a=top.G_CURREDITOR,d=a._docType[a._PageProp.doctype],c=a._PageProp.lang,g=a._PageProp.xmlnsname,f=_iframeDoc.getElementsByTagName("head")[0].outerHTML,e=_iframeDoc.getElementsByTagName("body")[0],m;m=e.style.padding;e=e.style.margin;FixFlashError2(_iframeDoc);_iframeDoc.open();isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(d+"<html>\n"+f+"\n"+b+"\n</html>");_iframeDoc.close();0<c.length&&(b=_iframeDoc.getElementsByTagName("html")[0],
b.setAttribute("lang",c),b.setAttribute("xml:lang",c),0<g.length&&b.setAttribute("xmlns",g));0<m.length&&(_iframeDoc.body.style.padding=m);0<e.length&&(_iframeDoc.body.style.margin=e);a._load_editor_frame(!1)}
function setBodyValueToEditor(b){var a=top.G_CURREDITOR,d=a._docType[a._PageProp.doctype],c=a._PageProp.lang,g=a._PageProp.xmlnsname,f=_iframeDoc.getElementsByTagName("head")[0].outerHTML,e=_iframeDoc.getElementsByTagName("body")[0],m,l,k,h,n;m=e.style.padding;l=e.style.margin;k=e.style.backgroundImage;h=e.style.backgroundColor;n=e.style.backgroundAttachment;e=e.style.backgroundRepeat;FixFlashError2(_iframeDoc);_iframeDoc.open();isCustomDomain(document)&&(_iframeDoc.domain=document.domain);_iframeDoc.write(d+
"<html>\n"+f+"\n<body>"+b+"\n<body>\n</html>");_iframeDoc.close();0<c.length&&(b=_iframeDoc.getElementsByTagName("html")[0],b.setAttribute("lang",c),b.setAttribute("xml:lang",c),0<g.length&&b.setAttribute("xmlns",g));0<m.length&&(_iframeDoc.body.style.padding=m);0<l.length&&(_iframeDoc.body.style.margin=l);0<k.length&&(_iframeDoc.body.style.backgroundImage=k);0<h.length&&(_iframeDoc.body.style.backgroundColor=h);0<n.length&&(_iframeDoc.body.style.backgroundAttachment=n);0<e.length&&(_iframeDoc.body.style.backgroundRepeat=
e);a._load_editor_frame(!1)}
function setHtmlToPreview(){var b=top.G_CURREDITOR,a;a=b._EDITOR.preview.contentDocument?b._EDITOR.preview.contentDocument:b._EDITOR.preview.contentWindow.document;var d=b._docType[b._PageProp.doctype],c=b._PageProp.lang,g=b._PageProp.xmlnsname,f=_iframeDoc.getElementsByTagName("head")[0].outerHTML;changeBodyImageProperty(!0);var e=_iframeDoc.body.outerHTML,e=CleanZeroChar(e);b._PageProp.bshowgrid&&!0==b._PageProp.bshowgrid&&changeBodyImageProperty(!1);FixFlashError();a.open();isCustomDomain(document)&&
(a.domain=document.domain);a.write(d+"<html>\n"+f+"\n"+e+"\n</html>");a.close();0<c.length&&(d=a.getElementsByTagName("html")[0],d.setAttribute("lang",c),d.setAttribute("xml:lang",c),0<g.length&&d.setAttribute("xmlns",g));if(top.DEXT5.browser.mobile||top.DEXT5.browser.iOS)try{for(var m=a.getElementsByTagName("iframe"),c=0;c<m.length;c++){var l=m[c],k=a.createElement("div");k.style.height=l.height?l.height+"px":l.style.height+"px";k.style.width=l.width?l.width+"px":l.style.width+"px";k.style.overflow=
"scroll";k.style.overflowX="hidden";k.style.WebkitOverflowScrolling="touch";setWrapperToElement(l,k)}}catch(h){}"spellcheck"in a.body&&(a.body.spellcheck=!1);"contentEditable"in a.body&&(a.body.contentEditable=!1);if(isIEU)try{top.DEXT5.util.addEvent(b._EDITOR.preview.contentWindow,"unload",function(){FixFlashError()}),top.DEXT5.util.addEvent(_iframeWin,"unload",function(){FixFlashError2(_iframeDoc)})}catch(n){}}
function setWrapperToElement(b,a){b.nextSibling?b.parentNode.insertBefore(a,b.nextSibling):b.parentNode.appendChild(a);a.appendChild(b)}
function changeBodyImageProperty(b){var a=top.G_CURREDITOR;b?(a._PageProp.bodyimage&&0<a._PageProp.bodyimage.length?_iframeDoc.body.style.backgroundImage=a._PageProp.bodyimage:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-image"):_iframeDoc.body.style.removeAttribute("backgroundImage"),a._PageProp.bodycolor&&0<a._PageProp.bodycolor.length?_iframeDoc.body.style.backgroundColor=a._PageProp.bodycolor:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-color"):
_iframeDoc.body.style.removeAttribute("backgroundColor"),a._PageProp.bodyattachment&&0<a._PageProp.bodyattachment.length?_iframeDoc.body.style.backgroundAttachment=a._PageProp.bodyattachment:_iframeDoc.body.style.removeProperty?_iframeDoc.body.style.removeProperty("background-attachment"):_iframeDoc.body.style.removeAttribute("backgroundAttachment"),a._PageProp.bodyrepeat&&0<a._PageProp.bodyrepeat.length?_iframeDoc.body.style.backgroundRepeat=a._PageProp.bodyrepeat:_iframeDoc.body.style.removeProperty?
_iframeDoc.body.style.removeProperty("background-repeat"):_iframeDoc.body.style.removeAttribute("backgroundRepeat")):(a._PageProp.gridimage&&0<a._PageProp.gridimage.length&&(_iframeDoc.body.style.backgroundImage=a._PageProp.gridimage),a._PageProp.gridattachment&&0<a._PageProp.gridattachment.length&&(_iframeDoc.body.style.backgroundAttachment=a._PageProp.gridattachment),a._PageProp.gridrepeat&&0<a._PageProp.gridrepeat.length&&(_iframeDoc.body.style.backgroundRepeat=a._PageProp.gridrepeat))}
function changeBodyContenteditable(b){b?(_iframeDoc.body.style.margin="10px 10px 10px 10px",_iframeDoc.body.contentEditable=b):(_iframeDoc.body.removeAttribute("contentEditable"),_iframeDoc.body.style.removeProperty?(_iframeDoc.body.style.removeProperty("margin-left"),_iframeDoc.body.style.removeProperty("margin-top"),_iframeDoc.body.style.removeProperty("margin-right"),_iframeDoc.body.style.removeProperty("margin-bottom"),_iframeDoc.body.style.removeProperty("margin")):(_iframeDoc.body.style.removeAttribute("marginLeft"),
_iframeDoc.body.style.removeAttribute("marginTop"),_iframeDoc.body.style.removeAttribute("marginRight"),_iframeDoc.body.style.removeAttribute("marginBottom"),_iframeDoc.body.style.removeAttribute("margin")))}
function fakeBodyDivForBackground(b,a){b=b.replace(/(\r\n|\n|\r)/gm,"");if(a){var d=b.substr(0,4),c=b.substr(b.length-6,6);"<div"==d.toLowerCase()&&"</div>"==c.toLowerCase()&&(d=d.replace(d,"<body"),c=c.replace(c,"</body>"),b=b.substring(4,b.length-6),b=d+b+c)}else d=b.substr(0,5),c=b.substr(b.length-7,7),"<body"==d.toLowerCase()&&"</body>"==c.toLowerCase()&&(d=d.replace(d,"<div"),c=c.replace(c,"</div>"),b=b.substring(5,b.length-7),b=d+b+c);return b};

